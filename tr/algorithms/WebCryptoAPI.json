{
  "spec": {
    "title": "Web Cryptography API",
    "url": "https://www.w3.org/TR/WebCryptoAPI/"
  },
  "algorithms": [
    {
      "name": "parse an ASN.1 structure",
      "href": "https://www.w3.org/TR/WebCryptoAPI/#concept-parse-an-asn1-structure",
      "html": "When this specification says to <dfn id=\"concept-parse-an-asn1-structure\">parse an ASN.1\n          structure</dfn>, the user agent must perform the following steps:",
      "rationale": "let",
      "steps": [
        {
          "html": "<p>\n              Let <var>data</var> be a sequence of bytes to be parsed.\n            </p>"
        },
        {
          "html": "<p>\n              Let <var>structure</var> be the ASN.1 structure to be parsed.\n            </p>"
        },
        {
          "html": "<p>\n              Let <var>exactData</var> be an optional boolean value. If it is not supplied,\n              let it be initialized to <code>true</code>.\n            </p>"
        },
        {
          "html": "<p>\n              Parse <var>data</var> according to the Distinguished Encoding Rules of\n              <a href=\"https://www.w3.org/TR/WebCryptoAPI/#X690\">X.690 (11/08)</a>, using <var>structure</var> as the ASN.1 structure\n              to be decoded.\n            </p>"
        },
        {
          "html": "<p>\n              If <var>exactData</var> was specified, and all of the bytes of <var>data</var> were\n              not consumed during the parsing phase, then\n              <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">throw</a> a\n              <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-DataError\"><code>DataError</code></a>.\n            </p>"
        },
        {
          "html": "<p>\n              Return the parsed ASN.1 structure.\n            </p>"
        }
      ]
    },
    {
      "name": "parse a JWK",
      "href": "https://www.w3.org/TR/WebCryptoAPI/#concept-parse-a-jwk",
      "html": "When this specification says to <dfn id=\"concept-parse-a-jwk\">parse a JWK</dfn>, the user\n          agent must run the following steps:",
      "rationale": "let",
      "steps": [
        {
          "html": "<p>\n              Let <var>data</var> be the sequence of bytes to be parsed.\n            </p>"
        },
        {
          "html": "<p>\n              Let <var>json</var> be the Unicode string that results from interpreting\n              <var>data</var> according to UTF-8.\n            </p>"
        },
        {
          "html": "<p>\n              Convert <var>json</var> to UTF-16.\n            </p>"
        },
        {
          "html": "<p>\n              Let <var>result</var> be the object literal that results from executing the\n              <code>JSON.parse</code> internal function in the context of a new global object,\n              with <code>text</code> argument set to a JavaScript String containing <var>json</var>.\n            </p>"
        },
        {
          "html": "<p>\n              Let <var>key</var> be the result of converting <var>result</var> to the IDL dictionary\n              type of <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-JsonWebKey\">JsonWebKey</a>.\n            </p>"
        },
        {
          "html": "<p>\n              If the <code>\"kty\"</code> field of <var>key</var> is not defined, then <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">throw</a> a <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-DataError\"><code>DataError</code></a>.\n            </p>"
        },
        {
          "html": "<p>\n              Return <var>key</var>.\n            </p>"
        }
      ]
    },
    {
      "name": "cached ECMAScript object",
      "href": "https://www.w3.org/TR/WebCryptoAPI/#concept-cached-object",
      "html": "When this specification refers to the <dfn id=\"concept-cached-object\">cached ECMAScript\n          object</dfn> associated with an internal slot [[<var>slot</var>]] of <var>object</var>,\n          the user agent must run the following steps:",
      "rationale": "if",
      "steps": [
        {
          "html": "<dl class=\"switch\">\n              <dt>\n                If the [[<var>slot</var>_cached]] internal slot of <var>object</var> is undefined:\n              </dt>\n              <dd>\n                Set the [[<var>slot</var>_cached]] internal slot of <var>object</var> to the result\n                of performing type conversion to an ECMAScript object as defined in\n                [<a href=\"https://www.w3.org/TR/WebCryptoAPI/#WebIDL\">WebIDL</a>] to the contents of the [[<var>slot</var>]]\n                internal slot of <var>object</var>.\n              </dd>\n            </dl>",
          "rationale": ".switch",
          "steps": [
            {
              "operation": "switch",
              "steps": [
                {
                  "case": "If the [[slot_cached]] internal slot of object is undefined:",
                  "html": "Set the [[<var>slot</var>_cached]] internal slot of <var>object</var> to the result\n                of performing type conversion to an ECMAScript object as defined in\n                [<a href=\"https://www.w3.org/TR/WebCryptoAPI/#WebIDL\">WebIDL</a>] to the contents of the [[<var>slot</var>]]\n                internal slot of <var>object</var>."
                }
              ]
            }
          ]
        },
        {
          "html": "Return the contents of the [[<var>slot</var>_cached]] internal slot of <var>object</var>."
        }
      ]
    },
    {
      "name": "getRandomValues",
      "href": "https://www.w3.org/TR/WebCryptoAPI/#dfn-Crypto-method-getRandomValues",
      "html": "The <dfn id=\"dfn-Crypto-method-getRandomValues\"><code>getRandomValues</code></dfn>\n              method generates cryptographically random values. It must act as follows:",
      "rationale": "if",
      "steps": [
        {
          "html": "<p>\n                  If <var>array</var> is not of an integer type (i.e., Int8Array, Uint8Array,\n                  Int16Array, Uint16Array, Int32Array, Uint32Array or UInt8ClampedArray), <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">throw</a> a\n                  <code>TypeMismatchError</code> and\n                  <a href=\"https://www.w3.org/TR/WebCryptoAPI/#terminate-the-algorithm\">terminate the algorithm</a>.\n                </p>"
        },
        {
          "html": "<p>\n                  If the <code>byteLength</code> of <var>array</var> is greater than 65536, <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">throw</a> a\n                  <code>QuotaExceededError</code> and\n                  <a href=\"https://www.w3.org/TR/WebCryptoAPI/#terminate-the-algorithm\">terminate the algorithm</a>.\n                </p>"
        },
        {
          "html": "<p>\n                  Overwrite all elements of <var>array</var> with cryptographically random values of\n                  the appropriate type.\n                </p>"
        },
        {
          "html": "<p>\n                  Return <var>array</var>.\n                </p>"
        }
      ]
    },
    {
      "html": "When a user agent is required to obtain a <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-structured-clone\">structured clone</a>\n            of a <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey\">CryptoKey</a> object, it must run the following steps.",
      "rationale": "let",
      "steps": [
        {
          "html": "Let <var>input</var> and <var>memory</var> be the corresponding inputs defined by the\n              <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-structured-clone\">internal structured cloning algorithm</a>, where\n              <var>input</var> represents a <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey\">CryptoKey</a> object to be\n              cloned."
        },
        {
          "html": "Let <var>output</var> be a newly constructed <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey\">CryptoKey</a>\n              object."
        },
        {
          "html": "Let the [[<a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-type\">type</a>]], <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-extractable\">[[extractable]]</a>, <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-algorithm\">[[algorithm]]</a>, and <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-usages\">[[usages]]</a> internal slots of <var>output</var>\n              be set to the result of invoking the internal structured clone algorithm recursively\n              on the corresponding internal slots of <var>input</var>, with the slot contents as the\n              new \"<var>input</var>\" argument and <var>memory</var> as the new \"<var>memory</var>\"\n              argument."
        },
        {
          "html": "Let the [[<a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-handle\">handle</a>]] internal slot of\n              <var>output</var> refer to the same cryptographic key data represented by the\n              [[<a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-handle\">handle</a>]] internal slot of <var>input</var>."
        }
      ]
    },
    {
      "name": "encrypt",
      "href": "https://www.w3.org/TR/WebCryptoAPI/#dfn-SubtleCrypto-method-encrypt",
      "html": "The <dfn id=\"dfn-SubtleCrypto-method-encrypt\"><code>encrypt</code></dfn>\n              method returns a new Promise object that will encrypt data using\n              the specified \n              <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-AlgorithmIdentifier\"><code>AlgorithmIdentifier</code></a> with\n              the supplied <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey\"><code>CryptoKey</code></a>. It must act\n              as follows:",
      "rationale": "let",
      "steps": [
        {
          "html": "<p>\n                  Let <var>algorithm</var> and <var>key</var> be the\n                  <code>algorithm</code> and <code>key</code> parameters\n                  passed to the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-SubtleCrypto-method-encrypt\">encrypt</a> method,\n                  respectively.\n                </p>"
        },
        {
          "html": "<p>\n                  Let <var>data</var> be the result of\n                  <a href=\"http://heycam.github.io/webidl/#dfn-get-buffer-source-copy\">\n                  getting a copy of the bytes</a> held by the <code>data</code> parameter passed to the\n                  <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-SubtleCrypto-method-encrypt\">encrypt</a> method.\n                </p>"
        },
        {
          "html": "<p>\n                  Let <var>normalizedAlgorithm</var> be the result of\n                  <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-normalize-an-algorithm\">normalizing an algorithm</a>, with\n                  <code>alg</code> set to <var>algorithm</var> and <code>op</code> set to\n                  <code>\"encrypt\"</code>.\n                </p>"
        },
        {
          "html": "<p>\n                  If an error occurred, return a Promise rejected with\n                  <var>normalizedAlgorithm</var>.\n                </p>"
        },
        {
          "html": "<p>\n                  Let <var>promise</var> be a new Promise.\n                </p>"
        },
        {
          "html": "<p>\n                  Return <var>promise</var> and asynchronously perform the remaining steps.\n                </p>"
        },
        {
          "html": "<p>\n                  If the following steps or referenced procedures say to\n                  <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">throw</a> an error,\n                  reject <var>promise</var> with\n                  the returned error and then\n                  <a href=\"https://www.w3.org/TR/WebCryptoAPI/#terminate-the-algorithm\">terminate the algorithm.</a>\n                </p>"
        },
        {
          "html": "<p>\n                  If the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-Algorithm-name\">name</a> member of\n                  <var>normalizedAlgorithm</var> is not equal to the\n                  <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-KeyAlgorithm-name\">name</a> attribute of the\n                  [[<a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-algorithm\">algorithm</a>]] internal slot of\n                  <var>key</var> then <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">throw</a> an <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-InvalidAccessError\"><code>InvalidAccessError</code></a>.\n                </p>"
        },
        {
          "html": "<p>\n                  If the [[<a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-usages\">usages</a>]] internal slot of\n                  <var>key</var> does not contain an entry that is <code>\"encrypt\"</code>, then <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">throw</a> an <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-InvalidAccessError\"><code>InvalidAccessError</code></a>.\n                </p>"
        },
        {
          "html": "<p>\n                  Let <var>ciphertext</var> be the result of performing the encrypt\n                  operation specified by <var>normalizedAlgorithm</var> using <var>algorithm</var>\n                  and <var>key</var> and with <var>data</var> as <var>plaintext</var>.\n                </p>"
        },
        {
          "html": "<p>\n                  Resolve <var>promise</var> with <var>ciphertext</var>.\n                </p>"
        }
      ]
    },
    {
      "name": "decrypt",
      "href": "https://www.w3.org/TR/WebCryptoAPI/#dfn-SubtleCrypto-method-decrypt",
      "html": "The <dfn id=\"dfn-SubtleCrypto-method-decrypt\"><code>decrypt</code></dfn>\n              method returns a new Promise object that will decrypt data using the specified\n              <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-AlgorithmIdentifier\"><code>AlgorithmIdentifier</code></a> with\n              the supplied <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey\"><code>CryptoKey</code></a>. It must act\n              as follows:",
      "rationale": "let",
      "steps": [
        {
          "html": "<p>\n                  Let <var>algorithm</var> and <var>key</var> be the\n                  <code>algorithm</code> and <code>key</code>parameters\n                  passed to the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-SubtleCrypto-method-decrypt\">decrypt</a> method,\n                  respectively.\n                </p>"
        },
        {
          "html": "<p>\n                  Let <var>data</var> be the result of\n                  <a href=\"http://heycam.github.io/webidl/#dfn-get-buffer-source-copy\">\n                  getting a copy of the bytes held by</a> the <code>data</code> parameter passed to the\n                  <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-SubtleCrypto-method-decrypt\">decrypt</a> method.\n                </p>"
        },
        {
          "html": "<p>\n                  Let <var>normalizedAlgorithm</var> be the result of\n                  <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-normalize-an-algorithm\">normalizing an algorithm</a>, with\n                  <code>alg</code> set to <var>algorithm</var> and <code>op</code> set to\n                  <code>\"decrypt\"</code>.\n                </p>"
        },
        {
          "html": "<p>\n                  If an error occurred, return a Promise rejected with\n                  <var>normalizedAlgorithm</var>.\n                </p>"
        },
        {
          "html": "<p>\n                  Let <var>promise</var> be a new Promise.\n                </p>"
        },
        {
          "html": "<p>\n                  Return <var>promise</var> and asynchronously perform the remaining steps.\n                </p>"
        },
        {
          "html": "<p>\n                  If the following steps or referenced procedures say to\n                  <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">throw</a> an error,\n                  reject <var>promise</var> with\n                  the returned error and then\n                  <a href=\"https://www.w3.org/TR/WebCryptoAPI/#terminate-the-algorithm\">terminate the algorithm.</a>\n                </p>"
        },
        {
          "html": "<p>\n                  If the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-Algorithm-name\">name</a> member of\n                  <var>normalizedAlgorithm</var> is not equal to the\n                  <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-KeyAlgorithm-name\">name</a> attribute of the\n                  [[<a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-algorithm\">algorithm</a>]] internal slot of\n                  <var>key</var> then <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">throw</a> an <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-InvalidAccessError\"><code>InvalidAccessError</code></a>.\n                </p>"
        },
        {
          "html": "<p>\n                  If the [[<a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-usages\">usages</a>]] internal slot of\n                  <var>key</var> does not contain an entry that is <code>\"decrypt\"</code>, then <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">throw</a> an <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-InvalidAccessError\"><code>InvalidAccessError</code></a>.\n                </p>"
        },
        {
          "html": "<p>\n                  Let <var>plaintext</var> be the result of performing the decrypt\n                  operation specified by <var>normalizedAlgorithm</var> using <var>key</var>\n                  and <var>algorithm</var>\n                  and with <var>data</var> as <var>ciphertext</var>.\n                </p>"
        },
        {
          "html": "<p>\n                  Resolve <var>promise</var> with\n                  <var>plaintext</var>.\n                </p>"
        }
      ]
    },
    {
      "name": "sign",
      "href": "https://www.w3.org/TR/WebCryptoAPI/#dfn-SubtleCrypto-method-sign",
      "html": "The <dfn id=\"dfn-SubtleCrypto-method-sign\"><code>sign</code></dfn> method returns a\n              new Promise object that will sign data using the specified <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-AlgorithmIdentifier\"><code>AlgorithmIdentifier</code></a> with the supplied\n              <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey\"><code>CryptoKey</code></a>. It must act as follows:",
      "rationale": "let",
      "steps": [
        {
          "html": "<p>\n                  Let <var>algorithm</var> and <var>key</var> be the\n                  <code>algorithm</code> and <code>key</code> parameters\n                  passed to the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-SubtleCrypto-method-sign\">sign</a> method,\n                  respectively.\n                </p>"
        },
        {
          "html": "<p>\n                  Let <var>data</var> be the result of\n                  <a href=\"http://heycam.github.io/webidl/#dfn-get-buffer-source-copy\">\n                  getting a copy of the bytes held by</a> the <code>data</code> parameter passed to the\n                  <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-SubtleCrypto-method-sign\">sign</a> method.\n                </p>"
        },
        {
          "html": "<p>\n                  Let <var>normalizedAlgorithm</var> be the result of\n                  <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-normalize-an-algorithm\">normalizing an algorithm</a>, with\n                  <code>alg</code> set to <var>algorithm</var> and <code>op</code> set to\n                  <code>\"sign\"</code>.\n                </p>"
        },
        {
          "html": "<p>\n                  If an error occurred, return a Promise rejected with\n                  <var>normalizedAlgorithm</var>.\n                </p>"
        },
        {
          "html": "<p>\n                  Let <var>promise</var> be a new Promise.\n                </p>"
        },
        {
          "html": "<p>\n                  Return <var>promise</var> and asynchronously perform the remaining steps.\n                </p>"
        },
        {
          "html": "<p>\n                  If the following steps or referenced procedures say to\n                  <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">throw</a> an error,\n                  reject <var>promise</var> with\n                  the returned error and then\n                  <a href=\"https://www.w3.org/TR/WebCryptoAPI/#terminate-the-algorithm\">terminate the algorithm.</a>\n                </p>"
        },
        {
          "html": "<p>\n                  If the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-Algorithm-name\">name</a> member of\n                  <var>normalizedAlgorithm</var> is not equal to the\n                  <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-KeyAlgorithm-name\">name</a> attribute of the\n                  [[<a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-algorithm\">algorithm</a>]] internal slot of\n                  <var>key</var> then <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">throw</a> an <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-InvalidAccessError\"><code>InvalidAccessError</code></a>.\n                </p>"
        },
        {
          "html": "<p>\n                  If the [[<a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-usages\">usages</a>]] internal slot of\n                  <var>key</var> does not contain an entry that is <code>\"sign\"</code>, then <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">throw</a> an <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-InvalidAccessError\"><code>InvalidAccessError</code></a>.\n                </p>"
        },
        {
          "html": "<p>\n                  Let <var>result</var> be the result of performing the sign operation\n                  specified by <var>normalizedAlgorithm</var> using <var>key</var> and\n                  <var>algorithm</var> and with <var>data</var> as <var>message</var>.\n                </p>"
        },
        {
          "html": "<p>\n                  Resolve <var>promise</var> with\n                  <var>result</var>.\n                </p>"
        }
      ]
    },
    {
      "name": "verify",
      "href": "https://www.w3.org/TR/WebCryptoAPI/#dfn-SubtleCrypto-method-verify",
      "html": "The <dfn id=\"dfn-SubtleCrypto-method-verify\"><code>verify</code></dfn> method returns\n              a new Promise object that will verify data using the specified <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-AlgorithmIdentifier\"><code>AlgorithmIdentifier</code></a> with the supplied\n              <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey\"><code>CryptoKey</code></a>. It must act as follows:",
      "rationale": "let",
      "steps": [
        {
          "html": "<p>\n                  Let <var>algorithm</var> and <var>key</var>\n                  be the <code>algorithm</code> and <code>key</code> parameters passed to the\n                  <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-SubtleCrypto-method-verify\">verify</a> method, respectively.\n                </p>"
        },
        {
          "html": "<p>\n                  Let <var>signature</var> be the result of\n                  <a href=\"http://heycam.github.io/webidl/#dfn-get-buffer-source-copy\">\n                  getting a copy of the bytes held by</a> the <code>signature</code> parameter passed to the\n                  <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-SubtleCrypto-method-verify\">verify</a> method.\n                </p>"
        },
        {
          "html": "<p>\n                  Let <var>data</var> be the result of\n                  <a href=\"http://heycam.github.io/webidl/#dfn-get-buffer-source-copy\">\n                  getting a copy of the bytes held by</a> the <code>data</code> parameter passed to the\n                  <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-SubtleCrypto-method-verify\">verify</a> method.\n                </p>"
        },
        {
          "html": "<p>\n                  Let <var>normalizedAlgorithm</var> be the result of\n                  <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-normalize-an-algorithm\">normalizing an algorithm</a>, with\n                  <code>alg</code> set to <var>algorithm</var> and <code>op</code> set to\n                  <code>\"verify\"</code>.\n                </p>"
        },
        {
          "html": "<p>\n                  If an error occurred, return a Promise rejected with\n                  <var>normalizedAlgorithm</var>.\n                </p>"
        },
        {
          "html": "<p>\n                  Let <var>promise</var> be a new Promise.\n                </p>"
        },
        {
          "html": "<p>\n                  Return <var>promise</var> and asynchronously perform the remaining steps.\n                </p>"
        },
        {
          "html": "<p>\n                  If the following steps or referenced procedures say to\n                  <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">throw</a> an error,\n                  reject <var>promise</var> with\n                  the returned error and then\n                  <a href=\"https://www.w3.org/TR/WebCryptoAPI/#terminate-the-algorithm\">terminate the algorithm.</a>\n                </p>"
        },
        {
          "html": "<p>\n                  If the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-Algorithm-name\">name</a> member of\n                  <var>normalizedAlgorithm</var> is not equal to the\n                  <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-KeyAlgorithm-name\">name</a> attribute of the\n                  [[<a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-algorithm\">algorithm</a>]] internal slot of\n                  <var>key</var> then <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">throw</a> an <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-InvalidAccessError\"><code>InvalidAccessError</code></a>.\n                </p>"
        },
        {
          "html": "<p>\n                  If the [[<a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-usages\">usages</a>]] internal slot of\n                  <var>key</var> does not contain an entry that is <code>\"verify\"</code>, then <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">throw</a> an <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-InvalidAccessError\"><code>InvalidAccessError</code></a>.\n                </p>"
        },
        {
          "html": "<p>\n                  Let <var>result</var> be the result of performing the verify operation\n                  specified by <var>normalizedAlgorithm</var> using <var>key</var>,\n                  <var>algorithm</var> and\n                  <var>signature</var> and with <var>data</var> as <var>message</var>.\n                </p>"
        },
        {
          "html": "<p>\n                  Resolve <var>promise</var> with\n                  <var>result</var>.\n                </p>"
        }
      ]
    },
    {
      "name": "digest",
      "href": "https://www.w3.org/TR/WebCryptoAPI/#dfn-SubtleCrypto-method-digest",
      "html": "The <dfn id=\"dfn-SubtleCrypto-method-digest\"><code>digest</code></dfn> method returns\n              a new Promise object that will digest data using the specified\n              <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-AlgorithmIdentifier\"><code>AlgorithmIdentifier</code></a>.\n              It must act as follows:",
      "rationale": "let",
      "steps": [
        {
          "html": "<p>\n                  Let <var>algorithm</var> be the <code>algorithm</code> parameter passed to the\n                  <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-SubtleCrypto-method-digest\">digest</a> method.\n                </p>"
        },
        {
          "html": "<p>\n                  Let <var>data</var> be the result of\n                  <a href=\"http://heycam.github.io/webidl/#dfn-get-buffer-source-copy\">\n                  getting a copy of the bytes held by</a> the <code>data</code> parameter passed to the\n                  <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-SubtleCrypto-method-digest\">digest</a> method.\n                </p>"
        },
        {
          "html": "<p>\n                  Let <var>normalizedAlgorithm</var> be the result of\n                  <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-normalize-an-algorithm\">normalizing an algorithm</a>, with\n                  <code>alg</code> set to <var>algorithm</var> and <code>op</code> set to\n                  <code>\"digest\"</code>.\n                </p>"
        },
        {
          "html": "<p>\n                  If an error occurred, return a Promise rejected with\n                  <var>normalizedAlgorithm</var>.\n                </p>"
        },
        {
          "html": "<p>\n                  Let <var>promise</var> be a new Promise.\n                </p>"
        },
        {
          "html": "<p>\n                  Return <var>promise</var> and asynchronously perform the remaining steps.\n                </p>"
        },
        {
          "html": "<p>\n                  If the following steps or referenced procedures say to\n                  <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">throw</a> an error,\n                  reject <var>promise</var> with\n                  the returned error and then\n                  <a href=\"https://www.w3.org/TR/WebCryptoAPI/#terminate-the-algorithm\">terminate the algorithm.</a>\n                </p>"
        },
        {
          "html": "<p>\n                  Let <var>result</var> be the result of performing the digest\n                  operation specified by <var>normalizedAlgorithm</var> using\n                  <var>algorithm</var>, with <var>data</var>\n                  as <var>message</var>.\n                </p>"
        },
        {
          "html": "<p>\n                  Resolve <var>promise</var> with\n                  <var>result</var>.\n                </p>"
        }
      ]
    },
    {
      "name": "generateKey",
      "href": "https://www.w3.org/TR/WebCryptoAPI/#dfn-SubtleCrypto-method-generateKey",
      "html": "When invoked, <dfn id=\"dfn-SubtleCrypto-method-generateKey\">\n              <code>generateKey</code></dfn> <span class=\"RFC2119\">MUST</span> perform the\n              following steps:",
      "rationale": "let",
      "steps": [
        {
          "html": "<p>\n                  Let <var>algorithm</var>, <var>extractable</var> and <var>usages</var>\n                  be the <code>algorithm</code>, <code>extractable</code> and <code>keyUsages</code>\n                  parameters passed to the\n                  <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-SubtleCrypto-method-generateKey\">generateKey</a> method,\n                  respectively.\n                </p>"
        },
        {
          "html": "<p>\n                  Let <var>normalizedAlgorithm</var> be the result of\n                  <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-normalize-an-algorithm\">normalizing an algorithm</a>, with\n                  <code>alg</code> set to <var>algorithm</var> and <code>op</code> set to\n                  <code>\"generateKey\"</code>.\n                </p>"
        },
        {
          "html": "<p>\n                  If an error occurred, return a Promise rejected with\n                  <var>normalizedAlgorithm</var>.\n                </p>"
        },
        {
          "html": "<p>\n                  Let <var>promise</var> be a new Promise.\n                </p>"
        },
        {
          "html": "<p>\n                  Return <var>promise</var> and asynchronously perform the remaining steps.\n                </p>"
        },
        {
          "html": "<p>\n                  If the following steps or referenced procedures say to\n                  <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">throw</a> an error,\n                  reject <var>promise</var> with\n                  the returned error and then\n                  <a href=\"https://www.w3.org/TR/WebCryptoAPI/#terminate-the-algorithm\">terminate the algorithm.</a>\n                </p>"
        },
        {
          "html": "<p>\n                  Let <var>result</var> be the result of performing the generate key operation\n                  specified by <var>normalizedAlgorithm</var> using\n                  <var>algorithm</var>, <var>extractable</var> and <var>usages</var>.\n                </p>"
        },
        {
          "html": "<dl class=\"switch\">\n                  <dt>If <var>result</var> is a <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey\">CryptoKey</a> object:</dt>\n                  <dd>\n                    <p>\n                      If the [[<a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-type\">type</a>]] internal slot of\n                      <var>result</var> is <code>\"secret\"</code> or <code>\"private\"</code> and\n                      <var>usages</var> is empty, then <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">throw</a> a <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-SyntaxError\">SyntaxError</a>.\n                    </p>                  \n                  </dd>\n                  <dt>If <var>result</var> is a <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKeyPair\">CryptoKeyPair</a> object:</dt>\n                  <dd>\n                    <p>\n                      If the [[<a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-usages\">usages</a>]] internal slot of the\n                      <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKeyPair-privateKey\">privateKey</a> attribute of\n                      <var>result</var> is the empty sequence, then\n                      <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">throw</a> a <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-SyntaxError\">SyntaxError</a>.\n                    </p>\n                  </dd>\n                </dl>",
          "rationale": ".switch",
          "steps": [
            {
              "operation": "switch",
              "steps": [
                {
                  "case": "If result is a CryptoKey object:",
                  "html": "<p>\n                      If the [[<a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-type\">type</a>]] internal slot of\n                      <var>result</var> is <code>\"secret\"</code> or <code>\"private\"</code> and\n                      <var>usages</var> is empty, then <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">throw</a> a <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-SyntaxError\">SyntaxError</a>.\n                    </p>"
                },
                {
                  "case": "If result is a CryptoKeyPair object:",
                  "html": "<p>\n                      If the [[<a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-usages\">usages</a>]] internal slot of the\n                      <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKeyPair-privateKey\">privateKey</a> attribute of\n                      <var>result</var> is the empty sequence, then\n                      <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">throw</a> a <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-SyntaxError\">SyntaxError</a>.\n                    </p>"
                }
              ]
            }
          ]
        },
        {
          "html": "<p>\n                  Resolve <var>promise</var> with\n                  <var>result</var>.\n                </p>"
        }
      ]
    },
    {
      "name": "deriveKey",
      "href": "https://www.w3.org/TR/WebCryptoAPI/#dfn-SubtleCrypto-method-deriveKey",
      "html": "When invoked, <dfn id=\"dfn-SubtleCrypto-method-deriveKey\"><code>deriveKey</code></dfn>\n              <span class=\"RFC2119\">MUST</span> perform the following steps:",
      "rationale": "let",
      "steps": [
        {
          "html": "<p>\n                  Let <var>algorithm</var>, <var>baseKey</var>, <var>derivedKeyType</var>,\n                  <var>extractable</var> and <var>usages</var> be the <code>algorithm</code>,\n                  <code>baseKey</code>, <code>derivedKeyType</code>, <code>extractable</code> and\n                  <code>keyUsages</code> parameters passed to the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-SubtleCrypto-method-deriveKey\">deriveKey</a> method, respectively.\n                </p>"
        },
        {
          "html": "<p>\n                  Let <var>normalizedAlgorithm</var> be the result of\n                  <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-normalize-an-algorithm\">normalizing an algorithm</a>, with\n                  <code>alg</code> set to <var>algorithm</var> and <code>op</code> set to\n                  <code>\"deriveBits\"</code>.\n                </p>"
        },
        {
          "html": "<p>\n                  If an error occurred, return a Promise rejected with\n                  <var>normalizedAlgorithm</var>.\n                </p>"
        },
        {
          "html": "<p>\n                  Let <var>normalizedDerivedKeyAlgorithmImport</var> be the result of\n                  <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-normalize-an-algorithm\">normalizing an algorithm</a>, with\n                  <code>alg</code> set to <var>derivedKeyType</var> and <code>op</code> set to\n                  <code>\"importKey\"</code>.\n                </p>"
        },
        {
          "html": "<p>\n                  If an error occurred, return a Promise rejected with\n                  <var>normalizedDerivedKeyAlgorithmImport</var>.\n                </p>"
        },
        {
          "html": "<p>\n                  Let <var>normalizedDerivedKeyAlgorithmLength</var> be the result of\n                  <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-normalize-an-algorithm\">normalizing an algorithm</a>, with\n                  <code>alg</code> set to <var>derivedKeyType</var> and <code>op</code> set to\n                  <code>\"get key length\"</code>.\n                </p>"
        },
        {
          "html": "<p>\n                  If an error occurred, return a Promise rejected with\n                  <var>normalizedDerivedKeyAlgorithmLength</var>.\n                </p>"
        },
        {
          "html": "<p>\n                  Let <var>promise</var> be a new Promise.\n                </p>"
        },
        {
          "html": "<p>\n                  Return <var>promise</var> and asynchronously perform the remaining steps.\n                </p>"
        },
        {
          "html": "<p>\n                  If the following steps or referenced procedures say to\n                  <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">throw</a> an error,\n                  reject <var>promise</var> with\n                  the returned error and then\n                  <a href=\"https://www.w3.org/TR/WebCryptoAPI/#terminate-the-algorithm\">terminate the algorithm.</a>\n                </p>"
        },
        {
          "html": "<p>\n                  If the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-Algorithm-name\">name</a> member of\n                  <var>normalizedAlgorithm</var> is not equal to the\n                  <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-KeyAlgorithm-name\">name</a> attribute of the\n                  [[<a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-algorithm\">algorithm</a>]] internal slot of\n                  <var>baseKey</var> then <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">throw</a> an <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-InvalidAccessError\"><code>InvalidAccessError</code></a>.\n                </p>"
        },
        {
          "html": "<p>\n                  If the [[<a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-usages\">usages</a>]] internal slot of\n                  <var>baseKey</var> does not contain an entry that is <code>\"deriveKey\"</code>,\n                  then <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">throw</a> an <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-InvalidAccessError\"><code>InvalidAccessError</code></a>.\n                </p>"
        },
        {
          "html": "<p>\n                  Let <var>length</var> be the result of performing the get key length\n                  algorithm specified by <var>normalizedDerivedKeyAlgorithmLength</var> using\n                  <var>derivedKeyType</var>.\n                </p>"
        },
        {
          "html": "<p>\n                  Let <var>secret</var> be the result of performing the derive bits operation\n                  specified by <var>normalizedAlgorithm</var> using\n                  <var>key</var>, <var>algorithm</var> and <var>length</var>.\n                </p>"
        },
        {
          "html": "<p>\n                  Let <var>result</var> be the result of performing the import key operation\n                  specified by <var>normalizedDerivedKeyAlgorithmImport</var> using <code>\"raw\"</code> as\n                  <var>format</var>, <var>secret</var> as <var>keyData</var>,\n                  <var>derivedKeyType</var> as <var>algorithm</var> and using\n                  <var>extractable</var> and <var>usages</var>.\n                </p>"
        },
        {
          "html": "<p>\n                  If the [[<a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-type\">type</a>]] internal slot of\n                  <var>result</var> is <code>\"secret\"</code> or <code>\"private\"</code> and\n                  <var>usages</var> is empty, then <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">throw</a> a <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-SyntaxError\">SyntaxError</a>.\n                </p>"
        },
        {
          "html": "<p>\n                  Resolve <var>promise</var> with\n                  <var>result</var>.\n                </p>"
        }
      ]
    },
    {
      "name": "deriveBits",
      "href": "https://www.w3.org/TR/WebCryptoAPI/#dfn-SubtleCrypto-method-deriveBits",
      "html": "When invoked, <dfn id=\"dfn-SubtleCrypto-method-deriveBits\"><code>deriveBits</code></dfn>\n              <span class=\"RFC2119\">MUST</span> perform the following steps:",
      "rationale": "let",
      "steps": [
        {
          "html": "<p>\n                  Let <var>algorithm</var>, <var>baseKey</var> and <var>length</var>,\n                  be the <code>algorithm</code>,\n                  <code>baseKey</code> and <code>length</code>\n                  parameters passed to the\n                  <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-SubtleCrypto-method-deriveBits\">deriveBits</a> method,\n                  respectively.\n                </p>"
        },
        {
          "html": "<p>\n                  Let <var>normalizedAlgorithm</var> be the result of\n                  <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-normalize-an-algorithm\">normalizing an algorithm</a>, with\n                  <code>alg</code> set to <var>algorithm</var> and <code>op</code> set to\n                  <code>\"deriveBits\"</code>.\n                </p>"
        },
        {
          "html": "<p>\n                  If an error occurred, return a Promise rejected with\n                  <var>normalizedAlgorithm</var>.\n                </p>"
        },
        {
          "html": "<p>\n                  Let <var>promise</var> be a new Promise object.\n                </p>"
        },
        {
          "html": "<p>\n                  Return <var>promise</var> and asynchronously perform the remaining steps.\n                </p>"
        },
        {
          "html": "<p>\n                  If the following steps or referenced procedures say to\n                  <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">throw</a> an error,\n                  reject <var>promise</var> with\n                  the returned error and then\n                  <a href=\"https://www.w3.org/TR/WebCryptoAPI/#terminate-the-algorithm\">terminate the algorithm.</a>\n                </p>"
        },
        {
          "html": "<p>\n                  If the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-Algorithm-name\">name</a> member of\n                  <var>normalizedAlgorithm</var> is not equal to the\n                  <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-KeyAlgorithm-name\">name</a> attribute of the\n                  [[<a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-algorithm\">algorithm</a>]] internal slot of\n                  <var>baseKey</var> then <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">throw</a> an <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-InvalidAccessError\"><code>InvalidAccessError</code></a>.\n                </p>"
        },
        {
          "html": "<p>\n                  If the [[<a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-usages\">usages</a>]] internal slot of\n                  <var>baseKey</var> does not contain an entry that is <code>\"deriveBits\"</code>,\n                  then <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">throw</a> an <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-InvalidAccessError\"><code>InvalidAccessError</code></a>.\n                </p>"
        },
        {
          "html": "<p>\n                  Let <var>result</var> be a new <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-ArrayBuffer\">ArrayBuffer</a>\n                  associated with the\n                  <a href=\"https://www.w3.org/TR/html51/webappapis.html#relevant-global-object\">relevant global object</a>\n                  of <code>this</code> [<a href=\"https://www.w3.org/TR/WebCryptoAPI/#HTML\">HTML</a>], and\n                  containing the result of performing the derive bits operation\n                  specified by <var>normalizedAlgorithm</var> using <var>baseKey</var>,\n                  <var>algorithm</var> and <var>length</var>.\n                </p>"
        },
        {
          "html": "<p>\n                  Resolve <var>promise</var> with\n                  <var>result</var>.\n                </p>"
        }
      ]
    },
    {
      "name": "importKey",
      "href": "https://www.w3.org/TR/WebCryptoAPI/#dfn-SubtleCrypto-method-importKey",
      "html": "When invoked, the <dfn id=\"dfn-SubtleCrypto-method-importKey\"><code>importKey</code></dfn> method <span class=\"RFC2119\">MUST</span> perform the following steps:",
      "rationale": "let",
      "steps": [
        {
          "html": "<p>\n                  Let <var>format</var>, <var>algorithm</var>, <var>extractable</var> and\n                  <var>usages</var>, be the <code>format</code>, <code>algorithm</code>,\n                  <code>extractable</code> and <code>keyUsages</code> parameters passed to the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-SubtleCrypto-method-importKey\">importKey</a> method, respectively.\n                </p>"
        },
        {
          "html": "<dl class=\"switch\">\n                  <dt>\n                    If <var>format</var> is equal to the string <code>\"raw\"</code>,\n                    <code>\"pkcs8\"</code>, or <code>\"spki\"</code>:\n                  </dt>\n                  <dd>\n                    \n                  </dd>\n                  <dt>\n                    If <var>format</var> is equal to the string <code>\"jwk\"</code>:\n                  </dt>\n                  <dd>\n                    \n                  </dd>\n                </dl>",
          "rationale": ".switch",
          "steps": [
            {
              "operation": "switch",
              "steps": [
                {
                  "case": "If format is equal to the string \"raw\", \"pkcs8\", or \"spki\":",
                  "html": "",
                  "rationale": "if",
                  "steps": [
                    {
                      "html": "<p>\n                          If the <code>keyData</code> parameter passed to the\n                          <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-SubtleCrypto-method-importKey\">importKey</a> method is a\n                          JsonWebKey dictionary, <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">throw</a> a\n                          <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-TypeError\"><code>TypeError</code></a>.\n                        </p>"
                    },
                    {
                      "html": "<p>\n                          Let <var>keyData</var> be the result of\n                          <a href=\"http://heycam.github.io/webidl/#dfn-get-buffer-source-copy\">\n                          getting a copy of the bytes held by</a> the\n                          <code>keyData</code> parameter passed to the\n                          <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-SubtleCrypto-method-importKey\">importKey</a> method.\n                        </p>"
                    }
                  ]
                },
                {
                  "case": "If format is equal to the string \"jwk\":",
                  "html": "",
                  "rationale": "if",
                  "steps": [
                    {
                      "html": "<p>\n                          If the <code>keyData</code> parameter passed to the\n                          <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-SubtleCrypto-method-importKey\">importKey</a> method is not a\n                          JsonWebKey dictionary, <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">throw</a> a\n                          <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-TypeError\"><code>TypeError</code></a>.\n                        </p>"
                    },
                    {
                      "html": "<p>\n                          Let <var>keyData</var> be the <code>keyData</code> parameter passed to the\n                          <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-SubtleCrypto-method-importKey\">importKey</a> method.\n                        </p>"
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "html": "<p>\n                  Let <var>normalizedAlgorithm</var> be the result of\n                  <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-normalize-an-algorithm\">normalizing an algorithm</a>, with\n                  <code>alg</code> set to <var>algorithm</var> and <code>op</code> set to\n                  <code>\"importKey\"</code>.\n                </p>"
        },
        {
          "html": "<p>\n                  If an error occurred, return a Promise rejected with\n                  <var>normalizedAlgorithm</var>.\n                </p>"
        },
        {
          "html": "<p>\n                  Let <var>promise</var> be a new Promise.\n                </p>"
        },
        {
          "html": "<p>\n                  Return <var>promise</var> and asynchronously perform the remaining steps.\n                </p>"
        },
        {
          "html": "<p>\n                  If the following steps or referenced procedures say to\n                  <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">throw</a> an error,\n                  reject <var>promise</var> with\n                  the returned error and then\n                  <a href=\"https://www.w3.org/TR/WebCryptoAPI/#terminate-the-algorithm\">terminate the algorithm.</a>\n                </p>"
        },
        {
          "html": "<p>\n                  Let <var>result</var> be the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey\">CryptoKey</a> object that\n                  results from performing the import key operation specified by\n                  <var>normalizedAlgorithm</var> using <var>keyData</var>,\n                  <var>algorithm</var>, \n                  <var>format</var>, <var>extractable</var> and <var>usages</var>.\n                </p>"
        },
        {
          "html": "<p>\n                  If the [[<a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-type\">type</a>]] internal slot of\n                  <var>result</var> is <code>\"secret\"</code> or <code>\"private\"</code> and\n                  <var>usages</var> is empty, then <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">throw</a> a <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-SyntaxError\">SyntaxError</a>.\n                </p>"
        },
        {
          "html": "<p>\n                  Set the [[<a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-extractable\">extractable</a>]] internal\n                  slot of <var>result</var> to <var>extractable</var>.\n                </p>"
        },
        {
          "html": "<p>\n                  Set the [[<a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-usages\">usages</a>]] internal\n                  slot of <var>result</var> to the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-normalized-usages\">normalized\n                    value</a> of <var>usages</var>.\n                </p>"
        },
        {
          "html": "<p>\n                  Resolve <var>promise</var> with\n                  <var>result</var>.\n                </p>"
        }
      ]
    },
    {
      "name": "exportKey",
      "href": "https://www.w3.org/TR/WebCryptoAPI/#dfn-SubtleCrypto-method-exportKey",
      "html": "When invoked, the <dfn id=\"dfn-SubtleCrypto-method-exportKey\"><code>exportKey</code></dfn> method <span class=\"RFC2119\">MUST</span> perform the following steps:",
      "rationale": "let",
      "steps": [
        {
          "html": "<p>\n                  Let <var>format</var> and <var>key</var> be the <code>format</code> and\n                  <code>key</code> parameters passed to the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-SubtleCrypto-method-exportKey\">exportKey</a> method, respectively.\n                </p>"
        },
        {
          "html": "<p>\n                  Let <var>promise</var> be a new Promise.\n                </p>"
        },
        {
          "html": "<p>\n                  Return <var>promise</var> and asynchronously perform the remaining steps.\n                </p>"
        },
        {
          "html": "<p>\n                  If the following steps or referenced procedures say to\n                  <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">throw</a> an error,\n                  reject <var>promise</var> with\n                  the returned error and then\n                  <a href=\"https://www.w3.org/TR/WebCryptoAPI/#terminate-the-algorithm\">terminate the algorithm.</a>\n                </p>"
        },
        {
          "html": "<p>\n                  If the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-Algorithm-name\">name</a> member of of the [[<a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-algorithm\">algorithm</a>]] internal slot of\n                  <var>key</var> does not identify a <a href=\"https://www.w3.org/TR/WebCryptoAPI/#algorithms\">registered algorithm</a>\n                  that supports the export key operation, then <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">throw</a> a <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-NotSupportedError\"><code>NotSupportedError</code></a>.\n                </p>"
        },
        {
          "html": "<p>\n                  If the [[<a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-extractable\">extractable</a>]] internal slot\n                  of <var>key</var> is false, then <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">throw</a> an <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-InvalidAccessError\"><code>InvalidAccessError</code></a>.\n                </p>"
        },
        {
          "html": "<p>\n                  Let <var>result</var> be the result of performing the export key operation\n                  specified by the [[<a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-algorithm\">algorithm</a>]]\n                  internal slot of <var>key</var> using <var>key</var> and <var>format</var>.\n                </p>"
        },
        {
          "html": "<p>\n                  Resolve <var>promise</var> with\n                  <var>result</var>.\n                </p>"
        }
      ]
    },
    {
      "name": "wrapKey",
      "href": "https://www.w3.org/TR/WebCryptoAPI/#dfn-SubtleCrypto-method-wrapKey",
      "html": "When invoked, the <dfn id=\"dfn-SubtleCrypto-method-wrapKey\">wrapKey</dfn> method <span class=\"RFC2119\">MUST</span> perform the following steps:",
      "rationale": "let",
      "steps": [
        {
          "html": "<p>\n                  Let <var>format</var>, <var>key</var>, <var>wrappingKey</var> and\n                  <var>algorithm</var> be the <code>format</code>, <code>key</code>,\n                  <code>wrappingKey</code> and <code>wrapAlgorithm</code> parameters passed to the\n                  <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-SubtleCrypto-method-wrapKey\">wrapKey</a> method,\n                  respectively.\n                </p>"
        },
        {
          "html": "<p>\n                  Let <var>normalizedAlgorithm</var> be the result of\n                  <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-normalize-an-algorithm\">normalizing an algorithm</a>, with\n                  <code>alg</code> set to <var>algorithm</var> and <code>op</code> set to\n                  <code>\"wrapKey\"</code>.\n                </p>"
        },
        {
          "html": "<p>\n                  If an error occurred, let <var>normalizedAlgorithm</var> be the result of\n                  <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-normalize-an-algorithm\">normalizing an algorithm</a>, with\n                  <code>alg</code> set to <var>algorithm</var> and <code>op</code> set to\n                  <code>\"encrypt\"</code>.\n                </p>"
        },
        {
          "html": "<p>\n                  If an error occurred, return a Promise rejected with\n                  <var>normalizedAlgorithm</var>.\n                </p>"
        },
        {
          "html": "<p>\n                  Let <var>promise</var> be a new Promise.\n                </p>"
        },
        {
          "html": "<p>\n                  Return <var>promise</var> and asynchronously perform the remaining steps.\n                </p>"
        },
        {
          "html": "<p>\n                  If the following steps or referenced procedures say to\n                  <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">throw</a> an error,\n                  reject <var>promise</var> with\n                  the returned error and then\n                  <a href=\"https://www.w3.org/TR/WebCryptoAPI/#terminate-the-algorithm\">terminate the algorithm.</a>\n                </p>"
        },
        {
          "html": "<p>\n                  If the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-Algorithm-name\">name</a> member of\n                  <var>normalizedAlgorithm</var> is not equal to the\n                  <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-KeyAlgorithm-name\">name</a> attribute of the\n                  [[<a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-algorithm\">algorithm</a>]] internal slot of\n                  <var>wrappingKey</var> then <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">throw</a> an <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-InvalidAccessError\"><code>InvalidAccessError</code></a>.\n                </p>"
        },
        {
          "html": "<p>\n                  If the [[<a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-usages\">usages</a>]] internal slot of\n                  <var>wrappingKey</var> does not contain an entry that is <code>\"wrapKey\"</code>,\n                  then <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">throw</a> an <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-InvalidAccessError\"><code>InvalidAccessError</code></a>.\n                </p>"
        },
        {
          "html": "<p>\n                  If the algorithm identified by the [[<a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-algorithm\">algorithm</a>]] internal slot of\n                  <var>key</var> does not support the export key operation, then <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">throw</a> a  <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-NotSupportedError\"><code>NotSupportedError</code></a>.\n                </p>"
        },
        {
          "html": "<p>\n                  If the [[<a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-extractable\">extractable</a>]] internal slot\n                  of <var>key</var> is false, then <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">throw</a> an <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-InvalidAccessError\"><code>InvalidAccessError</code></a>.\n                </p>"
        },
        {
          "html": "<p>\n                  Let <var>key</var> be the result of performing the export key operation specified\n                  the [[<a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-algorithm\">algorithm</a>]] internal slot of\n                  <var>key</var> using <var>key</var> and <var>format</var>.\n                </p>"
        },
        {
          "html": "<dl class=\"switch\">\n                  <dt>\n                    If <var>format</var> is equal to the strings <code>\"raw\"</code>,\n                    <code>\"pkcs8\"</code>, or <code>\"spki\"</code>:\n                  </dt>\n                  <dd>\n                    Set <var>bytes</var> be set to <var>key</var>.\n                  </dd>\n                  <dt>\n                    If <var>format</var> is equal to the string <code>\"jwk\"</code>:\n                  </dt>\n                  <dd>\n                    \n                  </dd>\n                </dl>",
          "rationale": ".switch",
          "steps": [
            {
              "operation": "switch",
              "steps": [
                {
                  "case": "If format is equal to the strings \"raw\", \"pkcs8\", or \"spki\":",
                  "html": "Set <var>bytes</var> be set to <var>key</var>."
                },
                {
                  "case": "If format is equal to the string \"jwk\":",
                  "html": "",
                  "rationale": "convert",
                  "steps": [
                    {
                      "html": "<p>\n                          Convert <var>key</var> to an ECMAScript Object, as specified in [\n                          <a href=\"https://www.w3.org/TR/WebCryptoAPI/#WebIDL\">WebIDL</a>], performing the conversion in the\n                          context of a new global object.\n                        </p>"
                    },
                    {
                      "html": "<p>\n                          Let <var>json</var> be the result of representing <var>key</var> as a\n                          UTF-16 string conforming to the JSON grammar; for example, by executing\n                          the <code>JSON.stringify</code> algorithm specified in\n                          <a href=\"https://www.w3.org/TR/WebCryptoAPI/#ECMA-262\">ECMA262</a> in the context of a new global object.\n                        </p>"
                    },
                    {
                      "html": "<p>\n                          Let <var>bytes</var> be the byte sequence the results from converting\n                          <var>json</var>, a JavaScript String comprised of UTF-16 code points, to\n                          UTF-8 code points.\n                        </p>"
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "html": "<dl class=\"switch\">\n                  <dt>If <var>normalizedAlgorithm</var> supports the wrap key operation:</dt>\n                  <dd>\n                    <p>\n                      Let <var>result</var> be the result of performing the wrap key operation\n                      specified by <var>normalizedAlgorithm</var> using <var>algorithm</var>,\n                      <var>wrappingKey</var> as <var>key</var> and <var>bytes</var> as\n                      <var>plaintext</var>.\n                    </p>\n                  </dd>\n                  <dt>Otherwise, if <var>normalizedAlgorithm</var> supports the encrypt operation:</dt>\n                  <dd>\n                    <p>\n                      Let <var>result</var> be the result of performing the encrypt operation\n                      specified by <var>normalizedAlgorithm</var> using <var>algorithm</var>,\n                      <var>wrappingKey</var> as <var>key</var> and <var>bytes</var> as\n                      <var>plaintext</var>.\n                    </p>\n                  </dd>\n                  <dt>Otherwise:</dt>\n                  <dd>\n                    <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">throw</a> a\n                    <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-NotSupportedError\"><code>NotSupportedError</code></a>.\n                  </dd>\n                </dl>",
          "rationale": ".switch",
          "steps": [
            {
              "operation": "switch",
              "steps": [
                {
                  "case": "If normalizedAlgorithm supports the wrap key operation:",
                  "html": "<p>\n                      Let <var>result</var> be the result of performing the wrap key operation\n                      specified by <var>normalizedAlgorithm</var> using <var>algorithm</var>,\n                      <var>wrappingKey</var> as <var>key</var> and <var>bytes</var> as\n                      <var>plaintext</var>.\n                    </p>"
                },
                {
                  "case": "Otherwise, if normalizedAlgorithm supports the encrypt operation:",
                  "html": "<p>\n                      Let <var>result</var> be the result of performing the encrypt operation\n                      specified by <var>normalizedAlgorithm</var> using <var>algorithm</var>,\n                      <var>wrappingKey</var> as <var>key</var> and <var>bytes</var> as\n                      <var>plaintext</var>.\n                    </p>"
                },
                {
                  "case": "Otherwise:",
                  "html": "<a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">throw</a> a\n                    <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-NotSupportedError\"><code>NotSupportedError</code></a>."
                }
              ]
            }
          ]
        },
        {
          "html": "<p>\n                  Resolve <var>promise</var> with\n                  <var>result</var>.\n                </p>"
        }
      ]
    },
    {
      "name": "unwrapKey",
      "href": "https://www.w3.org/TR/WebCryptoAPI/#dfn-SubtleCrypto-method-unwrapKey",
      "html": "When invoked, the <dfn id=\"dfn-SubtleCrypto-method-unwrapKey\">unwrapKey</dfn> method\n              <span class=\"RFC2119\">MUST</span> perform the following steps:",
      "rationale": "let",
      "steps": [
        {
          "html": "<p>\n                  Let <var>format</var>, <var>unwrappingKey</var>,\n                  <var>algorithm</var>, <var>unwrappedKeyAlgorithm</var>,\n                  <var>extractable</var> and <var>usages</var>,\n                  be the <code>format</code>, <code>unwrappingKey</code>,\n                  <code>unwrapAlgorithm</code>, <code>unwrappedKeyAlgorithm</code>,\n                  <code>extractable</code> and <code>keyUsages</code>\n                  parameters passed to the\n                  <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-SubtleCrypto-method-unwrapKey\">unwrapKey</a> method,\n                  respectively.\n                </p>"
        },
        {
          "html": "<p>\n                  Let <var>wrappedKey</var> be the result of\n                  <a href=\"http://heycam.github.io/webidl/#dfn-get-buffer-source-copy\">\n                  getting a copy of the bytes held by</a> the\n                  <code>wrappedKey</code> parameter passed to the\n                  <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-SubtleCrypto-method-unwrapKey\">unwrapKey</a> method.\n                </p>"
        },
        {
          "html": "<p>\n                  Let <var>normalizedAlgorithm</var> be the result of\n                  <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-normalize-an-algorithm\">normalizing an algorithm</a>, with\n                  <code>alg</code> set to <var>algorithm</var> and <code>op</code> set to\n                  <code>\"unwrapKey\"</code>.\n                </p>"
        },
        {
          "html": "<p>\n                  If an error occurred, let <var>normalizedAlgorithm</var> be the result of\n                  <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-normalize-an-algorithm\">normalizing an algorithm</a>, with\n                  <code>alg</code> set to <var>algorithm</var> and <code>op</code> set to\n                  <code>\"decrypt\"</code>.\n                </p>"
        },
        {
          "html": "<p>\n                  If an error occurred, return a Promise rejected with\n                  <var>normalizedAlgorithm</var>.\n                </p>"
        },
        {
          "html": "<p>\n                  Let <var>normalizedKeyAlgorithm</var> be the result of <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-normalize-an-algorithm\">normalizing an algorithm</a>, with\n                  <code>alg</code> set to <var>unwrappedKeyAlgorithm</var> and <code>op</code> set\n                  to <code>\"importKey\"</code>.\n                </p>"
        },
        {
          "html": "<p>\n                  If an error occurred, return a Promise rejected with\n                  <var>normalizedKeyAlgorithm</var>.\n                </p>"
        },
        {
          "html": "<p>\n                  Let <var>promise</var> be a new Promise.\n                </p>"
        },
        {
          "html": "<p>\n                  Return <var>promise</var> and asynchronously perform the remaining steps.\n                </p>"
        },
        {
          "html": "<p>\n                  If the following steps or referenced procedures say to\n                  <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">throw</a> an error,\n                  reject <var>promise</var> with\n                  the returned error and then\n                  <a href=\"https://www.w3.org/TR/WebCryptoAPI/#terminate-the-algorithm\">terminate the algorithm.</a>\n                </p>"
        },
        {
          "html": "<p>\n                  If the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-Algorithm-name\">name</a> member of\n                  <var>normalizedAlgorithm</var> is not equal to the\n                  <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-KeyAlgorithm-name\">name</a> attribute of the\n                  [[<a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-algorithm\">algorithm</a>]] internal slot of\n                  <var>unwrappingKey</var> then <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">throw</a> an <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-InvalidAccessError\"><code>InvalidAccessError</code></a>.\n                </p>"
        },
        {
          "html": "<p>\n                  If the [[<a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-usages\">usages</a>]] internal slot of\n                  <var>unwrappingKey</var> does not contain an entry that is\n                  <code>\"unwrapKey\"</code>, then <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">throw</a> an <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-InvalidAccessError\"><code>InvalidAccessError</code></a>.\n                </p>"
        },
        {
          "html": "<dl class=\"switch\">\n                  <dt>If <var>normalizedAlgorithm</var> supports an unwrap key operation:</dt>\n                  <dd>\n                    Let <var>key</var> be the result of performing the unwrap key operation\n                    specified by <var>normalizedAlgorithm</var> using <var>algorithm</var>,\n                    <var>unwrappingKey</var> as <var>key</var> and <var>wrappedKey</var> as\n                    <var>ciphertext</var>.\n                  </dd>\n                  <dt>\n                    Otherwise, if <var>normalizedAlgorithm</var> supports a decrypt\n                    operation:\n                  </dt>\n                  <dd>\n                    Let <var>key</var> be the result of performing the decrypt operation specified\n                    by <var>normalizedAlgorithm</var> using <var>algorithm</var>,\n                    <var>unwrappingKey</var> as <var>key</var> and <var>wrappedKey</var> as\n                    <var>ciphertext</var>.\n                  </dd>\n                  <dt>Otherwise:</dt>\n                  <dd>\n                    <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">throw</a> a\n                    <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-NotSupportedError\"><code>NotSupportedError</code></a>.\n                  </dd>\n                </dl>",
          "rationale": ".switch",
          "steps": [
            {
              "operation": "switch",
              "steps": [
                {
                  "case": "If normalizedAlgorithm supports an unwrap key operation:",
                  "html": "Let <var>key</var> be the result of performing the unwrap key operation\n                    specified by <var>normalizedAlgorithm</var> using <var>algorithm</var>,\n                    <var>unwrappingKey</var> as <var>key</var> and <var>wrappedKey</var> as\n                    <var>ciphertext</var>."
                },
                {
                  "case": "Otherwise, if normalizedAlgorithm supports a decrypt operation:",
                  "html": "Let <var>key</var> be the result of performing the decrypt operation specified\n                    by <var>normalizedAlgorithm</var> using <var>algorithm</var>,\n                    <var>unwrappingKey</var> as <var>key</var> and <var>wrappedKey</var> as\n                    <var>ciphertext</var>."
                },
                {
                  "case": "Otherwise:",
                  "html": "<a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">throw</a> a\n                    <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-NotSupportedError\"><code>NotSupportedError</code></a>."
                }
              ]
            }
          ]
        },
        {
          "html": "<dl class=\"switch\">\n                  <dt>\n                    If <var>format</var> is equal to the strings <code>\"raw\"</code>,\n                    <code>\"pkcs8\"</code>, or <code>\"spki\"</code>:\n                  </dt>\n                  <dd>\n                    Set <var>bytes</var> be set to <var>key</var>.\n                  </dd>\n                  <dt>\n                    If <var>format</var> is equal to the string <code>\"jwk\"</code>:\n                  </dt>\n                  <dd>\n                    Let <var>bytes</var> be the result of executing the\n                    <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-parse-a-jwk\">parse a JWK</a> algorithm, with <var>key</var>\n                    as the <code>data</code> to be parsed.\n                  </dd>\n                </dl>",
          "rationale": ".switch",
          "steps": [
            {
              "operation": "switch",
              "steps": [
                {
                  "case": "If format is equal to the strings \"raw\", \"pkcs8\", or \"spki\":",
                  "html": "Set <var>bytes</var> be set to <var>key</var>."
                },
                {
                  "case": "If format is equal to the string \"jwk\":",
                  "html": "Let <var>bytes</var> be the result of executing the\n                    <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-parse-a-jwk\">parse a JWK</a> algorithm, with <var>key</var>\n                    as the <code>data</code> to be parsed."
                }
              ]
            }
          ]
        },
        {
          "html": "<p>\n                  Let <var>result</var> be the result of performing the import key operation\n                  specified by <var>normalizedKeyAlgorithm</var> using\n                  <var>unwrappedKeyAlgorithm</var> as <var>algorithm</var>, <var>format</var>,\n                  <var>usages</var>\n                  and <var>extractable</var> and with\n                  <var>bytes</var> as <var>keyData</var>.\n                </p>"
        },
        {
          "html": "<p>\n                  If the [[<a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-type\">type</a>]] internal slot of\n                  <var>result</var> is <code>\"secret\"</code> or <code>\"private\"</code> and\n                  <var>usages</var> is empty, then <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">throw</a> a <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-SyntaxError\"><code>SyntaxError</code></a>.\n                </p>"
        },
        {
          "html": "<p>\n                  Set the [[<a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-extractable\">extractable</a>]] internal\n                  slot of <var>result</var> to <var>extractable</var>.\n                </p>"
        },
        {
          "html": "<p>\n                  Set the [[<a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-usages\">usages</a>]] internal\n                  slot of <var>result</var> to the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-normalized-usages\">normalized\n                    value</a> of <var>usages</var>.\n                </p>"
        },
        {
          "html": "<p>\n                  Resolve <var>promise</var> with\n                  <var>result</var>.\n                </p>"
        }
      ]
    },
    {
      "html": "The initial contents of this internal object are as follows:",
      "rationale": "for",
      "steps": [
        {
          "html": "<p>\n                  For each value, <var>v</var> in the List of <a href=\"https://www.w3.org/TR/WebCryptoAPI/#supported-operation\">supported operations</a>, set the <var>v</var> key of\n                   the internal object [[<a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-supportedAlgorithms\">supportedAlgorithms</a>]]\n                   to a new associative container.\n                </p>"
        }
      ]
    },
    {
      "name": "define an algorithm",
      "href": "https://www.w3.org/TR/WebCryptoAPI/#concept-define-an-algorithm",
      "html": "The <dfn id=\"concept-define-an-algorithm\">define an algorithm</dfn> algorithm is used\n              by specification authors to indicate how a user agent should normalize arguments for a\n              particular algorithm. Its input is an algorithm name <var>alg</var>, represented as a\n              DOMString, operation name <var>op</var>, represented as a DOMString, and desired IDL\n              dictionary type <var>type</var>. The algorithm behaves as follows:",
      "rationale": "let",
      "steps": [
        {
          "html": "Let <var>registeredAlgorithms</var> be the associative container stored at the\n                <var>op</var> key of [[<a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-supportedAlgorithms\">supportedAlgorithms</a>]].."
        },
        {
          "html": "Set the <var>alg</var> key of <var>registeredAlgorithms</var> to the IDL dictionary\n                type <var>type</var>."
        }
      ]
    },
    {
      "name": "normalize an algorithm",
      "href": "https://www.w3.org/TR/WebCryptoAPI/#dfn-normalize-an-algorithm",
      "html": "The <dfn id=\"dfn-normalize-an-algorithm\">normalize an algorithm</dfn> algorithm defines\n              a process for coercing inputs to a targeted IDL dictionary type, after Web IDL\n              conversion has occurred. It is designed to be extensible, to allow future specifications\n              to define additional algorithms, as well as safe for use with Promises. Its input is an\n              operation name <var>op</var> and an <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-AlgorithmIdentifier\">AlgorithmIdentifier</a> <var>alg</var>. Its output is\n              either an IDL dictionary type or an error. It behaves as follows:",
      "rationale": ".switch",
      "steps": [
        {
          "operation": "switch",
          "steps": [
            {
              "case": "If alg is an instance of a DOMString:",
              "html": "<p>\n                  Return the result of running the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-normalize-an-algorithm\">normalize an algorithm</a> algorithm, with\n                  the <code>alg</code> set to a new <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-Algorithm\">Algorithm</a>\n                  dictionary whose <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-KeyAlgorithm-name\">name</a> attribute is\n                  <var>alg</var>, and with the <code>op</code> set to <var>op</var>.\n                </p>"
            },
            {
              "case": "If alg is an object:",
              "html": "",
              "rationale": "let",
              "steps": [
                {
                  "html": "Let <var>registeredAlgorithms</var> be the associative container stored at the\n                    <code>op</code> key of [[<a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-supportedAlgorithms\">supportedAlgorithms</a>]]."
                },
                {
                  "html": "Let <var>initialAlg</var> be the result of converting the ECMAScript object\n                    represented by <var>alg</var> to the IDL dictionary type <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-Algorithm\">Algorithm</a>, as defined by [<a href=\"https://www.w3.org/TR/WebCryptoAPI/#WebIDL\">WebIDL</a>]."
                },
                {
                  "html": "If an error occurred, return the error and terminate this algorithm."
                },
                {
                  "html": "Let <var>algName</var> be the value of the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-Algorithm-name\">name</a>\n                    attribute of <var>initialAlg</var>."
                },
                {
                  "html": "<dl class=\"switch\">\n                      <dt>\n                        If <var>registeredAlgorithms</var> contains a key that is a\n                        <a href=\"https://www.w3.org/TR/WebCryptoAPI/#case-insensitive\">case-insensitive</a> string match for\n                        <var>algName</var>:\n                      </dt>\n                      <dd>\n                        \n                      </dd>\n                      <dt>Otherwise:</dt>\n                      <dd>\n                        Return a new <code>NotSupportedError</code> and terminate this algorithm.\n                      </dd>\n                    </dl>",
                  "rationale": ".switch",
                  "steps": [
                    {
                      "operation": "switch",
                      "steps": [
                        {
                          "case": "If registeredAlgorithms contains a key that is a case-insensitive string match for algName:",
                          "html": "",
                          "rationale": "set",
                          "steps": [
                            {
                              "html": "<p>\n                              Set <var>algName</var> to the value of the matching key.\n                            </p>"
                            },
                            {
                              "html": "<p>\n                              Let <var>desiredType</var> be the IDL dictionary type stored at\n                              <var>algName</var> in <var>registeredAlgorithms</var>.\n                            </p>"
                            }
                          ]
                        },
                        {
                          "case": "Otherwise:",
                          "html": "Return a new <code>NotSupportedError</code> and terminate this algorithm."
                        }
                      ]
                    }
                  ]
                },
                {
                  "html": "Let <var>normalizedAlgorithm</var> be the result of converting the ECMAScript\n                    object represented by <var>alg</var> to the IDL dictionary type\n                    <var>desiredType</var>, as defined by [<a href=\"https://www.w3.org/TR/WebCryptoAPI/#WebIDL\">WebIDL</a>]."
                },
                {
                  "html": "Set the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-Algorithm-name\">name</a> attribute of\n                    <var>normalizedAlgorithm</var> to <var>algName</var>."
                },
                {
                  "html": "If an error occurred, return the error and terminate this algorithm."
                },
                {
                  "html": "Let <var>dictionaries</var> be a list consisting of the IDL dictionary type\n                    <var>desiredType</var> and all of <var>desiredType</var>'s inherited dictionaries,\n                    in order from least to most derived."
                },
                {
                  "html": "For each dictionary <var>dictionary</var> in <var>dictionaries</var>:",
                  "rationale": "for",
                  "steps": [
                    {
                      "html": "For each dictionary member <var>member</var> declared on\n                          <var>dictionary</var>, in order:",
                      "rationale": "let",
                      "steps": [
                        {
                          "html": "Let <var>key</var> be the identifier of <var>member</var>."
                        },
                        {
                          "html": "Let <var>idlValue</var> be the value of the dictionary member with\n                            key name of <var>key</var> on <var>normalizedAlgorithm</var>."
                        },
                        {
                          "html": "<dl class=\"switch\">\n                              <dt>\n                                If <var>member</var> is of the type\n                                <a href=\"http://heycam.github.io/webidl/#common-BufferSource\">BufferSource</a> and is\n                                present:\n                              </dt>\n                              <dd>\n                                Set the dictionary member on <var>normalizedAlgorithm</var> with key\n                                name <var>key</var> to the result of\n                                <a href=\"http://heycam.github.io/webidl/#dfn-get-buffer-source-copy\">\n                                getting a copy of the bytes held by</a>\n                                <var>idlValue</var>, replacing the current value.\n                              </dd>\n                              <dt>\n                                If <var>member</var> is of the type\n                                <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-HashAlgorithmIdentifier\">HashAlgorithmIdentifier</a>:\n                              </dt>\n                              <dd>\n                                Set the dictionary member on <var>normalizedAlgorithm</var> with key\n                                name <var>key</var> to the result of\n                                <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-normalize-an-algorithm\">normalizing an algorithm</a>,\n                                with the <code>alg</code> set to <var>idlValue</var> and the\n                                <code>op</code> set to <code>\"digest\"</code>.\n                              </dd>\n                              <dt>\n                                If <var>member</var> is of the type\n                                <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-AlgorithmIdentifier\">AlgorithmIdentifier</a>:\n                              </dt>\n                              <dd>\n                                Set the dictionary member on <var>normalizedAlgorithm</var> with key\n                                name <var>key</var> to the result of\n                                <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-normalize-an-algorithm\">normalizing an algorithm</a>,\n                                with the <code>alg</code> set to <var>idlValue</var> and the\n                                <code>op</code> set to the operation defined by the specification\n                                that defines the algorithm identified by <var>algName</var>.\n                              </dd>\n                            </dl>",
                          "rationale": ".switch",
                          "steps": [
                            {
                              "operation": "switch",
                              "steps": [
                                {
                                  "case": "If member is of the type BufferSource and is present:",
                                  "html": "Set the dictionary member on <var>normalizedAlgorithm</var> with key\n                                name <var>key</var> to the result of\n                                <a href=\"http://heycam.github.io/webidl/#dfn-get-buffer-source-copy\">\n                                getting a copy of the bytes held by</a>\n                                <var>idlValue</var>, replacing the current value."
                                },
                                {
                                  "case": "If member is of the type HashAlgorithmIdentifier:",
                                  "html": "Set the dictionary member on <var>normalizedAlgorithm</var> with key\n                                name <var>key</var> to the result of\n                                <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-normalize-an-algorithm\">normalizing an algorithm</a>,\n                                with the <code>alg</code> set to <var>idlValue</var> and the\n                                <code>op</code> set to <code>\"digest\"</code>."
                                },
                                {
                                  "case": "If member is of the type AlgorithmIdentifier:",
                                  "html": "Set the dictionary member on <var>normalizedAlgorithm</var> with key\n                                name <var>key</var> to the result of\n                                <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-normalize-an-algorithm\">normalizing an algorithm</a>,\n                                with the <code>alg</code> set to <var>idlValue</var> and the\n                                <code>op</code> set to the operation defined by the specification\n                                that defines the algorithm identified by <var>algName</var>."
                                }
                              ]
                            }
                          ]
                        },
                        {
                          "html": "If an error occurred, return the error and terminate this algorithm."
                        }
                      ]
                    }
                  ]
                },
                {
                  "html": "Return <var>normalizedAlgorithm</var>."
                }
              ]
            }
          ]
        }
      ]
    },
    {
      "html": "",
      "rationale": "if",
      "steps": [
        {
          "html": "<p>\n                    If the [[<a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-type\">type</a>]] internal slot of\n                    <var>key</var> is not <code>\"private\"</code>, then <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">throw</a> an <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-InvalidAccessError\"><code>InvalidAccessError</code></a>.\n                  </p>"
        },
        {
          "html": "<p>\n                    Perform the signature generation operation defined in Section 8.2 of [<cite><a href=\"https://www.w3.org/TR/WebCryptoAPI/#RFC3447\">RFC3447</a></cite>] with the key represented by the [[<a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-handle\">handle</a>]] internal slot of <var>key</var>\n                    as the signer's private key and the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-contents-of-arraybuffer\">contents of <var>message</var></a> as\n                    <var>M</var> and using the hash function specified in the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-RsaHashedKeyAlgorithm-hash\">hash</a> attribute of the [[<a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-algorithm\">algorithm</a>]] internal slot of\n                    <var>key</var> as the Hash option for the EMSA-PKCS1-v1_5 encoding method.\n                  </p>"
        },
        {
          "html": "<p>\n                    If performing the operation results in an error,\n                    then <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">throw</a> an\n                    <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-OperationError\"><code>OperationError</code></a>.\n                  </p>"
        },
        {
          "html": "<p>\n                    Let <var>signature</var> be the value <var>S</var> that results from\n                    performing the operation.\n                  </p>"
        },
        {
          "html": "<p>\n                    Return a new <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-ArrayBuffer\">ArrayBuffer</a> associated with the\n                    <a href=\"https://www.w3.org/TR/html51/webappapis.html#relevant-global-object\">relevant global object</a>\n                    of <code>this</code> [<a href=\"https://www.w3.org/TR/WebCryptoAPI/#HTML\">HTML</a>], and containing the\n                    bytes of <var>signature</var>.\n                  </p>"
        }
      ]
    },
    {
      "html": "",
      "rationale": "if",
      "steps": [
        {
          "html": "<p>\n                    If the [[<a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-type\">type</a>]] internal slot of\n                    <var>key</var> is not <code>\"public\"</code>, then <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">throw</a> an <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-InvalidAccessError\"><code>InvalidAccessError</code></a>.\n                  </p>"
        },
        {
          "html": "<p>\n                    Perform the signature verification operation defined in Section 8.2 of\n                    [<cite><a href=\"https://www.w3.org/TR/WebCryptoAPI/#RFC3447\">RFC3447</a></cite>] with the key represented by the\n                    [[<a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-handle\">handle</a>]] internal slot of\n                    <var>key</var> as the signer's RSA public key and the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-contents-of-arraybuffer\">contents of <var>message</var></a> as\n                    <var>M</var> and the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-contents-of-arraybuffer\">contents of\n                    <var>signature</var></a> as <var>S</var> and using the hash function specified\n                    in the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-RsaHashedKeyAlgorithm-hash\">hash</a> attribute of the\n                    [[<a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-algorithm\">algorithm</a>]] internal slot of\n                    <var>key</var> as the Hash option for the EMSA-PKCS1-v1_5 encoding method.\n                  </p>"
        },
        {
          "html": "<p>\n                    Let <var>result</var> be a boolean with value true if the\n                    result of the operation was \"valid signature\" and the value\n                    false otherwise.\n                  </p>"
        },
        {
          "html": "<p>Return <var>result</var>.</p>"
        }
      ]
    },
    {
      "html": "",
      "rationale": "if",
      "steps": [
        {
          "html": "<p>\n                    If <var>usages</var> contains an entry which is not\n                     <code>\"sign\"</code> or <code>\"verify\"</code>,\n                    then <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">throw</a> a\n                    <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-SyntaxError\"><code>SyntaxError</code></a>.\n                  </p>"
        },
        {
          "html": "<p>\n                    Generate an RSA key pair, as defined in [<cite><a href=\"https://www.w3.org/TR/WebCryptoAPI/#RFC3447\">RFC3447</a></cite>], with RSA modulus length equal to the\n                    <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-RsaKeyGenParams-modulusLength\">modulusLength</a> attribute of\n                    <var>normalizedAlgorithm</var> and RSA public exponent equal to the\n                    <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-RsaKeyGenParams-publicExponent\">publicExponent</a> attribute of\n                    <var>normalizedAlgorithm</var>.\n                  </p>"
        },
        {
          "html": "<p>\n                    If generation of the key pair fails,\n                    then <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">throw</a> an\n                    <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-OperationError\"><code>OperationError</code></a>.\n                  </p>"
        },
        {
          "html": "<p>\n                    Let <var>algorithm</var> be a new\n                    <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-RsaHashedKeyAlgorithm\">RsaHashedKeyAlgorithm</a>\n                    dictionary.\n                  </p>"
        },
        {
          "html": "<p>\n                    Set the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-KeyAlgorithm-name\">name</a> attribute of\n                    <var>algorithm</var> to <code>\"RSASSA-PKCS1-v1_5\"</code>.\n                  </p>"
        },
        {
          "html": "<p>\n                    Set the\n                    <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-RsaKeyAlgorithm-modulusLength\">modulusLength</a>\n                    attribute of <var>algorithm</var> to equal the\n                    <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-RsaKeyGenParams-modulusLength\">modulusLength</a>\n                    attribute of <var>normalizedAlgorithm</var>.\n                  </p>"
        },
        {
          "html": "<p>\n                    Set the\n                    <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-RsaKeyAlgorithm-publicExponent\">publicExponent</a>\n                    attribute of <var>algorithm</var> to equal the\n                    <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-RsaKeyGenParams-publicExponent\">publicExponent</a>\n                    attribute of <var>normalizedAlgorithm</var>.\n                  </p>"
        },
        {
          "html": "<p>\n                    Set the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-RsaHashedKeyAlgorithm-hash\">hash</a> attribute\n                    of <var>algorithm</var> to equal the\n                    <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-RsaHashedKeyGenParams\">hash</a> member of\n                    <var>normalizedAlgorithm</var>.\n                  </p>"
        },
        {
          "html": "<p>\n                    Let <var>publicKey</var> be a new <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey\">CryptoKey</a>\n                    object, associated with the\n                    <a href=\"https://www.w3.org/TR/html51/webappapis.html#relevant-global-object\">relevant global object</a>\n                    of <code>this</code> [<a href=\"https://www.w3.org/TR/WebCryptoAPI/#HTML\">HTML</a>], and representing the public key of the generated key pair.\n                  </p>"
        },
        {
          "html": "<p>\n                    Set the [[<a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-type\">type</a>]] internal slot of\n                    <var>publicKey</var> to <code>\"public\"</code>\n                  </p>"
        },
        {
          "html": "<p>\n                    Set the [[<a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-algorithm\">algorithm</a>]] internal\n                    slot of <var>publicKey</var> to <var>algorithm</var>.\n                  </p>"
        },
        {
          "html": "<p>\n                    Set the [[<a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-extractable\">extractable</a>]] internal\n                    slot of <var>publicKey</var> to true.\n                  </p>"
        },
        {
          "html": "<p>\n                    Set the [[<a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-usages\">usages</a>]] internal slot of\n                    <var>publicKey</var> to be the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-usage-intersection\">usage\n                    intersection</a> of <var>usages</var> and <code>[ \"verify\" ]</code>.\n                  </p>"
        },
        {
          "html": "<p>\n                    Let <var>privateKey</var> be a new <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey\">CryptoKey</a> associated with the\n                    <a href=\"https://www.w3.org/TR/html51/webappapis.html#relevant-global-object\">relevant global object</a>\n                    of <code>this</code> [<a href=\"https://www.w3.org/TR/WebCryptoAPI/#HTML\">HTML</a>], and \n                    representing the private key of the generated key pair.\n                  </p>"
        },
        {
          "html": "<p>\n                    Set the [[<a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-type\">type</a>]] internal slot of\n                    <var>privateKey</var> to <code>\"private\"</code>\n                  </p>"
        },
        {
          "html": "<p>\n                    Set the [[<a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-algorithm\">algorithm</a>]] internal\n                    slot of <var>privateKey</var> to <var>algorithm</var>.\n                  </p>"
        },
        {
          "html": "<p>\n                    Set the [[<a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-extractable\">extractable</a>]] internal\n                    slot of <var>privateKey</var> to <var>extractable</var>.\n                  </p>"
        },
        {
          "html": "<p>\n                    Set the [[<a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-usages\">usages</a>]] internal slot of\n                    <var>privateKey</var> to be the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-usage-intersection\">usage\n                    intersection</a> of <var>usages</var> and <code>[ \"sign\" ]</code>.\n                  </p>"
        },
        {
          "html": "<p>\n                    Let <var>result</var> be a new <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKeyPair\">CryptoKeyPair</a>\n                    dictionary.\n                  </p>"
        },
        {
          "html": "<p>\n                    Set the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKeyPair-publicKey\">publicKey</a> attribute\n                    of <var>result</var> to be <var>publicKey</var>.\n                  </p>"
        },
        {
          "html": "<p>\n                    Set the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKeyPair-privateKey\">privateKey</a> attribute\n                    of <var>result</var> to be <var>privateKey</var>.\n                  </p>"
        },
        {
          "html": "<p>\n                    Return <var>result</var>.\n                  </p>"
        }
      ]
    },
    {
      "html": "",
      "rationale": "let",
      "steps": [
        {
          "html": "<p>Let <var>keyData</var> be the key data to be imported.</p>"
        },
        {
          "html": "<dl class=\"switch\">\n                    <dt>If <var>format</var> is <code>\"spki\"</code>:</dt>\n                    <dd>\n                      \n                    </dd>\n                    <dt>If <var>format</var> is <code>\"pkcs8\"</code>:</dt>\n                    <dd>\n                      \n                    </dd>\n                    <dt>If <var>format</var> is <code>\"jwk\"</code>:</dt>\n                    <dd>\n                      \n                    </dd>\n                    <dt>Otherwise:</dt>\n                    <dd>\n                      <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">throw</a> a\n                      <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-NotSupportedError\"><code>NotSupportedError</code></a>.\n                    </dd>\n                  </dl>",
          "rationale": ".switch",
          "steps": [
            {
              "operation": "switch",
              "steps": [
                {
                  "case": "If format is \"spki\":",
                  "html": "",
                  "rationale": "if",
                  "steps": [
                    {
                      "html": "<p>\n                            If <var>usages</var> contains an entry which is not\n                            <code>\"verify\"</code>,\n                            then <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">throw</a> a\n                            <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-SyntaxError\"><code>SyntaxError</code></a>.\n                          </p>"
                    },
                    {
                      "html": "<p>\n                            Let <var>spki</var> be the result of running the\n                            <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-parse-a-spki\">parse a subjectPublicKeyInfo</a>\n                            algorithm over <var>keyData</var>.\n                          </p>"
                    },
                    {
                      "html": "<p>\n                            If an error occurred while parsing,\n                            then <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">throw</a> a\n                            <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-DataError\"><code>DataError</code></a>.\n                          </p>"
                    },
                    {
                      "html": "<p>\n                            Let <var>hash</var> be undefined.\n                          </p>"
                    },
                    {
                      "html": "<p>\n                            Let <var>alg</var> be the <code>algorithm</code> object identifier\n                            field of the <code>algorithm</code> AlgorithmIdentifier field of\n                            <var>spki</var>.\n                          </p>"
                    },
                    {
                      "html": "<dl class=\"switch\">\n                            <dt>\n                              If <var>alg</var> is equivalent to the <code>rsaEncryption</code>\n                              OID defined in Section 2.3.1 of <a href=\"https://www.w3.org/TR/WebCryptoAPI/#RFC3279\">RFC 3279</a>:\n                            </dt>\n                            <dd>\n                              <p>\n                                Let <var>hash</var> be undefined.\n                              </p>\n                            </dd>\n                            <dt>\n                              If <var>alg</var> is equivalent to the\n                              <code>sha1WithRSAEncryption</code> OID defined in Section A.2.4 of\n                              <a href=\"https://www.w3.org/TR/WebCryptoAPI/#RFC3279\">RFC 3279</a>:\n                            </dt>\n                            <dd>\n                              <p>\n                                Let <var>hash</var> be the string <code>\"SHA-1\"</code>.\n                              </p>\n                            </dd>\n                            <dt>\n                              If <var>alg</var> is equivalent to the\n                              <code>sha256WithRSAEncryption</code> OID defined in Section A.2.4 of\n                              <a href=\"https://www.w3.org/TR/WebCryptoAPI/#RFC3447\">RFC 3447</a>:\n                            </dt>\n                            <dd>\n                              <p>\n                                Let <var>hash</var> be the string <code>\"SHA-256\"</code>.\n                              </p>\n                            </dd>\n                            <dt>\n                              If <var>alg</var> is equivalent to the\n                              <code>sha384WithRSAEncryption</code> OID defined in Section A.2.4 of\n                              <a href=\"https://www.w3.org/TR/WebCryptoAPI/#RFC3447\">RFC 3447</a>:\n                            </dt>\n                            <dd>\n                              <p>\n                                Let <var>hash</var> be the string <code>\"SHA-384\"</code>.\n                              </p>\n                            </dd>\n                            <dt>\n                              If <var>alg</var> is equivalent to the\n                              <code>sha512WithRSAEncryption</code> OID defined in Section A.2.4 of\n                              <a href=\"https://www.w3.org/TR/WebCryptoAPI/#RFC3447\">RFC 3447</a>:\n                            </dt>\n                            <dd>\n                              <p>\n                                Let <var>hash</var> be the string <code>\"SHA-512\"</code>.\n                              </p>\n                            </dd>\n                            <dt>Otherwise:</dt>\n                            <dd>\n                              \n                            </dd>\n                          </dl>",
                      "rationale": ".switch",
                      "steps": [
                        {
                          "operation": "switch",
                          "steps": [
                            {
                              "case": "If alg is equivalent to the rsaEncryption OID defined in Section 2.3.1 of RFC 3279:",
                              "html": "<p>\n                                Let <var>hash</var> be undefined.\n                              </p>"
                            },
                            {
                              "case": "If alg is equivalent to the sha1WithRSAEncryption OID defined in Section A.2.4 of RFC 3279:",
                              "html": "<p>\n                                Let <var>hash</var> be the string <code>\"SHA-1\"</code>.\n                              </p>"
                            },
                            {
                              "case": "If alg is equivalent to the sha256WithRSAEncryption OID defined in Section A.2.4 of RFC 3447:",
                              "html": "<p>\n                                Let <var>hash</var> be the string <code>\"SHA-256\"</code>.\n                              </p>"
                            },
                            {
                              "case": "If alg is equivalent to the sha384WithRSAEncryption OID defined in Section A.2.4 of RFC 3447:",
                              "html": "<p>\n                                Let <var>hash</var> be the string <code>\"SHA-384\"</code>.\n                              </p>"
                            },
                            {
                              "case": "If alg is equivalent to the sha512WithRSAEncryption OID defined in Section A.2.4 of RFC 3447:",
                              "html": "<p>\n                                Let <var>hash</var> be the string <code>\"SHA-512\"</code>.\n                              </p>"
                            },
                            {
                              "case": "Otherwise:",
                              "html": "",
                              "rationale": "perform",
                              "steps": [
                                {
                                  "html": "<p>\n                                    Perform any <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-rsa-ssa-extended-import-steps\">key\n                                    import steps</a> defined by\n                                    <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-applicable-specification\">other applicable\n                                    specifications</a>, passing <var>format</var>, <var>spki</var>\n                                    and obtaining <var>hash</var>.\n                                  </p>"
                                },
                                {
                                  "html": "<p>\n                                    If an error occurred or there are no\n                                    <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-applicable-specification\">applicable\n                                    specifications</a>,\n                                    <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">throw</a> a\n                                    <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-DataError\"><code>DataError</code></a>.\n                                  </p>"
                                }
                              ]
                            }
                          ]
                        }
                      ]
                    },
                    {
                      "html": "<dl>\n                            <dt>\n                              If <var>hash</var> is not undefined:\n                            </dt>\n                            <dd>\n                              \n                            </dd>\n                          </dl>",
                      "rationale": "let",
                      "steps": [
                        {
                          "html": "<p>\n                                    Let <var>normalizedHash</var> be the result of\n                                    <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-normalize-an-algorithm\">normalize an algorithm</a>\n                                    with <code>alg</code> set to <var>hash</var> and <code>op</code> set\n                                    to <code>digest</code>.\n                                  </p>"
                        },
                        {
                          "html": "<p>\n                                    If <var>normalizedHash</var> is not equal to the\n                                    <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-RsaHashedImportParams-hash\">hash</a> member of\n                                    <var>normalizedAlgorithm</var>, <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">throw</a> a <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-DataError\"><code>DataError</code></a>.\n                                  </p>"
                        }
                      ]
                    },
                    {
                      "html": "<p>\n                            Let <var>publicKey</var> be the result of performing the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-parse-an-asn1-structure\">parse an ASN.1 structure</a>\n                            algorithm, with <var>data</var> as the\n                            <code>subjectPublicKeyInfo</code> field of <var>spki</var>,\n                            <var>structure</var> as the <code>RSAPublicKey</code> structure\n                            specified in Section A.1.1 of <a href=\"https://www.w3.org/TR/WebCryptoAPI/#RFC3447\">RFC 3447</a>, and\n                            <var>exactData</var> set to true.\n                          </p>"
                    },
                    {
                      "html": "<p>\n                            If an error occurred while parsing, or it can be determined that <var>publicKey</var>\n                            is not a valid public key according to <a href=\"https://www.w3.org/TR/WebCryptoAPI/#RFC3447\">RFC 3447</a>,\n                            then <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">throw</a> a\n                            <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-DataError\"><code>DataError</code></a>.\n                          </p>"
                    },
                    {
                      "html": "<p>\n                            Let <var>key</var> be a new <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey\">CryptoKey</a> associated with the\n                            <a href=\"https://www.w3.org/TR/html51/webappapis.html#relevant-global-object\">relevant global object</a>\n                            of <code>this</code> [<a href=\"https://www.w3.org/TR/WebCryptoAPI/#HTML\">HTML</a>], and\n                            that represents the RSA public key identified by\n                            <var>publicKey</var>.\n                          </p>"
                    },
                    {
                      "html": "<p>\n                            Set the [[<a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-type\">type</a>]] internal slot\n                            of <var>key</var> to <code>\"public\"</code>\n                          </p>"
                    }
                  ]
                },
                {
                  "case": "If format is \"pkcs8\":",
                  "html": "",
                  "rationale": "if",
                  "steps": [
                    {
                      "html": "<p>\n                            If <var>usages</var> contains an entry which is not\n                             <code>\"sign\"</code>\n                            then <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">throw</a> a\n                            <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-SyntaxError\"><code>SyntaxError</code></a>.\n                          </p>"
                    },
                    {
                      "html": "<p>\n                            Let <var>privateKeyInfo</var> be the result of running the\n                            <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-parse-a-privateKeyInfo\">parse a privateKeyInfo</a>\n                            algorithm over <var>keyData</var>.\n                          </p>"
                    },
                    {
                      "html": "<p>\n                            If an error occurred while parsing,\n                            then <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">throw</a> a\n                            <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-DataError\"><code>DataError</code></a>.\n                          </p>"
                    },
                    {
                      "html": "<p>\n                            Let <var>hash</var> be undefined.\n                          </p>"
                    },
                    {
                      "html": "<p>\n                            Let <var>alg</var> be the <code>algorithm</code> object identifier\n                            field of the <code>privateKeyAlgorithm</code>\n                            PrivateKeyAlgorithmIdentifier field of <var>privateKeyInfo</var>.\n                          </p>"
                    },
                    {
                      "html": "<dl class=\"switch\">\n                            <dt>\n                              If <var>alg</var> is equivalent to the <code>rsaEncryption</code>\n                              OID defined in Section 2.3.1 of <a href=\"https://www.w3.org/TR/WebCryptoAPI/#RFC3279\">RFC 3279</a>:\n                            </dt>\n                            <dd>\n                              <p>\n                                Let <var>hash</var> be undefined.\n                              </p>\n                            </dd>\n                            <dt>\n                              If <var>alg</var> is equivalent to the\n                              <code>sha1WithRSAEncryption</code> OID defined in Section A.2.4 of\n                              <a href=\"https://www.w3.org/TR/WebCryptoAPI/#RFC3279\">RFC 3279</a>:\n                            </dt>\n                            <dd>\n                              <p>\n                                Let <var>hash</var> be the string <code>\"SHA-1\"</code>.\n                              </p>\n                            </dd>\n                            <dt>\n                              If <var>alg</var> is equivalent to the\n                              <code>sha256WithRSAEncryption</code> OID defined in Section A.2.4 of\n                              <a href=\"https://www.w3.org/TR/WebCryptoAPI/#RFC3447\">RFC 3447</a>:\n                            </dt>\n                            <dd>\n                              <p>\n                                Let <var>hash</var> be the string <code>\"SHA-256\"</code>.\n                              </p>\n                            </dd>\n                            <dt>\n                              If <var>alg</var> is equivalent to the\n                              <code>sha384WithRSAEncryption</code> OID defined in Section A.2.4 of\n                              <a href=\"https://www.w3.org/TR/WebCryptoAPI/#RFC3447\">RFC 3447</a>:\n                            </dt>\n                            <dd>\n                              <p>\n                                Let <var>hash</var> be the string <code>\"SHA-384\"</code>.\n                              </p>\n                            </dd>\n                            <dt>\n                              If <var>alg</var> is equivalent to the\n                              <code>sha512WithRSAEncryption</code> OID defined in Section A.2.4 of\n                              <a href=\"https://www.w3.org/TR/WebCryptoAPI/#RFC3447\">RFC 3447</a>:\n                            </dt>\n                            <dd>\n                              <p>\n                                Let <var>hash</var> be the string <code>\"SHA-512\"</code>.\n                              </p>\n                            </dd>\n                            <dt>Otherwise:</dt>\n                            <dd>\n                              \n                            </dd>\n                          </dl>",
                      "rationale": ".switch",
                      "steps": [
                        {
                          "operation": "switch",
                          "steps": [
                            {
                              "case": "If alg is equivalent to the rsaEncryption OID defined in Section 2.3.1 of RFC 3279:",
                              "html": "<p>\n                                Let <var>hash</var> be undefined.\n                              </p>"
                            },
                            {
                              "case": "If alg is equivalent to the sha1WithRSAEncryption OID defined in Section A.2.4 of RFC 3279:",
                              "html": "<p>\n                                Let <var>hash</var> be the string <code>\"SHA-1\"</code>.\n                              </p>"
                            },
                            {
                              "case": "If alg is equivalent to the sha256WithRSAEncryption OID defined in Section A.2.4 of RFC 3447:",
                              "html": "<p>\n                                Let <var>hash</var> be the string <code>\"SHA-256\"</code>.\n                              </p>"
                            },
                            {
                              "case": "If alg is equivalent to the sha384WithRSAEncryption OID defined in Section A.2.4 of RFC 3447:",
                              "html": "<p>\n                                Let <var>hash</var> be the string <code>\"SHA-384\"</code>.\n                              </p>"
                            },
                            {
                              "case": "If alg is equivalent to the sha512WithRSAEncryption OID defined in Section A.2.4 of RFC 3447:",
                              "html": "<p>\n                                Let <var>hash</var> be the string <code>\"SHA-512\"</code>.\n                              </p>"
                            },
                            {
                              "case": "Otherwise:",
                              "html": "",
                              "rationale": "perform",
                              "steps": [
                                {
                                  "html": "<p>\n                                    Perform any <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-rsa-ssa-extended-import-steps\">key\n                                    import steps</a> defined by\n                                    <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-applicable-specification\">other applicable\n                                    specifications</a>, passing <var>format</var>, <var>privateKeyInfo</var>\n                                    and obtaining <var>hash</var>.\n                                  </p>"
                                },
                                {
                                  "html": "<p>\n                                    If an error occurred or there are no\n                                    <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-applicable-specification\">applicable\n                                    specifications</a>,\n                                    <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">throw</a> a\n                                    <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-DataError\"><code>DataError</code></a>.\n                                  </p>"
                                }
                              ]
                            }
                          ]
                        }
                      ]
                    },
                    {
                      "html": "<dl>\n                            <dt>\n                              If <var>hash</var> is not undefined:\n                            </dt>\n                            <dd>\n                              \n                            </dd>\n                          </dl>",
                      "rationale": "let",
                      "steps": [
                        {
                          "html": "<p>\n                                    Let <var>normalizedHash</var> be the result of\n                                    <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-normalize-an-algorithm\">normalize an algorithm</a>\n                                    with <code>alg</code> set to <var>hash</var> and <code>op</code> set\n                                    to <code>digest</code>.\n                                  </p>"
                        },
                        {
                          "html": "<p>\n                                    If <var>normalizedHash</var> is not equal to the\n                                    <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-RsaHashedImportParams-hash\">hash</a> member of\n                                    <var>normalizedAlgorithm</var>, <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">throw</a> a <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-DataError\"><code>DataError</code></a>.\n                                  </p>"
                        }
                      ]
                    },
                    {
                      "html": "<p>\n                            Let <var>rsaPrivateKey</var> be the result of performing the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-parse-an-asn1-structure\">parse an ASN.1 structure</a>\n                            algorithm, with <var>data</var> as the\n                            <code>privateKey</code> field of <var>privateKeyInfo</var>,\n                            <var>structure</var> as the <code>RSAPrivateKey</code> structure\n                            specified in Section A.1.2 of <a href=\"https://www.w3.org/TR/WebCryptoAPI/#RFC3447\">RFC 3447</a>, and\n                            <var>exactData</var> set to true.\n                          </p>"
                    },
                    {
                      "html": "<p>\n                            If an error occurred while parsing, or if <var>rsaPrivateKey</var> is not\n                            a valid RSA private key according to <a href=\"https://www.w3.org/TR/WebCryptoAPI/#RFC3447\">RFC 3447</a>,\n                            then <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">throw</a> a\n                            <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-DataError\"><code>DataError</code></a>.\n                          </p>"
                    },
                    {
                      "html": "<p>\n                            Let <var>key</var> be a new <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey\">CryptoKey</a> associated with the\n                            <a href=\"https://www.w3.org/TR/html51/webappapis.html#relevant-global-object\">relevant global object</a>\n                            of <code>this</code> [<a href=\"https://www.w3.org/TR/WebCryptoAPI/#HTML\">HTML</a>], and\n                            that represents the RSA private key identified by\n                            <var>rsaPrivateKey</var>.\n                          </p>"
                    },
                    {
                      "html": "<p>\n                            Set the [[<a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-type\">type</a>]] internal slot\n                            of <var>key</var> to <code>\"private\"</code>\n                          </p>"
                    }
                  ]
                },
                {
                  "case": "If format is \"jwk\":",
                  "html": "",
                  "rationale": "if",
                  "steps": [
                    {
                      "html": "<dl class=\"switch\">\n                            <dt>If <var>keyData</var> is a <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-JsonWebKey\">JsonWebKey</a> dictionary:</dt>\n                            <dd><p>Let <var>jwk</var> equal <var>keyData</var>.</p></dd>\n                            <dt>Otherwise:</dt>\n                            <dd><p><a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">Throw</a> a <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-DataError\"><code>DataError</code></a>.</p></dd>\n                          </dl>",
                      "rationale": ".switch",
                      "steps": [
                        {
                          "operation": "switch",
                          "steps": [
                            {
                              "case": "If keyData is a JsonWebKey dictionary:",
                              "html": "<p>Let <var>jwk</var> equal <var>keyData</var>.</p>"
                            },
                            {
                              "case": "Otherwise:",
                              "html": "<p><a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">Throw</a> a <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-DataError\"><code>DataError</code></a>.</p>"
                            }
                          ]
                        }
                      ]
                    },
                    {
                      "html": "<p>\n                            If the <code>\"d\"</code> field of <var>jwk</var> is present and\n                            <var>usages</var> contains an entry which is not\n                            <code>\"sign\"</code>, or, if the <code>\"d\"</code> field of <var>jwk</var>\n                            is not present and\n                            <var>usages</var> contains an entry which is not\n                            <code>\"verify\"</code>\n                            then <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">throw</a> a\n                            <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-SyntaxError\"><code>SyntaxError</code></a>.\n                          </p>"
                    },
                    {
                      "html": "<p>\n                            If the <code>\"kty\"</code> field of <var>jwk</var> is not a\n                            case-sensitive string match to <code>\"RSA\"</code>,\n                            then <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">throw</a> a\n                            <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-DataError\"><code>DataError</code></a>.\n                          </p>"
                    },
                    {
                      "html": "<p>\n                            If <var>usages</var> is non-empty and the <code>\"use\"</code> field of <var>jwk</var> is present and is\n                            not a case-sensitive string match to <code>\"sig\"</code>,\n                            then <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">throw</a> a\n                            <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-DataError\"><code>DataError</code></a>.\n                          </p>"
                    },
                    {
                      "html": "<p>\n                            If the <code>\"key_ops\"</code> field of <var>jwk</var> is present, and\n                            is invalid according to the requirements of\n                            <a href=\"https://www.w3.org/TR/WebCryptoAPI/#jwk\">JSON Web Key</a> or\n                            does not contain all of the specified <var>usages</var> values,\n                            then <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">throw</a> a\n                            <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-DataError\"><code>DataError</code></a>.\n                          </p>"
                    },
                    {
                      "html": "<p>\n                            If the <code>\"ext\"</code> field of <var>jwk</var> is present and\n                            has the value false and <var>extractable</var> is true,\n                            then <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">throw</a> a\n                            <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-DataError\"><code>DataError</code></a>.\n                          </p>"
                    },
                    {
                      "html": "<p>\n                            Let <var>hash</var> be a be a string whose initial value is\n                            undefined.\n                          </p>"
                    },
                    {
                      "html": "<dl class=\"switch\">\n                            <dt>\n                              If the <code>\"alg\"</code> field of <var>jwk</var> is not\n                              present:\n                            </dt>\n                            <dd>\n                              <p>\n                                Let <var>hash</var> be undefined.\n                              </p>\n                            </dd>\n                            <dt>\n                              If the <code>\"alg\"</code> field is equal to the string\n                              <code>\"RS1\"</code>:\n                            </dt>\n                            <dd>\n                              <p>\n                                Let <var>hash</var> be the string <code>\"SHA-1\"</code>.\n                              </p>\n                            </dd>\n                            <dt>\n                              If the <code>\"alg\"</code> field is equal to the string\n                              <code>\"RS256\"</code>:\n                            </dt>\n                            <dd>\n                              <p>\n                                Let <var>hash</var> be the string <code>\"SHA-256\"</code>.\n                              </p>\n                            </dd>\n                            <dt>\n                              If the <code>\"alg\"</code> field is equal to the string\n                              <code>\"RS384\"</code>:\n                            </dt>\n                            <dd>\n                              <p>\n                                Let <var>hash</var> be the string <code>\"SHA-384\"</code>.\n                              </p>\n                            </dd>\n                            <dt>\n                              If the <code>\"alg\"</code> field is equal to the string\n                              <code>\"RS512\"</code>:\n                            </dt>\n                            <dd>\n                              <p>\n                                Let <var>hash</var> be the string <code>\"SHA-512\"</code>.\n                              </p>\n                            </dd>\n                            <dt>Otherwise:</dt>\n                            <dd>\n                              \n                            </dd>\n                          </dl>",
                      "rationale": ".switch",
                      "steps": [
                        {
                          "operation": "switch",
                          "steps": [
                            {
                              "case": "If the \"alg\" field of jwk is not present:",
                              "html": "<p>\n                                Let <var>hash</var> be undefined.\n                              </p>"
                            },
                            {
                              "case": "If the \"alg\" field is equal to the string \"RS1\":",
                              "html": "<p>\n                                Let <var>hash</var> be the string <code>\"SHA-1\"</code>.\n                              </p>"
                            },
                            {
                              "case": "If the \"alg\" field is equal to the string \"RS256\":",
                              "html": "<p>\n                                Let <var>hash</var> be the string <code>\"SHA-256\"</code>.\n                              </p>"
                            },
                            {
                              "case": "If the \"alg\" field is equal to the string \"RS384\":",
                              "html": "<p>\n                                Let <var>hash</var> be the string <code>\"SHA-384\"</code>.\n                              </p>"
                            },
                            {
                              "case": "If the \"alg\" field is equal to the string \"RS512\":",
                              "html": "<p>\n                                Let <var>hash</var> be the string <code>\"SHA-512\"</code>.\n                              </p>"
                            },
                            {
                              "case": "Otherwise:",
                              "html": "",
                              "rationale": "perform",
                              "steps": [
                                {
                                  "html": "<p>\n                                    Perform any <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-rsa-ssa-extended-import-steps\">key\n                                    import steps</a> defined by\n                                    <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-applicable-specification\">other applicable\n                                    specifications</a>, passing <var>format</var>, <var>jwk</var>\n                                    and obtaining <var>hash</var>.\n                                  </p>"
                                },
                                {
                                  "html": "<p>\n                                    If an error occurred or there are no\n                                    <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-applicable-specification\">applicable\n                                    specifications</a>,\n                                    <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">throw</a> a\n                                    <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-DataError\"><code>DataError</code></a>.\n                                  </p>"
                                }
                              ]
                            }
                          ]
                        }
                      ]
                    },
                    {
                      "html": "<dl>\n                            <dt>\n                              If <var>hash</var> is not undefined:\n                            </dt>\n                            <dd>\n                              \n                            </dd>\n                          </dl>",
                      "rationale": "let",
                      "steps": [
                        {
                          "html": "<p>\n                                    Let <var>normalizedHash</var> be the result of\n                                    <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-normalize-an-algorithm\">normalize an algorithm</a>\n                                    with <code>alg</code> set to <var>hash</var> and <code>op</code> set\n                                    to <code>digest</code>.\n                                  </p>"
                        },
                        {
                          "html": "<p>\n                                    If <var>normalizedHash</var> is not equal to the\n                                    <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-RsaHashedImportParams-hash\">hash</a> member of\n                                    <var>normalizedAlgorithm</var>, <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">throw</a> a <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-DataError\"><code>DataError</code></a>.\n                                  </p>"
                        }
                      ]
                    },
                    {
                      "html": "<dl class=\"switch\">\n                            <dt>If the <code>\"d\"</code> field of <var>jwk</var> is present:</dt>\n                            <dd>\n                              \n                            </dd>\n                            <dt>Otherwise:</dt>\n                            <dd>\n                              \n                            </dd>\n                          </dl>",
                      "rationale": ".switch",
                      "steps": [
                        {
                          "operation": "switch",
                          "steps": [
                            {
                              "case": "If the \"d\" field of jwk is present:",
                              "html": "",
                              "rationale": "if",
                              "steps": [
                                {
                                  "html": "<p>\n                                    If <var>jwk</var> does not meet the requirements of\n                                    Section 6.3.2 of <a href=\"https://www.w3.org/TR/WebCryptoAPI/#jwa\">JSON Web\n                                    Algorithms</a>,\n                                    then <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">throw</a> a\n                                    <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-DataError\"><code>DataError</code></a>.\n                                  </p>"
                                },
                                {
                                  "html": "<p>\n                                    Let <var>privateKey</var> represents the\n                                    RSA private key identified by interpreting <var>jwk</var>\n                                    according to Section 6.3.2 of <a href=\"https://www.w3.org/TR/WebCryptoAPI/#jwa\"> JSON Web\n                                    Algorithms</a>.\n                                  </p>"
                                },
                                {
                                  "html": "<p>\n                                    If <var>privateKey</var> is not a valid RSA private key\n                                    according to <a href=\"https://www.w3.org/TR/WebCryptoAPI/#RFC3447\">RFC 3447</a>,\n                                    then <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">throw</a> a\n                                    <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-DataError\"><code>DataError</code></a>.\n                                  </p>"
                                },
                                {
                                  "html": "<p>\n                                    Let <var>key</var> be a new <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey\">CryptoKey</a> object that represents\n                                    <var>privateKey</var>.\n                                  </p>"
                                },
                                {
                                  "html": "<p>\n                                    Set the [[<a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-type\">type</a>]]\n                                    internal slot of <var>key</var> to <code>\"private\"</code>\n                                  </p>"
                                }
                              ]
                            },
                            {
                              "case": "Otherwise:",
                              "html": "",
                              "rationale": "if",
                              "steps": [
                                {
                                  "html": "<p>\n                                    If <var>jwk</var> does not meet the requirements of Section\n                                    6.3.1 of <a href=\"https://www.w3.org/TR/WebCryptoAPI/#jwa\">JSON Web Algorithms</a>, then <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">throw</a> a <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-DataError\"><code>DataError</code></a>.\n                                  </p>"
                                },
                                {
                                  "html": "<p>\n                                    Let <var>publicKey</var> represent the\n                                    RSA public key identified by interpreting <var>jwk</var>\n                                    according to Section 6.3.1 of <a href=\"https://www.w3.org/TR/WebCryptoAPI/#jwa\"> JSON Web\n                                    Algorithms</a>.\n                                  </p>"
                                },
                                {
                                  "html": "<p>\n                                    If <var>publicKey</var> can be determined to not be a valid RSA public key\n                                    according to <a href=\"https://www.w3.org/TR/WebCryptoAPI/#RFC3447\">RFC 3447</a>,\n                                    then <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">throw</a> a\n                                    <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-DataError\"><code>DataError</code></a>.\n                                  </p>"
                                },
                                {
                                  "html": "<p>\n                                    Let <var>key</var> be a new <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey\">CryptoKey</a> representing <var>publicKey</var>.\n                                  </p>"
                                },
                                {
                                  "html": "<p>\n                                    Set the [[<a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-type\">type</a>]]\n                                    internal slot of <var>key</var> to <code>\"public\"</code>\n                                  </p>"
                                }
                              ]
                            }
                          ]
                        }
                      ]
                    }
                  ]
                },
                {
                  "case": "Otherwise:",
                  "html": "<a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">throw</a> a\n                      <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-NotSupportedError\"><code>NotSupportedError</code></a>."
                }
              ]
            }
          ]
        },
        {
          "html": "<p>\n                    Let <var>algorithm</var> be a new\n                    <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-RsaHashedKeyAlgorithm\">RsaHashedKeyAlgorithm</a> dictionary.\n                  </p>"
        },
        {
          "html": "<p>\n                    Set the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-KeyAlgorithm-name\">name</a> attribute of\n                    <var>algorithm</var> to <code>\"RSASSA-PKCS1-v1_5\"</code>\n                  </p>"
        },
        {
          "html": "<p>\n                    Set the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-RsaKeyAlgorithm-modulusLength\">modulusLength</a>\n                    attribute of <var>algorithm</var> to the length, in bits, of the RSA public\n                    modulus.\n                  </p>"
        },
        {
          "html": "<p>\n                    Set the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-RsaKeyAlgorithm-publicExponent\">publicExponent</a>\n                    attribute of <var>algorithm</var> to the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-BigInteger\">BigInteger</a>\n                    representation of the RSA public exponent.\n                  </p>"
        },
        {
          "html": "<p>\n                    Set the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-RsaHashedKeyAlgorithm-hash\">hash</a> attribute of\n                    <var>algorithm</var> to the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-RsaHashedImportParams-hash\">hash</a> member of\n                    <var>normalizedAlgorithm</var>.\n                  </p>"
        },
        {
          "html": "<p>\n                    Set the [[<a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-algorithm\">algorithm</a>]] internal\n                    slot of <var>key</var> to <var>algorithm</var>.\n                  </p>"
        },
        {
          "html": "<p>Return <var>key</var>.</p>"
        }
      ]
    },
    {
      "html": "",
      "rationale": "let",
      "steps": [
        {
          "html": "<p>\n                    Let <var>key</var> be the key to be exported.\n                  </p>"
        },
        {
          "html": "<p>\n                    If the underlying cryptographic key material represented by the [[<a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-handle\">handle</a>]] internal slot of <var>key</var>\n                    cannot be accessed, then <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">throw</a> an <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-OperationError\"><code>OperationError</code></a>.\n                  </p>"
        },
        {
          "html": "<dl class=\"switch\">\n                    <dt>If <var>format</var> is <code>\"spki\"</code></dt>\n                    <dd>\n                      \n                    </dd>\n                    <dt>If <var>format</var> is <code>\"pkcs8\"</code>:</dt>\n                    <dd>\n                      \n                    </dd>\n                    <dt>If <var>format</var> is <code>\"jwk\"</code>:</dt>\n                    <dd>\n                      <ul>\n                        <li>\n                          <p>Let <var>jwk</var> be a new <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-JsonWebKey\">JsonWebKey</a>\n                          dictionary.</p>\n                        </li>\n                        <li>\n                          <p>Set the <code>kty</code> attribute of <var>jwk</var> to the string\n                          <code>\"RSA\"</code>.</p>\n                        </li>\n                        <li>\n                          <p>\n                            Let <var>hash</var> be the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-KeyAlgorithm-name\">name</a>\n                            attribute of the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-RsaHashedKeyAlgorithm-hash\">hash</a>\n                            attribute of <var>key</var>.\n                          </p>\n                        </li>\n                        <li>\n                          <dl class=\"switch\">\n                            <dt>If <var>hash</var> is <code>\"SHA-1\"</code>:</dt>\n                            <dd>\n                              <p>\n                                Set the <code>alg</code> attribute of <var>jwk</var> to the string\n                                <code>\"RS1\"</code>.\n                              </p>\n                            </dd>\n                            <dt>If <var>hash</var> is <code>\"SHA-256\"</code>:</dt>\n                            <dd>\n                              <p>\n                                Set the <code>alg</code> attribute of <var>jwk</var> to the string\n                                <code>\"RS256\"</code>.\n                              </p>\n                            </dd>\n                            <dt>If <var>hash</var> is <code>\"SHA-384\"</code>:</dt>\n                            <dd>\n                              <p>\n                                Set the <code>alg</code> attribute of <var>jwk</var> to the string\n                                <code>\"RS384\"</code>.\n                              </p>\n                            </dd>\n                            <dt>If <var>hash</var> is <code>\"SHA-512\"</code>:</dt>\n                            <dd>\n                              <p>\n                                Set the <code>alg</code> attribute of <var>jwk</var> to the string\n                                <code>\"RS512\"</code>.\n                              </p>\n                            </dd>\n                            <dt>Otherwise:</dt>\n                            <dd>\n                              \n                            </dd>\n                          </dl>\n                        </li>\n                        <li>\n                          <p>\n                            Set the attributes <code>n</code> and <code>e</code> of <var>jwk</var>\n                            according to the corresponding definitions in <a href=\"https://www.w3.org/TR/WebCryptoAPI/#jwa\">JSON Web\n                            Algorithms</a>, Section 6.3.1.\n                          </p>\n                        </li>\n                        <li>\n                          <dl class=\"switch\">\n                            <dt>\n                              If the [[<a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-type\">type</a>]] internal slot\n                              of <var>key</var> is <code>\"private\"</code>:\n                            </dt>\n                            <dd>\n                              \n                            </dd>\n                          </dl>\n                        </li>\n                        <li>\n                          <p>\n                            Set the <code>key_ops</code> attribute of <var>jwk</var> to the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-usages\">usages</a> attribute of <var>key</var>.\n                          </p>\n                        </li>\n                        <li>\n                          <p>\n                            Set the <code>ext</code> attribute of <var>jwk</var> to the [[<a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-extractable\">extractable</a>]] internal slot\n                            of <var>key</var>.\n                          </p>\n                        </li>\n                        <li>\n                          <p>\n                            Let <var>result</var> be the result of converting <var>jwk</var>\n                            to an ECMAScript Object, as defined by [<a href=\"https://www.w3.org/TR/WebCryptoAPI/#WebIDL\">WebIDL</a>].\n                          </p>\n                        </li>\n                      </ul>\n                    </dd>\n                    <dt>Otherwise</dt>\n                    <dd>\n                      <p>\n                        <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">throw</a> a\n                        <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-NotSupportedError\"><code>NotSupportedError</code></a>.\n                      </p>\n                    </dd>\n                  </dl>",
          "rationale": ".switch",
          "steps": [
            {
              "operation": "switch",
              "steps": [
                {
                  "case": "If format is \"spki\"",
                  "html": "",
                  "rationale": "if",
                  "steps": [
                    {
                      "html": "<p>\n                            If the [[<a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-type\">type</a>]] internal slot\n                            of <var>key</var> is not <code>\"public\"</code>, then <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">throw</a> an <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-InvalidAccessError\"><code>InvalidAccessError</code></a>.\n                          </p>"
                    },
                    {
                      "html": "<p>\n                            Let <var>data</var> be an instance of the <code>subjectPublicKeyInfo</code>\n                            ASN.1 structure defined in <a href=\"https://www.w3.org/TR/WebCryptoAPI/#RFC5280\">RFC 5280</a>\n                            with the following properties:\n                          </p>\n                          <ul>\n                            <li>\n                              <p>\n                                Set the <var>algorithm</var> field to an\n                                <code>AlgorithmIdentifier</code> ASN.1 type with the following\n                                properties:\n                              </p>\n                              <ul>\n                                <li>\n                                  <p>\n                                    Set the <var>algorithm</var> field to the OID\n                                    <code>1.2.840.113549.1.1.1</code>\n                                  </p>\n                                </li>\n                                <li>\n                                  <p>\n                                    Set the <var>params</var> field to the ASN.1 type NULL.\n                                  </p>\n                                </li>\n                              </ul>\n                            </li>\n                            <li>\n                              <p>\n                                Set the <var>subjectPublicKey</var> field to the result of\n                                DER-encoding an <code>RSAPublicKey</code> ASN.1 type, as defined\n                                in <a href=\"https://www.w3.org/TR/WebCryptoAPI/#RFC3447\">RFC 3447</a>, Appendix A.1.1, that\n                                represents the RSA public key represented by the [[<a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-handle\">handle</a>]] internal slot of\n                                <var>key</var>\n                              </p>\n                            </li>\n                          </ul>"
                    },
                    {
                      "html": "<p>\n                            Let <var>result</var> be a new <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-ArrayBuffer\">ArrayBuffer</a> associated with the\n                            <a href=\"https://www.w3.org/TR/html51/webappapis.html#relevant-global-object\">relevant global object</a>\n                            of <code>this</code> [<a href=\"https://www.w3.org/TR/WebCryptoAPI/#HTML\">HTML</a>], and containing\n                            <var>data</var>.\n                          </p>"
                    }
                  ]
                },
                {
                  "case": "If format is \"pkcs8\":",
                  "html": "",
                  "rationale": "if",
                  "steps": [
                    {
                      "html": "<p>\n                            If the [[<a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-type\">type</a>]] internal slot\n                            of <var>key</var> is not <code>\"private\"</code>, then <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">throw</a> an <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-InvalidAccessError\"><code>InvalidAccessError</code></a>.\n                          </p>"
                    },
                    {
                      "html": "<p>\n                            Let <var>data</var> be the result of encoding a privateKeyInfo structure\n                            with the following properties:\n                          </p>\n                          <ul>\n                            <li>\n                              <p>\n                                Set the <var>version</var> field to 0.\n                              </p>\n                            </li>\n                            <li>\n                              <p>\n                                Set the <var>privateKeyAlgorithm</var> field to a\n                                <code>PrivateKeyAlgorithmIdentifier</code> ASN.1 type with the\n                                following properties:\n                              </p>\n                              <ul>\n                                <li>\n                                  <p>\n                                    Set the <var>algorithm</var> field to the OID\n                                    <code>1.2.840.113549.1.1.1</code>\n                                  </p>\n                                </li>\n                                <li>\n                                  <p>\n                                    Set the <var>params</var> field to the ASN.1 type NULL.\n                                  </p>\n                                </li>\n                              </ul>\n                            </li>\n                            <li>\n                              <p>\n                                Set the <var>privateKey</var> field to the result of DER-encoding\n                                an <code>RSAPrivateKey</code> ASN.1 type, as defined in <a href=\"https://www.w3.org/TR/WebCryptoAPI/#RFC3447\">RFC 3447</a>, Appendix A.1.2, that represents the\n                                RSA private key represented by the [[<a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-handle\">handle</a>]] internal slot of\n                                <var>key</var>\n                              </p>\n                              \n                            </li>\n                          </ul>"
                    },
                    {
                      "html": "<p>\n                            Let <var>result</var> be a new <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-ArrayBuffer\">ArrayBuffer</a> associated with the\n                            <a href=\"https://www.w3.org/TR/html51/webappapis.html#relevant-global-object\">relevant global object</a>\n                            of <code>this</code> [<a href=\"https://www.w3.org/TR/WebCryptoAPI/#HTML\">HTML</a>], and containing\n                            <var>data</var>.\n                          </p>"
                    }
                  ]
                },
                {
                  "case": "If format is \"jwk\":",
                  "html": "<ul>\n                        <li>\n                          <p>Let <var>jwk</var> be a new <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-JsonWebKey\">JsonWebKey</a>\n                          dictionary.</p>\n                        </li>\n                        <li>\n                          <p>Set the <code>kty</code> attribute of <var>jwk</var> to the string\n                          <code>\"RSA\"</code>.</p>\n                        </li>\n                        <li>\n                          <p>\n                            Let <var>hash</var> be the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-KeyAlgorithm-name\">name</a>\n                            attribute of the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-RsaHashedKeyAlgorithm-hash\">hash</a>\n                            attribute of <var>key</var>.\n                          </p>\n                        </li>\n                        <li>\n                          <dl class=\"switch\">\n                            <dt>If <var>hash</var> is <code>\"SHA-1\"</code>:</dt>\n                            <dd>\n                              <p>\n                                Set the <code>alg</code> attribute of <var>jwk</var> to the string\n                                <code>\"RS1\"</code>.\n                              </p>\n                            </dd>\n                            <dt>If <var>hash</var> is <code>\"SHA-256\"</code>:</dt>\n                            <dd>\n                              <p>\n                                Set the <code>alg</code> attribute of <var>jwk</var> to the string\n                                <code>\"RS256\"</code>.\n                              </p>\n                            </dd>\n                            <dt>If <var>hash</var> is <code>\"SHA-384\"</code>:</dt>\n                            <dd>\n                              <p>\n                                Set the <code>alg</code> attribute of <var>jwk</var> to the string\n                                <code>\"RS384\"</code>.\n                              </p>\n                            </dd>\n                            <dt>If <var>hash</var> is <code>\"SHA-512\"</code>:</dt>\n                            <dd>\n                              <p>\n                                Set the <code>alg</code> attribute of <var>jwk</var> to the string\n                                <code>\"RS512\"</code>.\n                              </p>\n                            </dd>\n                            <dt>Otherwise:</dt>\n                            <dd>\n                              \n                            </dd>\n                          </dl>\n                        </li>\n                        <li>\n                          <p>\n                            Set the attributes <code>n</code> and <code>e</code> of <var>jwk</var>\n                            according to the corresponding definitions in <a href=\"https://www.w3.org/TR/WebCryptoAPI/#jwa\">JSON Web\n                            Algorithms</a>, Section 6.3.1.\n                          </p>\n                        </li>\n                        <li>\n                          <dl class=\"switch\">\n                            <dt>\n                              If the [[<a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-type\">type</a>]] internal slot\n                              of <var>key</var> is <code>\"private\"</code>:\n                            </dt>\n                            <dd>\n                              \n                            </dd>\n                          </dl>\n                        </li>\n                        <li>\n                          <p>\n                            Set the <code>key_ops</code> attribute of <var>jwk</var> to the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-usages\">usages</a> attribute of <var>key</var>.\n                          </p>\n                        </li>\n                        <li>\n                          <p>\n                            Set the <code>ext</code> attribute of <var>jwk</var> to the [[<a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-extractable\">extractable</a>]] internal slot\n                            of <var>key</var>.\n                          </p>\n                        </li>\n                        <li>\n                          <p>\n                            Let <var>result</var> be the result of converting <var>jwk</var>\n                            to an ECMAScript Object, as defined by [<a href=\"https://www.w3.org/TR/WebCryptoAPI/#WebIDL\">WebIDL</a>].\n                          </p>\n                        </li>\n                      </ul>",
                  "rationale": ".switch",
                  "steps": [
                    {
                      "operation": "switch",
                      "steps": [
                        {
                          "case": "If hash is \"SHA-1\":",
                          "html": "<p>\n                                Set the <code>alg</code> attribute of <var>jwk</var> to the string\n                                <code>\"RS1\"</code>.\n                              </p>"
                        },
                        {
                          "case": "If hash is \"SHA-256\":",
                          "html": "<p>\n                                Set the <code>alg</code> attribute of <var>jwk</var> to the string\n                                <code>\"RS256\"</code>.\n                              </p>"
                        },
                        {
                          "case": "If hash is \"SHA-384\":",
                          "html": "<p>\n                                Set the <code>alg</code> attribute of <var>jwk</var> to the string\n                                <code>\"RS384\"</code>.\n                              </p>"
                        },
                        {
                          "case": "If hash is \"SHA-512\":",
                          "html": "<p>\n                                Set the <code>alg</code> attribute of <var>jwk</var> to the string\n                                <code>\"RS512\"</code>.\n                              </p>"
                        },
                        {
                          "case": "Otherwise:",
                          "html": "",
                          "rationale": "perform",
                          "steps": [
                            {
                              "html": "<p>\n                                    Perform any <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-rsa-ssa-extended-export-steps\">key\n                                    export steps</a> defined by\n                                    <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-applicable-specification\">other applicable\n                                    specifications</a>, passing <var>format</var>, <var>key</var>\n                                    and obtaining <var>alg</var>.\n                                  </p>"
                            },
                            {
                              "html": "<p>\n                                    If an error occurred or there are no\n                                    <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-applicable-specification\">applicable\n                                    specifications</a>,\n                                    <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">throw</a> a\n                                    <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-NotSupportedError\"><code>NotSupportedError</code></a>.\n                                  </p>"
                            },
                            {
                              "html": "<p>\n                                    Set the <code>alg</code> attribute of <var>jwk</var> to <var>alg</var>.\n                                  </p>"
                            }
                          ]
                        }
                      ]
                    }
                  ],
                  "additional": [
                    {
                      "html": "",
                      "rationale": ".switch",
                      "steps": [
                        {
                          "operation": "switch",
                          "steps": [
                            {
                              "case": "If the [[type]] internal slot of key is \"private\":",
                              "html": "",
                              "rationale": "set",
                              "steps": [
                                {
                                  "html": "<p>\n                                    Set the attributes named <code>d</code>, <code>p</code>,\n                                    <code>q</code>, <code>dp</code>, <code>dq</code>, and\n                                    <code>qi</code> of <var>jwk</var> according to the\n                                    corresponding definitions in <a href=\"https://www.w3.org/TR/WebCryptoAPI/#jwa\">JSON Web\n                                    Algorithms</a>, Section 6.3.2.\n                                  </p>"
                                },
                                {
                                  "html": "<p>\n                                    If the underlying RSA private key represented by the [[<a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-handle\">handle</a>]] internal slot\n                                    of <var>key</var> is represented by more than two primes, set\n                                    the attribute named <code>oth</code> of <var>jwk</var>\n                                    according to the corresponding definition in <a href=\"https://www.w3.org/TR/WebCryptoAPI/#jwa\">JSON Web Algorithms</a>, Section 6.3.2.7\n                                  </p>"
                                }
                              ]
                            }
                          ]
                        }
                      ]
                    }
                  ]
                },
                {
                  "case": "Otherwise",
                  "html": "<p>\n                        <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">throw</a> a\n                        <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-NotSupportedError\"><code>NotSupportedError</code></a>.\n                      </p>"
                }
              ]
            }
          ]
        },
        {
          "html": "<p>\n                    Return <var>result</var>.\n                  </p>"
        }
      ]
    },
    {
      "html": "",
      "rationale": "if",
      "steps": [
        {
          "html": "<p>\n                    If the [[<a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-type\">type</a>]] internal slot of\n                    <var>key</var> is not <code>\"private\"</code>, then <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">throw</a> an <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-InvalidAccessError\"><code>InvalidAccessError</code></a>.\n                  </p>"
        },
        {
          "html": "<p>\n                    Perform the signature generation operation defined in Section 8.1 of [<cite><a href=\"https://www.w3.org/TR/WebCryptoAPI/#RFC3447\">RFC3447</a></cite>] with the key represented by the [[<a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-handle\">handle</a>]] internal slot of <var>key</var>\n                    as the signer's private key, <var>K</var>, and the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-contents-of-arraybuffer\">contents of <var>message</var></a> as\n                    the message to be signed, <var>M</var>, and using the hash function specified\n                    by the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-RsaHashedKeyAlgorithm-hash\">hash</a> attribute of the\n                    [[<a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-algorithm\">algorithm</a>]] internal slot of\n                    <var>key</var> as the Hash option, MGF1 (defined in Section B.2.1 of [<cite><a href=\"https://www.w3.org/TR/WebCryptoAPI/#RFC3447\">RFC3447</a></cite>]) as the MGF option and the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-RsaPssParams-saltLength\">saltLength</a> member of\n                    <var>normalizedAlgorithm</var> as the salt length option for the\n                    EMM-PSS-ENCODE operation.\n                  </p>"
        },
        {
          "html": "<p>\n                    If performing the operation results in an error,\n                    then <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">throw</a> an\n                    <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-OperationError\"><code>OperationError</code></a>.\n                  </p>"
        },
        {
          "html": "<p>\n                    Let <var>signature</var> be the\n                    signature, S, that results from performing the operation.\n                  </p>"
        },
        {
          "html": "<p>\n                    Return a new <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-ArrayBuffer\">ArrayBuffer</a> associated with the\n                    <a href=\"https://www.w3.org/TR/html51/webappapis.html#relevant-global-object\">relevant global object</a>\n                    of <code>this</code> [<a href=\"https://www.w3.org/TR/WebCryptoAPI/#HTML\">HTML</a>], and containing the\n                    bytes of <var>signature</var>.\n                  </p>"
        }
      ]
    },
    {
      "html": "",
      "rationale": "if",
      "steps": [
        {
          "html": "<p>\n                    If the [[<a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-type\">type</a>]] internal slot of\n                    <var>key</var> is not <code>\"public\"</code>, then <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">throw</a> an <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-InvalidAccessError\"><code>InvalidAccessError</code></a>.\n                  </p>"
        },
        {
          "html": "<p>\n                    Perform the signature verification operation defined in Section 8.1 of\n                    [<cite><a href=\"https://www.w3.org/TR/WebCryptoAPI/#RFC3447\">RFC3447</a></cite>] with the key represented by the\n                    [[<a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-handle\">handle</a>]] internal slot of\n                    <var>key</var> as the signer's RSA public key and the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-contents-of-arraybuffer\">contents of <var>message</var></a> as\n                    <var>M</var> and <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-contents-of-arraybuffer\">the contents of\n                    <var>signature</var></a> as <var>S</var> and using the hash function specified\n                    by the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-RsaHashedKeyAlgorithm-hash\">hash</a> attribute of the\n                    [[<a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-algorithm\">algorithm</a>]] internal slot of\n                    <var>key</var> as the Hash option, MGF1 (defined in Section B.2.1 of [<cite><a href=\"https://www.w3.org/TR/WebCryptoAPI/#RFC3447\">RFC3447</a></cite>]) as the MGF option and the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-RsaPssParams-saltLength\">saltLength</a> member of\n                    <var>normalizedAlgorithm</var> as the salt length option for the\n                    EMSA-PSS-VERIFY operation.\n                  </p>"
        },
        {
          "html": "<p>\n                    Let <var>result</var> be a boolean with the value true if the\n                    result of the operation was \"valid signature\" and the value\n                    false otherwise.\n                  </p>"
        }
      ]
    },
    {
      "html": "",
      "rationale": "if",
      "steps": [
        {
          "html": "<p>\n                    If <var>usages</var> contains an entry which is not\n                    <code>\"sign\"</code> or <code>\"verify\"</code>,\n                    then <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">throw</a> a\n                    <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-SyntaxError\"><code>SyntaxError</code></a>.\n                  </p>"
        },
        {
          "html": "<p>\n                    Generate an RSA key pair, as defined in [<cite><a href=\"https://www.w3.org/TR/WebCryptoAPI/#RFC3447\">RFC3447</a></cite>], with RSA modulus length equal to the\n                    <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-RsaKeyGenParams-modulusLength\">modulusLength</a> member of\n                    <var>normalizedAlgorithm</var> and RSA public exponent equal to the\n                    <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-RsaKeyGenParams-publicExponent\">publicExponent</a> member of\n                    <var>normalizedAlgorithm</var>.\n                  </p>"
        },
        {
          "html": "<p>\n                    If performing the operation results in an error,\n                    then <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">throw</a> an\n                    <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-OperationError\"><code>OperationError</code></a>.\n                  </p>"
        },
        {
          "html": "<p>\n                    Let <var>algorithm</var> be a new\n                    <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-RsaHashedKeyAlgorithm\">RsaHashedKeyAlgorithm</a>\n                    dictionary.\n                  </p>"
        },
        {
          "html": "<p>\n                    Set the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-KeyAlgorithm-name\">name</a> attribute of\n                    <var>algorithm</var> to <code>\"RSA-PSS\"</code>.\n                  </p>"
        },
        {
          "html": "<p>\n                    Set the\n                    <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-RsaKeyAlgorithm-modulusLength\">modulusLength</a>\n                    attribute of <var>algorithm</var> to equal the\n                    <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-RsaKeyGenParams-modulusLength\">modulusLength</a>\n                    member of <var>normalizedAlgorithm</var>.\n                  </p>"
        },
        {
          "html": "<p>\n                    Set the\n                    <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-RsaKeyAlgorithm-publicExponent\">publicExponent</a>\n                    attribute of <var>algorithm</var> to equal the\n                    <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-RsaKeyGenParams-publicExponent\">publicExponent</a>\n                    member of <var>normalizedAlgorithm</var>.\n                  </p>"
        },
        {
          "html": "<p>\n                    Set the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-RsaHashedKeyAlgorithm-hash\">hash</a> attribute\n                    of <var>algorithm</var> to equal the\n                    <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-RsaHashedKeyGenParams\">hash</a> member of\n                    <var>normalizedAlgorithm</var>.\n                  </p>"
        },
        {
          "html": "<p>\n                    Let <var>publicKey</var> be a new <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey\">CryptoKey</a> associated with the\n                    <a href=\"https://www.w3.org/TR/html51/webappapis.html#relevant-global-object\">relevant global object</a>\n                    of <code>this</code> [<a href=\"https://www.w3.org/TR/WebCryptoAPI/#HTML\">HTML</a>], and \n                    representing the public key of the generated key pair.\n                  </p>"
        },
        {
          "html": "<p>\n                    Set the [[<a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-type\">type</a>]] internal slot of\n                    <var>publicKey</var> to <code>\"public\"</code>\n                  </p>"
        },
        {
          "html": "<p>\n                    Set the [[<a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-algorithm\">algorithm</a>]] internal\n                    slot of <var>publicKey</var> to <var>algorithm</var>.\n                  </p>"
        },
        {
          "html": "<p>\n                    Set the [[<a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-extractable\">extractable</a>]] internal\n                    slot of <var>publicKey</var> to true.\n                  </p>"
        },
        {
          "html": "<p>\n                    Set the [[<a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-usages\">usages</a>]] internal slot of\n                    <var>publicKey</var> to be the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-usage-intersection\">usage\n                    intersection</a> of <var>usages</var> and <code>[ \"verify\" ]</code>.\n                  </p>"
        },
        {
          "html": "<p>\n                    Let <var>privateKey</var> be a new <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey\">CryptoKey</a> associated with the\n                    <a href=\"https://www.w3.org/TR/html51/webappapis.html#relevant-global-object\">relevant global object</a>\n                    of <code>this</code> [<a href=\"https://www.w3.org/TR/WebCryptoAPI/#HTML\">HTML</a>], and \n                    representing the private key of the generated key pair.\n                  </p>"
        },
        {
          "html": "<p>\n                    Set the [[<a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-type\">type</a>]] internal slot of\n                    <var>privateKey</var> to <code>\"private\"</code>\n                  </p>"
        },
        {
          "html": "<p>\n                    Set the [[<a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-algorithm\">algorithm</a>]] internal\n                    slot of <var>privateKey</var> to <var>algorithm</var>.\n                  </p>"
        },
        {
          "html": "<p>\n                    Set the [[<a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-extractable\">extractable</a>]] internal\n                    slot of <var>privateKey</var> to <var>extractable</var>.\n                  </p>"
        },
        {
          "html": "<p>\n                    Set the [[<a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-usages\">usages</a>]] internal slot of\n                    <var>privateKey</var> to be the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-usage-intersection\">usage\n                    intersection</a> of <var>usages</var> and <code>[ \"sign\" ]</code>.\n                  </p>"
        },
        {
          "html": "<p>\n                    Let <var>result</var> be a new <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKeyPair\">CryptoKeyPair</a>\n                    dictionary.\n                  </p>"
        },
        {
          "html": "<p>\n                    Set the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKeyPair-publicKey\">publicKey</a> attribute\n                    of <var>result</var> to <var>publicKey</var>.\n                  </p>"
        },
        {
          "html": "<p>\n                    Set the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKeyPair-privateKey\">privateKey</a> attribute\n                    of <var>result</var> to <var>privateKey</var>.\n                  </p>"
        },
        {
          "html": "<p>\n                    Return the result of converting <var>result</var> to an ECMAScript Object,\n                    as defined by [<a href=\"https://www.w3.org/TR/WebCryptoAPI/#WebIDL\">WebIDL</a>].\n                  </p>"
        }
      ]
    },
    {
      "html": "",
      "rationale": "let",
      "steps": [
        {
          "html": "<p>Let <var>keyData</var> be the key data to be imported.</p>"
        },
        {
          "html": "<dl class=\"switch\">\n                    <dt>If <var>format</var> is <code>\"spki\"</code>:</dt>\n                    <dd>\n                      \n                    </dd>\n                    <dt>If <var>format</var> is <code>\"pkcs8\"</code>:</dt>\n                    <dd>\n                      \n                    </dd>\n                    <dt>If <var>format</var> is <code>\"jwk\"</code>:</dt>\n                    <dd>\n                      \n                    </dd>\n                    <dt>Otherwise:</dt>\n                    <dd>\n                      <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">throw</a> a\n                      <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-NotSupportedError\"><code>NotSupportedError</code></a>.\n                    </dd>\n                  </dl>",
          "rationale": ".switch",
          "steps": [
            {
              "operation": "switch",
              "steps": [
                {
                  "case": "If format is \"spki\":",
                  "html": "",
                  "rationale": "if",
                  "steps": [
                    {
                      "html": "<p>\n                            If <var>usages</var> contains an entry which is not\n                            <code>\"verify\"</code>\n                            then <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">throw</a> a\n                            <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-SyntaxError\"><code>SyntaxError</code></a>.\n                          </p>"
                    },
                    {
                      "html": "<p>\n                            Let <var>spki</var> be the result of running the\n                            <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-parse-a-spki\">parse a subjectPublicKeyInfo</a>\n                            algorithm over <var>keyData</var>.\n                          </p>"
                    },
                    {
                      "html": "<p>\n                            If an error occurred while parsing,\n                            then <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">throw</a> a\n                            <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-DataError\"><code>DataError</code></a>.\n                          </p>"
                    },
                    {
                      "html": "<p>\n                            Let <var>hash</var> be undefined.\n                          </p>"
                    },
                    {
                      "html": "<p>\n                            Let <var>alg</var> be the <code>algorithm</code> object identifier\n                            field of the <code>algorithm</code> AlgorithmIdentifier field of\n                            <var>spki</var>.\n                          </p>"
                    },
                    {
                      "html": "<dl class=\"switch\">\n                            <dt>\n                              If <var>alg</var> is equivalent to the <code>rsaEncryption</code>\n                              OID defined in <a href=\"https://www.w3.org/TR/WebCryptoAPI/#RFC3447\">RFC 3447</a>:\n                            </dt>\n                            <dd>\n                              <p>\n                                Let <var>hash</var> be undefined.\n                              </p>\n                            </dd>\n                            <dt>\n                              If <var>alg</var> is equivalent to the\n                              <code>id-RSASSA-PSS</code> OID defined in\n                              <a href=\"https://www.w3.org/TR/WebCryptoAPI/#RFC3447\">RFC 3447</a>:\n                            </dt>\n                            <dd>\n                              \n                            </dd>\n                            <dt>Otherwise:</dt>\n                            <dd>\n                              <p>\n                                <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">throw</a> a\n                                <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-DataError\"><code>DataError</code></a>.\n                              </p>\n                            </dd>\n                          </dl>",
                      "rationale": ".switch",
                      "steps": [
                        {
                          "operation": "switch",
                          "steps": [
                            {
                              "case": "If alg is equivalent to the rsaEncryption OID defined in RFC 3447:",
                              "html": "<p>\n                                Let <var>hash</var> be undefined.\n                              </p>"
                            },
                            {
                              "case": "If alg is equivalent to the id-RSASSA-PSS OID defined in RFC 3447:",
                              "html": "",
                              "rationale": "let",
                              "steps": [
                                {
                                  "html": "<p>\n                                    Let <var>params</var> be the ASN.1 structure contained within\n                                    the <code>parameters</code> field of the <code>algorithm</code>\n                                    AlgorithmIdentifier field of <var>spki</var>.\n                                  </p>"
                                },
                                {
                                  "html": "<p>\n                                    If <var>params</var> is not defined, or is not an instance of\n                                    the <code>RSASSA-PSS-params</code> ASN.1 type defined in\n                                    <a href=\"https://www.w3.org/TR/WebCryptoAPI/#RFC3447\">RFC3447</a>,\n                                    <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">throw</a> a\n                                    <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-DataError\"><code>DataError</code></a>.\n                                  </p>"
                                },
                                {
                                  "html": "<p>\n                                    Let <var>hashAlg</var> be the AlgorithmIdentifier ASN.1 type\n                                    within the <code>hashAlgorithm</code> field of <var>params</var>.\n                                  </p>"
                                },
                                {
                                  "html": "<dl class=\"switch\">\n                                    <dt>\n                                      If the <code>algorithm</code> object identifier field of\n                                      <var>hashAlg</var> is equivalent to the <code>id-sha1</code>\n                                      OID defined in <a href=\"https://www.w3.org/TR/WebCryptoAPI/#RFC3447\">RFC 3447</a>:\n                                    </dt>\n                                    <dd>\n                                      <p>\n                                        Set <var>hash</var> to the string <code>\"SHA-1\"</code>.\n                                      </p>\n                                    </dd>\n                                    <dt>\n                                      If the <code>algorithm</code> object identifier field of\n                                      <var>hashAlg</var> is equivalent to the <code>id-sha256</code>\n                                      OID defined in <a href=\"https://www.w3.org/TR/WebCryptoAPI/#RFC3447\">RFC 3447</a>:\n                                    </dt>\n                                    <dd>\n                                      <p>\n                                        Set <var>hash</var> to the string <code>\"SHA-256\"</code>.\n                                      </p>\n                                    </dd>\n                                    <dt>\n                                      If the <code>algorithm</code> object identifier field of\n                                      <var>hashAlg</var> is equivalent to the <code>id-sha384</code>\n                                      OID defined in <a href=\"https://www.w3.org/TR/WebCryptoAPI/#RFC3447\">RFC 3447</a>:\n                                    </dt>\n                                    <dd>\n                                      <p>\n                                        Set <var>hash</var> to the string <code>\"SHA-384\"</code>.\n                                      </p>\n                                    </dd>\n                                    <dt>\n                                      If the <code>algorithm</code> object identifier field of\n                                      <var>hashAlg</var> is equivalent to the <code>id-sha512</code>\n                                      OID defined in <a href=\"https://www.w3.org/TR/WebCryptoAPI/#RFC3447\">RFC 3447</a>:\n                                    </dt>\n                                    <dd>\n                                      <p>\n                                        Set <var>hash</var> to the string <code>\"SHA-512\"</code>.\n                                      </p>\n                                    </dd>\n                                    <dt>Otherwise:</dt>\n                                    <dd>\n                                      \n                                    </dd>\n                                  </dl>",
                                  "rationale": ".switch",
                                  "steps": [
                                    {
                                      "operation": "switch",
                                      "steps": [
                                        {
                                          "case": "If the algorithm object identifier field of hashAlg is equivalent to the id-sha1 OID defined in RFC 3447:",
                                          "html": "<p>\n                                        Set <var>hash</var> to the string <code>\"SHA-1\"</code>.\n                                      </p>"
                                        },
                                        {
                                          "case": "If the algorithm object identifier field of hashAlg is equivalent to the id-sha256 OID defined in RFC 3447:",
                                          "html": "<p>\n                                        Set <var>hash</var> to the string <code>\"SHA-256\"</code>.\n                                      </p>"
                                        },
                                        {
                                          "case": "If the algorithm object identifier field of hashAlg is equivalent to the id-sha384 OID defined in RFC 3447:",
                                          "html": "<p>\n                                        Set <var>hash</var> to the string <code>\"SHA-384\"</code>.\n                                      </p>"
                                        },
                                        {
                                          "case": "If the algorithm object identifier field of hashAlg is equivalent to the id-sha512 OID defined in RFC 3447:",
                                          "html": "<p>\n                                        Set <var>hash</var> to the string <code>\"SHA-512\"</code>.\n                                      </p>"
                                        },
                                        {
                                          "case": "Otherwise:",
                                          "html": "",
                                          "rationale": "perform",
                                          "steps": [
                                            {
                                              "html": "<p>\n                                            Perform any <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-rsa-pss-extended-import-steps\">key\n                                            import steps</a> defined by\n                                            <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-applicable-specification\">other applicable\n                                            specifications</a>, passing <var>format</var>, <var>spki</var>\n                                            and obtaining <var>hash</var>.\n                                          </p>"
                                            },
                                            {
                                              "html": "<p>\n                                            If an error occurred or there are no\n                                            <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-applicable-specification\">applicable\n                                            specifications</a>,\n                                            <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">throw</a> a\n                                            <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-DataError\"><code>DataError</code></a>.\n                                          </p>"
                                            }
                                          ]
                                        }
                                      ]
                                    }
                                  ]
                                },
                                {
                                  "html": "<p>\n                                    If the <code>algorithm</code> object identifier field of the\n                                    <code>maskGenAlgorithm</code> field of <var>params</var> is not\n                                    equivalent to the OID <code>id-mgf1</code> defined in <a href=\"https://www.w3.org/TR/WebCryptoAPI/#RFC3447\">RFC 3447</a>, <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">throw</a> a <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-NotSupportedError\"><code>NotSupportedError</code></a>.\n                                  </p>"
                                },
                                {
                                  "html": "<p>\n                                    If the <code>parameters</code> field of the\n                                    <code>maskGenAlgorithm</code> field of <var>params</var> is not\n                                    an instance of the <code>HashAlgorithm</code> ASN.1 type that is\n                                    identical in content to the <code>hashAlglorithm</code> field of\n                                    <var>params</var>, <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">throw</a> a <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-NotSupportedError\"><code>NotSupportedError</code></a>.\n                                  </p>"
                                }
                              ]
                            },
                            {
                              "case": "Otherwise:",
                              "html": "<p>\n                                <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">throw</a> a\n                                <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-DataError\"><code>DataError</code></a>.\n                              </p>"
                            }
                          ]
                        }
                      ]
                    },
                    {
                      "html": "<dl>\n                            <dt>\n                              If <var>hash</var> is not undefined:\n                            </dt>\n                            <dd>\n                              \n                            </dd>\n                          </dl>",
                      "rationale": "let",
                      "steps": [
                        {
                          "html": "<p>\n                                    Let <var>normalizedHash</var> be the result of\n                                    <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-normalize-an-algorithm\">normalize an algorithm</a>\n                                    with <code>alg</code> set to <var>hash</var> and <code>op</code> set\n                                    to <code>digest</code>.\n                                  </p>"
                        },
                        {
                          "html": "<p>\n                                    If <var>normalizedHash</var> is not equal to the\n                                    <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-RsaHashedImportParams-hash\">hash</a> member of\n                                    <var>normalizedAlgorithm</var>, <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">throw</a> a <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-DataError\"><code>DataError</code></a>.\n                                  </p>"
                        }
                      ]
                    },
                    {
                      "html": "<p>\n                            Let <var>publicKey</var> be the result of performing the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-parse-an-asn1-structure\">parse an ASN.1 structure</a>\n                            algorithm, with <var>data</var> as the\n                            <code>subjectPublicKeyInfo</code> field of <var>spki</var>,\n                            <var>structure</var> as the <code>RSAPublicKey</code> structure\n                            specified in Section A.1.1 of <a href=\"https://www.w3.org/TR/WebCryptoAPI/#RFC3447\">RFC 3447</a>, and\n                            <var>exactData</var> set to true.\n                          </p>"
                    },
                    {
                      "html": "<p>\n                            If an error occurred while parsing, or it can be determined that <var>publicKey</var>\n                            is not a valid public key according to <a href=\"https://www.w3.org/TR/WebCryptoAPI/#RFC3447\">RFC 3447</a>,\n                            then <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">throw</a> a\n                            <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-DataError\"><code>DataError</code></a>.\n                          </p>"
                    },
                    {
                      "html": "<p>\n                            Let <var>key</var> be a new <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey\">CryptoKey</a> associated with the\n                            <a href=\"https://www.w3.org/TR/html51/webappapis.html#relevant-global-object\">relevant global object</a>\n                            of <code>this</code> [<a href=\"https://www.w3.org/TR/WebCryptoAPI/#HTML\">HTML</a>], and\n                            that represents the RSA public key identified by\n                            <var>publicKey</var>.\n                          </p>"
                    },
                    {
                      "html": "<p>\n                            Set the [[<a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-type\">type</a>]] internal slot\n                            of <var>key</var> to <code>\"public\"</code>\n                          </p>"
                    }
                  ]
                },
                {
                  "case": "If format is \"pkcs8\":",
                  "html": "",
                  "rationale": "if",
                  "steps": [
                    {
                      "html": "<p>\n                            If <var>usages</var> contains an entry which is not\n                            <code>\"sign\"</code>\n                            then <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">throw</a> a\n                            <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-SyntaxError\"><code>SyntaxError</code></a>.\n                          </p>"
                    },
                    {
                      "html": "<p>\n                            Let <var>privateKeyInfo</var> be the result of running the\n                            <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-parse-a-privateKeyInfo\">parse a privateKeyInfo</a>\n                            algorithm over <var>keyData</var>.\n                          </p>"
                    },
                    {
                      "html": "<p>\n                            If an error occurred while parsing, then <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">throw</a> a <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-DataError\"><code>DataError</code></a>.\n                          </p>"
                    },
                    {
                      "html": "<p>\n                            Let <var>hash</var> be undefined.\n                          </p>"
                    },
                    {
                      "html": "<p>\n                            Let <var>alg</var> be the <code>algorithm</code> object identifier\n                            field of the <code>privateKeyAlgorithm</code>\n                            PrivateKeyAlgorithmIdentifier field of <var>privateKeyInfo</var>.\n                          </p>"
                    },
                    {
                      "html": "<dl class=\"switch\">\n                            <dt>\n                              If <var>alg</var> is equivalent to the <code>rsaEncryption</code>\n                              OID defined in <a href=\"https://www.w3.org/TR/WebCryptoAPI/#RFC3447\">RFC 3447</a>:\n                            </dt>\n                            <dd>\n                              <p>\n                                Let <var>hash</var> be undefined.\n                              </p>\n                            </dd>\n                            <dt>\n                              If <var>alg</var> is equivalent to the <code>id-RSASSA-PSS</code> OID\n                              defined in <a href=\"https://www.w3.org/TR/WebCryptoAPI/#RFC3447\">RFC 3447</a>:\n                            </dt>\n                            <dd>\n                              \n                            </dd>\n                            <dt>Otherwise:</dt>\n                            <dd>\n                              <p>\n                                <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">throw</a> a\n                                <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-DataError\"><code>DataError</code></a>.\n                              </p>\n                            </dd>\n                          </dl>",
                      "rationale": ".switch",
                      "steps": [
                        {
                          "operation": "switch",
                          "steps": [
                            {
                              "case": "If alg is equivalent to the rsaEncryption OID defined in RFC 3447:",
                              "html": "<p>\n                                Let <var>hash</var> be undefined.\n                              </p>"
                            },
                            {
                              "case": "If alg is equivalent to the id-RSASSA-PSS OID defined in RFC 3447:",
                              "html": "",
                              "rationale": "let",
                              "steps": [
                                {
                                  "html": "<p>\n                                    Let <var>params</var> be the ASN.1 structure contained within\n                                    the <code>parameters</code> field of the\n                                    <code>privateKeyAlgorithm</code> PrivateKeyAlgorithmIdentifier\n                                    field of <var>privateKeyInfo</var>.\n                                  </p>"
                                },
                                {
                                  "html": "<p>\n                                    If <var>params</var> is not defined, or is not an instance of\n                                    the <code>RSASSA-PSS-params</code> ASN.1 type defined in\n                                    <a href=\"https://www.w3.org/TR/WebCryptoAPI/#RFC3447\">RFC3447</a>,\n                                    <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">throw</a> a\n                                    <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-NotSupportedError\"><code>NotSupportedError</code></a>.\n                                  </p>"
                                },
                                {
                                  "html": "<p>\n                                    Let <var>hashAlg</var> be the AlgorithmIdentifier ASN.1 type\n                                    within the <code>hashAlgorithm</code> field of <var>params</var>.\n                                  </p>"
                                },
                                {
                                  "html": "<dl class=\"switch\">\n                                    <dt>\n                                      If the <code>algorithm</code> object identifier field of\n                                      <var>hashAlg</var> is equivalent to the <code>id-sha1</code>\n                                      OID defined in <a href=\"https://www.w3.org/TR/WebCryptoAPI/#RFC3447\">RFC 3447</a>:\n                                    </dt>\n                                    <dd>\n                                      <p>\n                                        Set <var>hash</var> to the string <code>\"SHA-1\"</code>.\n                                      </p>\n                                    </dd>\n                                    <dt>\n                                      If the <code>algorithm</code> object identifier field of\n                                      <var>hashAlg</var> is equivalent to the <code>id-sha256</code>\n                                      OID defined in <a href=\"https://www.w3.org/TR/WebCryptoAPI/#RFC3447\">RFC 3447</a>:\n                                    </dt>\n                                    <dd>\n                                      <p>\n                                        Set <var>hash</var> to the string <code>\"SHA-256\"</code>.\n                                      </p>\n                                    </dd>\n                                    <dt>\n                                      If the <code>algorithm</code> object identifier field of\n                                      <var>hashAlg</var> is equivalent to the <code>id-sha384</code>\n                                      OID defined in <a href=\"https://www.w3.org/TR/WebCryptoAPI/#RFC3447\">RFC 3447</a>:\n                                    </dt>\n                                    <dd>\n                                      <p>\n                                        Set <var>hash</var> to the string <code>\"SHA-384\"</code>.\n                                      </p>\n                                    </dd>\n                                    <dt>\n                                      If the <code>algorithm</code> object identifier field of\n                                      <var>hashAlg</var> is equivalent to the <code>id-sha512</code>\n                                      OID defined in <a href=\"https://www.w3.org/TR/WebCryptoAPI/#RFC3447\">RFC 3447</a>:\n                                    </dt>\n                                    <dd>\n                                      <p>\n                                        Set <var>hash</var> to the string <code>\"SHA-512\"</code>.\n                                      </p>\n                                    </dd>\n                                    <dt>Otherwise:</dt>\n                                    <dd>\n                                      \n                                    </dd>\n                                  </dl>",
                                  "rationale": ".switch",
                                  "steps": [
                                    {
                                      "operation": "switch",
                                      "steps": [
                                        {
                                          "case": "If the algorithm object identifier field of hashAlg is equivalent to the id-sha1 OID defined in RFC 3447:",
                                          "html": "<p>\n                                        Set <var>hash</var> to the string <code>\"SHA-1\"</code>.\n                                      </p>"
                                        },
                                        {
                                          "case": "If the algorithm object identifier field of hashAlg is equivalent to the id-sha256 OID defined in RFC 3447:",
                                          "html": "<p>\n                                        Set <var>hash</var> to the string <code>\"SHA-256\"</code>.\n                                      </p>"
                                        },
                                        {
                                          "case": "If the algorithm object identifier field of hashAlg is equivalent to the id-sha384 OID defined in RFC 3447:",
                                          "html": "<p>\n                                        Set <var>hash</var> to the string <code>\"SHA-384\"</code>.\n                                      </p>"
                                        },
                                        {
                                          "case": "If the algorithm object identifier field of hashAlg is equivalent to the id-sha512 OID defined in RFC 3447:",
                                          "html": "<p>\n                                        Set <var>hash</var> to the string <code>\"SHA-512\"</code>.\n                                      </p>"
                                        },
                                        {
                                          "case": "Otherwise:",
                                          "html": "",
                                          "rationale": "perform",
                                          "steps": [
                                            {
                                              "html": "<p>\n                                            Perform any <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-rsa-pss-extended-import-steps\">key\n                                            import steps</a> defined by\n                                            <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-applicable-specification\">other applicable\n                                            specifications</a>, passing <var>format</var>, <var>privateKeyInfo</var>\n                                            and obtaining <var>hash</var>.\n                                          </p>"
                                            },
                                            {
                                              "html": "<p>\n                                            If an error occurred or there are no\n                                            <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-applicable-specification\">applicable\n                                            specifications</a>,\n                                            <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">throw</a> a\n                                            <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-DataError\"><code>DataError</code></a>.\n                                          </p>"
                                            }
                                          ]
                                        }
                                      ]
                                    }
                                  ]
                                },
                                {
                                  "html": "<p>\n                                    If the <code>algorithm</code> object identifier field of the\n                                    <code>maskGenAlgorithm</code> field of <var>params</var> is not\n                                    equivalent to the OID <code>id-mgf1</code> defined in <a href=\"https://www.w3.org/TR/WebCryptoAPI/#RFC3447\">RFC 3447</a>, <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">throw</a> a <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-NotSupportedError\"><code>NotSupportedError</code></a>.\n                                  </p>"
                                },
                                {
                                  "html": "<p>\n                                    If the <code>parameters</code> field of the\n                                    <code>maskGenAlgorithm</code> field of <var>params</var> is not\n                                    an instance of the <code>HashAlgorithm</code> ASN.1 type that is\n                                    identical in content to the <code>hashAlglorithm</code> field of\n                                    <var>params</var>, <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">throw</a> a <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-NotSupportedError\"><code>NotSupportedError</code></a>.\n                                  </p>"
                                }
                              ]
                            },
                            {
                              "case": "Otherwise:",
                              "html": "<p>\n                                <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">throw</a> a\n                                <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-DataError\"><code>DataError</code></a>.\n                              </p>"
                            }
                          ]
                        }
                      ]
                    },
                    {
                      "html": "<dl>\n                            <dt>\n                              If <var>hash</var> is not undefined:\n                            </dt>\n                            <dd>\n                              \n                            </dd>\n                          </dl>",
                      "rationale": "let",
                      "steps": [
                        {
                          "html": "<p>\n                                    Let <var>normalizedHash</var> be the result of\n                                    <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-normalize-an-algorithm\">normalize an algorithm</a>\n                                    with <code>alg</code> set to <var>hash</var> and <code>op</code> set\n                                    to <code>digest</code>.\n                                  </p>"
                        },
                        {
                          "html": "<p>\n                                    If <var>normalizedHash</var> is not equal to the\n                                    <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-RsaHashedImportParams-hash\">hash</a> member of\n                                    <var>normalizedAlgorithm</var>, <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">throw</a> a <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-DataError\"><code>DataError</code></a>.\n                                  </p>"
                        }
                      ]
                    },
                    {
                      "html": "<p>\n                            Let <var>rsaPrivateKey</var> be the result of performing the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-parse-an-asn1-structure\">parse an ASN.1 structure</a>\n                            algorithm, with <var>data</var> as the\n                            <code>privateKey</code> field of <var>privateKeyInfo</var>,\n                            <var>structure</var> as the <code>RSAPrivateKey</code> structure\n                            specified in Section A.1.2 of <a href=\"https://www.w3.org/TR/WebCryptoAPI/#RFC3447\">RFC 3447</a>, and\n                            <var>exactData</var> set to true.\n                          </p>"
                    },
                    {
                      "html": "<p>\n                            If an error occurred while parsing, or if <var>rsaPrivateKey</var> is not\n                            a valid RSA private key according to <a href=\"https://www.w3.org/TR/WebCryptoAPI/#RFC3447\">RFC 3447</a>,\n                            then <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">throw</a> a\n                            <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-DataError\"><code>DataError</code></a>.\n                          </p>"
                    },
                    {
                      "html": "<p>\n                            Let <var>key</var> be a new <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey\">CryptoKey</a> associated with the\n                            <a href=\"https://www.w3.org/TR/html51/webappapis.html#relevant-global-object\">relevant global object</a>\n                            of <code>this</code> [<a href=\"https://www.w3.org/TR/WebCryptoAPI/#HTML\">HTML</a>], and\n                            that represents the RSA private key identified by\n                            <var>rsaPrivateKey</var>.\n                          </p>"
                    },
                    {
                      "html": "<p>\n                            Set the [[<a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-type\">type</a>]] internal slot\n                            of <var>key</var> to <code>\"private\"</code>\n                          </p>"
                    }
                  ]
                },
                {
                  "case": "If format is \"jwk\":",
                  "html": "",
                  "rationale": "if",
                  "steps": [
                    {
                      "html": "<dl class=\"switch\">\n                            <dt>If <var>keyData</var> is a <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-JsonWebKey\">JsonWebKey</a> dictionary:</dt>\n                            <dd><p>Let <var>jwk</var> equal <var>keyData</var>.</p></dd>\n                            <dt>Otherwise:</dt>\n                            <dd><p><a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">Throw</a> a <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-DataError\"><code>DataError</code></a>.</p></dd>\n                          </dl>",
                      "rationale": ".switch",
                      "steps": [
                        {
                          "operation": "switch",
                          "steps": [
                            {
                              "case": "If keyData is a JsonWebKey dictionary:",
                              "html": "<p>Let <var>jwk</var> equal <var>keyData</var>.</p>"
                            },
                            {
                              "case": "Otherwise:",
                              "html": "<p><a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">Throw</a> a <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-DataError\"><code>DataError</code></a>.</p>"
                            }
                          ]
                        }
                      ]
                    },
                    {
                      "html": "<p>\n                            If the <code>\"d\"</code> field of <var>jwk</var> is present and\n                            <var>usages</var> contains an entry which is not\n                            <code>\"sign\"</code>, or, if the <code>\"d\"</code> field of <var>jwk</var>\n                            is not present and\n                            <var>usages</var> contains an entry which is not\n                            <code>\"verify\"</code>\n                            then <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">throw</a> a\n                            <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-SyntaxError\"><code>SyntaxError</code></a>.\n                          </p>"
                    },
                    {
                      "html": "<p>\n                            If the <code>\"kty\"</code> field of <var>jwk</var> is not a\n                            case-sensitive string match to <code>\"RSA\"</code>,\n                            then <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">throw</a> a\n                            <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-DataError\"><code>DataError</code></a>.\n                          </p>"
                    },
                    {
                      "html": "<p>\n                            If <var>usages</var> is non-empty and the <code>\"use\"</code> field of <var>jwk</var> is present and is\n                            not a case-sensitive string match to <code>\"sig\"</code>,\n                            then <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">throw</a> a\n                            <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-DataError\"><code>DataError</code></a>.\n                          </p>"
                    },
                    {
                      "html": "<p>\n                            If the <code>\"key_ops\"</code> field of <var>jwk</var> is present, and\n                            is invalid according to the requirements of\n                            <a href=\"https://www.w3.org/TR/WebCryptoAPI/#jwk\">JSON Web Key</a> or\n                            does not contain all of the specified <var>usages</var> values,\n                            then <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">throw</a> a\n                            <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-DataError\"><code>DataError</code></a>.\n                          </p>"
                    },
                    {
                      "html": "<p>\n                            If the <code>\"ext\"</code> field of <var>jwk</var> is present and\n                            has the value false and <var>extractable</var> is true,\n                            then <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">throw</a> a\n                            <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-DataError\"><code>DataError</code></a>.\n                          </p>"
                    },
                    {
                      "html": "<dl class=\"switch\">\n                            <dt>\n                              If the <code>\"alg\"</code> field of <var>jwk</var> is not\n                              present:\n                            </dt>\n                            <dd>\n                              <p>\n                                Let <var>hash</var> be undefined.\n                              </p>\n                            </dd>\n                            <dt>\n                              If the <code>\"alg\"</code> field is equal to the string\n                              <code>\"PS1\"</code>:\n                            </dt>\n                            <dd>\n                              <p>\n                                Let <var>hash</var> be the string <code>\"SHA-1\"</code>.\n                              </p>\n                            </dd>\n                            <dt>\n                              If the <code>\"alg\"</code> field is equal to the string\n                              <code>\"PS256\"</code>:\n                            </dt>\n                            <dd>\n                              <p>\n                                Let <var>hash</var> be the string <code>\"SHA-256\"</code>.\n                              </p>\n                            </dd>\n                            <dt>\n                              If the <code>\"alg\"</code> field is equal to the string\n                              <code>\"PS384\"</code>:\n                            </dt>\n                            <dd>\n                              <p>\n                                Let <var>hash</var> be the string <code>\"SHA-384\"</code>.\n                              </p>\n                            </dd>\n                            <dt>\n                              If the <code>\"alg\"</code> field is equal to the string\n                              <code>\"PS512\"</code>:\n                            </dt>\n                            <dd>\n                              <p>\n                                Let <var>hash</var> be the string <code>\"SHA-512\"</code>.\n                              </p>\n                            </dd>\n                            <dt>Otherwise:</dt>\n                            <dd>\n                              \n                            </dd>\n                          </dl>",
                      "rationale": ".switch",
                      "steps": [
                        {
                          "operation": "switch",
                          "steps": [
                            {
                              "case": "If the \"alg\" field of jwk is not present:",
                              "html": "<p>\n                                Let <var>hash</var> be undefined.\n                              </p>"
                            },
                            {
                              "case": "If the \"alg\" field is equal to the string \"PS1\":",
                              "html": "<p>\n                                Let <var>hash</var> be the string <code>\"SHA-1\"</code>.\n                              </p>"
                            },
                            {
                              "case": "If the \"alg\" field is equal to the string \"PS256\":",
                              "html": "<p>\n                                Let <var>hash</var> be the string <code>\"SHA-256\"</code>.\n                              </p>"
                            },
                            {
                              "case": "If the \"alg\" field is equal to the string \"PS384\":",
                              "html": "<p>\n                                Let <var>hash</var> be the string <code>\"SHA-384\"</code>.\n                              </p>"
                            },
                            {
                              "case": "If the \"alg\" field is equal to the string \"PS512\":",
                              "html": "<p>\n                                Let <var>hash</var> be the string <code>\"SHA-512\"</code>.\n                              </p>"
                            },
                            {
                              "case": "Otherwise:",
                              "html": "",
                              "rationale": "perform",
                              "steps": [
                                {
                                  "html": "<p>\n                                    Perform any <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-rsa-pss-extended-import-steps\">key\n                                    import steps</a> defined by\n                                    <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-applicable-specification\">other applicable\n                                    specifications</a>, passing <var>format</var>, <var>jwk</var>\n                                    and obtaining <var>hash</var>.\n                                  </p>"
                                },
                                {
                                  "html": "<p>\n                                    If an error occurred or there are no\n                                    <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-applicable-specification\">applicable\n                                    specifications</a>,\n                                    <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">throw</a> a\n                                    <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-DataError\"><code>DataError</code></a>.\n                                  </p>"
                                }
                              ]
                            }
                          ]
                        }
                      ]
                    },
                    {
                      "html": "<dl>\n                            <dt>\n                              If <var>hash</var> is not undefined:\n                            </dt>\n                            <dd>\n                              \n                            </dd>\n                          </dl>",
                      "rationale": "let",
                      "steps": [
                        {
                          "html": "<p>\n                                    Let <var>normalizedHash</var> be the result of\n                                    <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-normalize-an-algorithm\">normalize an algorithm</a>\n                                    with <code>alg</code> set to <var>hash</var> and <code>op</code> set\n                                    to <code>digest</code>.\n                                  </p>"
                        },
                        {
                          "html": "<p>\n                                    If <var>normalizedHash</var> is not equal to the\n                                    <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-RsaHashedImportParams-hash\">hash</a> member of\n                                    <var>normalizedAlgorithm</var>, <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">throw</a> a <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-DataError\"><code>DataError</code></a>.\n                                  </p>"
                        }
                      ]
                    },
                    {
                      "html": "<dl class=\"switch\">\n                            <dt>If the <code>\"d\"</code> field of <var>jwk</var> is present:</dt>\n                            <dd>\n                              \n                            </dd>\n                            <dt>Otherwise:</dt>\n                            <dd>\n                              \n                            </dd>\n                          </dl>",
                      "rationale": ".switch",
                      "steps": [
                        {
                          "operation": "switch",
                          "steps": [
                            {
                              "case": "If the \"d\" field of jwk is present:",
                              "html": "",
                              "rationale": "if",
                              "steps": [
                                {
                                  "html": "<p>\n                                    If <var>jwk</var> does not meet the requirements of\n                                    Section 6.3.2 of <a href=\"https://www.w3.org/TR/WebCryptoAPI/#jwa\">JSON Web\n                                    Algorithms</a>,\n                                    then <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">throw</a> a\n                                    <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-DataError\"><code>DataError</code></a>.\n                                  </p>"
                                },
                                {
                                  "html": "<p>\n                                    Let <var>privateKey</var> represent the\n                                    RSA public key identified by interpreting <var>jwk</var>\n                                    according to Section 6.3.1 of <a href=\"https://www.w3.org/TR/WebCryptoAPI/#jwa\"> JSON Web\n                                    Algorithms</a>.\n                                  </p>"
                                },
                                {
                                  "html": "<p>\n                                    If <var>privateKey</var> can be determined to not be a valid RSA public key\n                                    according to <a href=\"https://www.w3.org/TR/WebCryptoAPI/#RFC3447\">RFC 3447</a>,\n                                    then <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">throw</a> a\n                                    <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-DataError\"><code>DataError</code></a>.\n                                  </p>"
                                },
                                {
                                  "html": "<p>\n                                    Let <var>key</var> be a new <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey\">CryptoKey</a> representing <var>privateKey</var>.\n                                  </p>"
                                },
                                {
                                  "html": "<p>\n                                    Set the [[<a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-type\">type</a>]]\n                                    internal slot of <var>key</var> to <code>\"private\"</code>\n                                  </p>"
                                }
                              ]
                            },
                            {
                              "case": "Otherwise:",
                              "html": "",
                              "rationale": "if",
                              "steps": [
                                {
                                  "html": "<p>\n                                    If <var>jwk</var> does not meet the requirements of Section\n                                    6.3.1 of <a href=\"https://www.w3.org/TR/WebCryptoAPI/#jwa\">JSON Web Algorithms</a>, then <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">throw</a> a <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-DataError\"><code>DataError</code></a>.\n                                  </p>"
                                },
                                {
                                  "html": "<p>\n                                    Let <var>publicKey</var> represent the\n                                    RSA public key identified by interpreting <var>jwk</var>\n                                    according to Section 6.3.1 of <a href=\"https://www.w3.org/TR/WebCryptoAPI/#jwa\"> JSON Web\n                                    Algorithms</a>.\n                                  </p>"
                                },
                                {
                                  "html": "<p>\n                                    If <var>publicKey</var> can be determined to not be a valid RSA public key\n                                    according to <a href=\"https://www.w3.org/TR/WebCryptoAPI/#RFC3447\">RFC 3447</a>,\n                                    then <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">throw</a> a\n                                    <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-DataError\"><code>DataError</code></a>.\n                                  </p>"
                                },
                                {
                                  "html": "<p>\n                                    Let <var>key</var> be a new <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey\">CryptoKey</a> representing <var>publicKey</var>.\n                                  </p>"
                                },
                                {
                                  "html": "<p>\n                                    Set the [[<a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-type\">type</a>]]\n                                    internal slot of <var>key</var> to <code>\"public\"</code>\n                                  </p>"
                                }
                              ]
                            }
                          ]
                        }
                      ]
                    }
                  ]
                },
                {
                  "case": "Otherwise:",
                  "html": "<a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">throw</a> a\n                      <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-NotSupportedError\"><code>NotSupportedError</code></a>."
                }
              ]
            }
          ]
        },
        {
          "html": "<p>\n                    Let <var>algorithm</var> be a new\n                    <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-RsaHashedKeyAlgorithm\">RsaHashedKeyAlgorithm</a> dictionary.\n                  </p>"
        },
        {
          "html": "<p>\n                    Set the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-KeyAlgorithm-name\">name</a> attribute of\n                    <var>algorithm</var> to <code>\"RSA-PSS\"</code>\n                  </p>"
        },
        {
          "html": "<p>\n                    Set the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-RsaKeyAlgorithm-modulusLength\">modulusLength</a>\n                    attribute of <var>algorithm</var> to the length, in bits, of the RSA public\n                    modulus.\n                  </p>"
        },
        {
          "html": "<p>\n                    Set the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-RsaKeyAlgorithm-publicExponent\">publicExponent</a>\n                    attribute of <var>algorithm</var> to the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-BigInteger\">BigInteger</a>\n                    representation of the RSA public exponent.\n                  </p>"
        },
        {
          "html": "<p>\n                    Set the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-RsaHashedKeyAlgorithm-hash\">hash</a> attribute of\n                    <var>algorithm</var> to the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-RsaHashedImportParams-hash\">hash</a> member of\n                    <var>normalizedAlgorithm</var>.\n                  </p>"
        },
        {
          "html": "<p>\n                    Set the [[<a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-algorithm\">algorithm</a>]] internal\n                    slot of <var>key</var> to <var>algorithm</var>\n                  </p>"
        },
        {
          "html": "<p>Return <var>key</var>.</p>"
        }
      ]
    },
    {
      "html": "",
      "rationale": "let",
      "steps": [
        {
          "html": "<p>\n                    Let <var>key</var> be the key to be exported.\n                  </p>"
        },
        {
          "html": "<p>\n                    If the underlying cryptographic key material represented by the [[<a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-handle\">handle</a>]] internal slot of <var>key</var>\n                    cannot be accessed, then <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">throw</a> an <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-OperationError\"><code>OperationError</code></a>.\n                  </p>"
        },
        {
          "html": "<dl class=\"switch\">\n                    <dt>If <var>format</var> is <code>\"spki\"</code></dt>\n                    <dd>\n                      \n                    </dd>\n                    <dt>If <var>format</var> is <code>\"pkcs8\"</code>:</dt>\n                    <dd>\n                      \n                    </dd>\n                    <dt>If <var>format</var> is <code>\"jwk\"</code>:</dt>\n                    <dd>\n                      <ul>\n                        <li>\n                          <p>Let <var>jwk</var> be a new <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-JsonWebKey\">JsonWebKey</a> dictionary.</p>\n                        </li>\n                        <li>\n                          <p>Set the <code>kty</code> attribute of <var>jwk</var> to the string\n                          <code>\"RSA\"</code>.</p>\n                        </li>\n                        <li>\n                          <p>\n                            Let <var>hash</var> be the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-KeyAlgorithm-name\">name</a>\n                            attribute of the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-RsaHashedKeyAlgorithm-hash\">hash</a>\n                            attribute of the [[<a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-algorithm\">algorithm</a>]] internal slot of\n                            <var>key</var>.\n                          </p>\n                        </li>\n                        <li>\n                          <dl class=\"switch\">\n                            <dt>If <var>hash</var> is <code>\"SHA-1\"</code>:</dt>\n                            <dd>\n                              <p>\n                                Set the <code>alg</code> attribute of <var>jwk</var> to the string\n                                <code>\"PS1\"</code>.\n                              </p>\n                            </dd>\n                            <dt>If <var>hash</var> is <code>\"SHA-256\"</code>:</dt>\n                            <dd>\n                              <p>\n                                Set the <code>alg</code> attribute of <var>jwk</var> to the string\n                                <code>\"PS256\"</code>.\n                              </p>\n                            </dd>\n                            <dt>If <var>hash</var> is <code>\"SHA-384\"</code>:</dt>\n                            <dd>\n                              <p>\n                                Set the <code>alg</code> attribute of <var>jwk</var> to the string\n                                <code>\"PS384\"</code>.\n                              </p>\n                            </dd>\n                            <dt>If <var>hash</var> is <code>\"SHA-512\"</code>:</dt>\n                            <dd>\n                              <p>\n                                Set the <code>alg</code> attribute of <var>jwk</var> to the string\n                                <code>\"PS512\"</code>.\n                              </p>\n                            </dd>\n                            <dt>Otherwise:</dt>\n                            <dd>\n                              \n                            </dd>\n                          </dl>\n                        </li>\n                        <li>\n                          <p>\n                            Set the attributes <code>n</code> and <code>e</code> of <var>jwk</var>\n                            according to the corresponding definitions in <a href=\"https://www.w3.org/TR/WebCryptoAPI/#jwa\">JSON Web\n                            Algorithms</a>, Section 6.3.1.\n                          </p>\n                        </li>\n                        <li>\n                          <dl class=\"switch\">\n                            <dt>\n                              If the [[<a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-type\">type</a>]] internal slot of\n                              <var>key</var> is <code>\"private\"</code>:\n                            </dt>\n                            <dd>\n                              \n                            </dd>\n                          </dl>\n                        </li>\n                        <li>\n                          <p>\n                            Set the <code>key_ops</code> attribute of <var>jwk</var> to the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-usages\">usages</a> attribute of <var>key</var>.\n                          </p>\n                        </li>\n                        <li>\n                          <p>\n                            Set the <code>ext</code> attribute of <var>jwk</var> to the [[<a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-extractable\">extractable</a>]] internal slot\n                            of <var>key</var>.\n                          </p>\n                        </li>\n                        <li>\n                          <p>\n                            Let <var>result</var> be the result of converting <var>jwk</var>\n                            to an ECMAScript Object, as defined by [<a href=\"https://www.w3.org/TR/WebCryptoAPI/#WebIDL\">WebIDL</a>].\n                          </p>\n                        </li>\n                      </ul>\n                    </dd>\n                    <dt>Otherwise</dt>\n                    <dd>\n                      <p>\n                        <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">throw</a> a\n                        <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-NotSupportedError\"><code>NotSupportedError</code></a>.\n                      </p>\n                    </dd>\n                  </dl>",
          "rationale": ".switch",
          "steps": [
            {
              "operation": "switch",
              "steps": [
                {
                  "case": "If format is \"spki\"",
                  "html": "",
                  "rationale": "if",
                  "steps": [
                    {
                      "html": "<p>\n                            If the [[<a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-type\">type</a>]] internal slot\n                            of <var>key</var> is not <code>\"public\"</code>, then <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">throw</a> an <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-InvalidAccessError\"><code>InvalidAccessError</code></a>.\n                          </p>"
                    },
                    {
                      "html": "Set the <var>hashAlgorithm</var> field to an instance of\n                                        the <code>HashAlgorithm</code> ASN.1 type with the\n                                        following properties:",
                      "rationale": ".switch",
                      "steps": [
                        {
                          "operation": "switch",
                          "steps": [
                            {
                              "case": "If the name attribute of the hash attribute of the [[algorithm]] internal slot of key is \"SHA-1\":",
                              "html": "<p>\n                                            Set the <var>algorithm</var> object identifier\n                                            of <var>hashAlgorithm</var> to the\n                                            OID <code>id-sha1</code> defined in <a href=\"https://www.w3.org/TR/WebCryptoAPI/#RFC3447\">RFC 3447</a>.\n                                          </p>"
                            },
                            {
                              "case": "If the name attribute of the hash attribute of the [[algorithm]] internal slot of key is \"SHA-256\":",
                              "html": "<p>\n                                            Set the <var>algorithm</var> object identifier\n                                            of <var>hashAlgorithm</var> to the\n                                            OID <code>id-sha256</code> defined in <a href=\"https://www.w3.org/TR/WebCryptoAPI/#RFC3447\">RFC 3447</a>.\n                                          </p>"
                            },
                            {
                              "case": "If the name attribute of the hash attribute of the [[algorithm]] internal slot of key is \"SHA-384\":",
                              "html": "<p>\n                                            Set the <var>algorithm</var> object identifier\n                                            of <var>hashAlgorithm</var> to the\n                                            OID <code>id-sha384</code> defined in <a href=\"https://www.w3.org/TR/WebCryptoAPI/#RFC3447\">RFC 3447</a>.\n                                          </p>"
                            },
                            {
                              "case": "If the name attribute of the hash attribute of the [[algorithm]] internal slot of key is \"SHA-512\":",
                              "html": "<p>\n                                            Set the <var>algorithm</var> object identifier\n                                            of <var>hashAlgorithm</var> to the\n                                            OID <code>id-sha512</code> defined in <a href=\"https://www.w3.org/TR/WebCryptoAPI/#RFC3447\">RFC 3447</a>.\n                                          </p>"
                            },
                            {
                              "case": "Otherwise:",
                              "html": "",
                              "rationale": "perform",
                              "steps": [
                                {
                                  "html": "<p>\n                                                Perform any <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-rsa-pss-extended-export-steps\">key export steps</a>\n                                                defined by <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-applicable-specification\">other applicable\n                                                specifications</a>, passing <var>format</var> and the\n                                                <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-RsaHashedKeyAlgorithm\">hash</a> attribute of\n                                                the [[<a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-algorithm\">algorithm</a>]]\n                                                internal slot of <var>key</var>\n                                                and obtaining <var>hashOid</var> and <var>hashParams</var>.\n                                              </p>"
                                },
                                {
                                  "html": "<p>\n                                                Set the <var>algorithm</var> object identifier\n                                                of <var>hashAlgorithm</var> to <var>hashOid</var>.\n                                              </p>"
                                },
                                {
                                  "html": "<p>\n                                                Set the <var>params</var> field of <var>hashAlgorithm</var>\n                                                to\n                                                <var>hashParams</var> if <var>hashParams</var> is not\n                                                undefined and omit the <var>params</var> field otherwise.\n                                              </p>"
                                }
                              ]
                            }
                          ]
                        }
                      ]
                    },
                    {
                      "html": "<p>\n                            Let <var>result</var> be a new <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-ArrayBuffer\">ArrayBuffer</a> associated with the\n                            <a href=\"https://www.w3.org/TR/html51/webappapis.html#relevant-global-object\">relevant global object</a>\n                            of <code>this</code> [<a href=\"https://www.w3.org/TR/WebCryptoAPI/#HTML\">HTML</a>], and containing\n                            <var>data</var>.\n                          </p>"
                    }
                  ]
                },
                {
                  "case": "If format is \"pkcs8\":",
                  "html": "",
                  "rationale": "if",
                  "steps": [
                    {
                      "html": "<p>\n                            If the [[<a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-type\">type</a>]] internal slot\n                            of <var>key</var> is not <code>\"private\"</code>, then <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">throw</a> an <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-InvalidAccessError\"><code>InvalidAccessError</code></a>.\n                          </p>"
                    },
                    {
                      "html": "Set the <var>hashAlgorithm</var> field to an instance of\n                                        the <code>HashAlgorithm</code> ASN.1 type with the\n                                        following properties:",
                      "rationale": ".switch",
                      "steps": [
                        {
                          "operation": "switch",
                          "steps": [
                            {
                              "case": "If the name attribute of the hash attribute of the [[algorithm]] internal slot of key is \"SHA-1\":",
                              "html": "<p>\n                                            Set the <var>algorithm</var> object identifier\n                                            of <var>hashAlgorithm</var> to the\n                                            OID <code>id-sha1</code> defined in <a href=\"https://www.w3.org/TR/WebCryptoAPI/#RFC3447\">RFC 3447</a>.\n                                          </p>"
                            },
                            {
                              "case": "If the name attribute of the hash attribute of the [[algorithm]] internal slot of key is \"SHA-256\":",
                              "html": "<p>\n                                            Set the <var>algorithm</var> object identifier\n                                            of <var>hashAlgorithm</var> to the\n                                            OID <code>id-sha256</code> defined in <a href=\"https://www.w3.org/TR/WebCryptoAPI/#RFC3447\">RFC 3447</a>.\n                                          </p>"
                            },
                            {
                              "case": "If the name attribute of the hash attribute of the [[algorithm]] internal slot of key is \"SHA-384\":",
                              "html": "<p>\n                                            Set the <var>algorithm</var> object identifier\n                                            of <var>hashAlgorithm</var> to the\n                                            OID <code>id-sha384</code> defined in <a href=\"https://www.w3.org/TR/WebCryptoAPI/#RFC3447\">RFC 3447</a>.\n                                          </p>"
                            },
                            {
                              "case": "If the name attribute of the hash attribute of the [[algorithm]] internal slot of key is \"SHA-512\":",
                              "html": "<p>\n                                            Set the <var>algorithm</var> object identifier\n                                            of <var>hashAlgorithm</var> to the\n                                            OID <code>id-sha512</code> defined in <a href=\"https://www.w3.org/TR/WebCryptoAPI/#RFC3447\">RFC 3447</a>.\n                                          </p>"
                            },
                            {
                              "case": "Otherwise:",
                              "html": "",
                              "rationale": "perform",
                              "steps": [
                                {
                                  "html": "<p>\n                                                Perform any <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-rsa-pss-extended-export-steps\">key export steps</a>\n                                                defined by <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-applicable-specification\">other applicable\n                                                specifications</a>, passing <var>format</var> and the\n                                                <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-RsaHashedKeyAlgorithm\">hash</a> attribute of\n                                                the [[<a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-algorithm\">algorithm</a>]]\n                                                internal slot of <var>key</var>\n                                                and obtaining <var>hashOid</var> and <var>hashParams</var>.\n                                              </p>"
                                },
                                {
                                  "html": "<p>\n                                                Set the <var>algorithm</var> object identifier\n                                                of <var>hashAlgorithm</var> to <var>hashOid</var>.\n                                              </p>"
                                },
                                {
                                  "html": "<p>\n                                                Set the <var>params</var> field of <var>hashAlgorithm</var>\n                                                to\n                                                <var>hashParams</var> if <var>hashParams</var> is not\n                                                undefined and omit the <var>params</var> field otherwise.\n                                              </p>"
                                }
                              ]
                            }
                          ]
                        }
                      ]
                    },
                    {
                      "html": "<p>\n                            Let <var>result</var> be a new <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-ArrayBuffer\">ArrayBuffer</a> associated with the\n                            <a href=\"https://www.w3.org/TR/html51/webappapis.html#relevant-global-object\">relevant global object</a>\n                            of <code>this</code> [<a href=\"https://www.w3.org/TR/WebCryptoAPI/#HTML\">HTML</a>], and containing\n                            <var>data</var>.\n                          </p>"
                    }
                  ]
                },
                {
                  "case": "If format is \"jwk\":",
                  "html": "<ul>\n                        <li>\n                          <p>Let <var>jwk</var> be a new <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-JsonWebKey\">JsonWebKey</a> dictionary.</p>\n                        </li>\n                        <li>\n                          <p>Set the <code>kty</code> attribute of <var>jwk</var> to the string\n                          <code>\"RSA\"</code>.</p>\n                        </li>\n                        <li>\n                          <p>\n                            Let <var>hash</var> be the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-KeyAlgorithm-name\">name</a>\n                            attribute of the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-RsaHashedKeyAlgorithm-hash\">hash</a>\n                            attribute of the [[<a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-algorithm\">algorithm</a>]] internal slot of\n                            <var>key</var>.\n                          </p>\n                        </li>\n                        <li>\n                          <dl class=\"switch\">\n                            <dt>If <var>hash</var> is <code>\"SHA-1\"</code>:</dt>\n                            <dd>\n                              <p>\n                                Set the <code>alg</code> attribute of <var>jwk</var> to the string\n                                <code>\"PS1\"</code>.\n                              </p>\n                            </dd>\n                            <dt>If <var>hash</var> is <code>\"SHA-256\"</code>:</dt>\n                            <dd>\n                              <p>\n                                Set the <code>alg</code> attribute of <var>jwk</var> to the string\n                                <code>\"PS256\"</code>.\n                              </p>\n                            </dd>\n                            <dt>If <var>hash</var> is <code>\"SHA-384\"</code>:</dt>\n                            <dd>\n                              <p>\n                                Set the <code>alg</code> attribute of <var>jwk</var> to the string\n                                <code>\"PS384\"</code>.\n                              </p>\n                            </dd>\n                            <dt>If <var>hash</var> is <code>\"SHA-512\"</code>:</dt>\n                            <dd>\n                              <p>\n                                Set the <code>alg</code> attribute of <var>jwk</var> to the string\n                                <code>\"PS512\"</code>.\n                              </p>\n                            </dd>\n                            <dt>Otherwise:</dt>\n                            <dd>\n                              \n                            </dd>\n                          </dl>\n                        </li>\n                        <li>\n                          <p>\n                            Set the attributes <code>n</code> and <code>e</code> of <var>jwk</var>\n                            according to the corresponding definitions in <a href=\"https://www.w3.org/TR/WebCryptoAPI/#jwa\">JSON Web\n                            Algorithms</a>, Section 6.3.1.\n                          </p>\n                        </li>\n                        <li>\n                          <dl class=\"switch\">\n                            <dt>\n                              If the [[<a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-type\">type</a>]] internal slot of\n                              <var>key</var> is <code>\"private\"</code>:\n                            </dt>\n                            <dd>\n                              \n                            </dd>\n                          </dl>\n                        </li>\n                        <li>\n                          <p>\n                            Set the <code>key_ops</code> attribute of <var>jwk</var> to the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-usages\">usages</a> attribute of <var>key</var>.\n                          </p>\n                        </li>\n                        <li>\n                          <p>\n                            Set the <code>ext</code> attribute of <var>jwk</var> to the [[<a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-extractable\">extractable</a>]] internal slot\n                            of <var>key</var>.\n                          </p>\n                        </li>\n                        <li>\n                          <p>\n                            Let <var>result</var> be the result of converting <var>jwk</var>\n                            to an ECMAScript Object, as defined by [<a href=\"https://www.w3.org/TR/WebCryptoAPI/#WebIDL\">WebIDL</a>].\n                          </p>\n                        </li>\n                      </ul>",
                  "rationale": ".switch",
                  "steps": [
                    {
                      "operation": "switch",
                      "steps": [
                        {
                          "case": "If hash is \"SHA-1\":",
                          "html": "<p>\n                                Set the <code>alg</code> attribute of <var>jwk</var> to the string\n                                <code>\"PS1\"</code>.\n                              </p>"
                        },
                        {
                          "case": "If hash is \"SHA-256\":",
                          "html": "<p>\n                                Set the <code>alg</code> attribute of <var>jwk</var> to the string\n                                <code>\"PS256\"</code>.\n                              </p>"
                        },
                        {
                          "case": "If hash is \"SHA-384\":",
                          "html": "<p>\n                                Set the <code>alg</code> attribute of <var>jwk</var> to the string\n                                <code>\"PS384\"</code>.\n                              </p>"
                        },
                        {
                          "case": "If hash is \"SHA-512\":",
                          "html": "<p>\n                                Set the <code>alg</code> attribute of <var>jwk</var> to the string\n                                <code>\"PS512\"</code>.\n                              </p>"
                        },
                        {
                          "case": "Otherwise:",
                          "html": "",
                          "rationale": "perform",
                          "steps": [
                            {
                              "html": "<p>\n                                    Perform any <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-rsa-pss-extended-export-steps\">key export steps</a>\n                                    defined by <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-applicable-specification\">other applicable\n                                    specifications</a>, passing <var>format</var> and the\n                                    <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-RsaHashedKeyAlgorithm\">hash</a> attribute of\n                                    the [[<a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-algorithm\">algorithm</a>]]\n                                    internal slot of <var>key</var>\n                                    and obtaining <var>alg</var>.\n                                  </p>"
                            },
                            {
                              "html": "<p>\n                                    Set the <code>alg</code> attribute of <var>jwk</var> to <var>alg</var>.\n                                  </p>"
                            }
                          ]
                        }
                      ]
                    }
                  ],
                  "additional": [
                    {
                      "html": "",
                      "rationale": ".switch",
                      "steps": [
                        {
                          "operation": "switch",
                          "steps": [
                            {
                              "case": "If the [[type]] internal slot of key is \"private\":",
                              "html": "",
                              "rationale": "set",
                              "steps": [
                                {
                                  "html": "<p>\n                                    Set the attributes named <code>d</code>, <code>p</code>,\n                                    <code>q</code>, <code>dp</code>, <code>dq</code>, and\n                                    <code>qi</code> of <var>jwk</var> according to the\n                                    corresponding definitions in <a href=\"https://www.w3.org/TR/WebCryptoAPI/#jwa\">JSON Web\n                                    Algorithms</a>, Section 6.3.2.\n                                  </p>"
                                },
                                {
                                  "html": "<p>\n                                    If the underlying RSA private key represented by the [[<a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-handle\">handle</a>]] internal slot\n                                    of <var>key</var> is represented by more than two primes, set\n                                    the attribute named <code>oth</code> of <var>jwk</var>\n                                    according to the corresponding definition in <a href=\"https://www.w3.org/TR/WebCryptoAPI/#jwa\">JSON Web Algorithms</a>, Section 6.3.2.7\n                                  </p>"
                                }
                              ]
                            }
                          ]
                        }
                      ]
                    }
                  ]
                },
                {
                  "case": "Otherwise",
                  "html": "<p>\n                        <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">throw</a> a\n                        <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-NotSupportedError\"><code>NotSupportedError</code></a>.\n                      </p>"
                }
              ]
            }
          ]
        },
        {
          "html": "<p>\n                    Return <var>result</var>.\n                  </p>"
        }
      ]
    },
    {
      "html": "",
      "rationale": "if",
      "steps": [
        {
          "html": "<p>\n                    If the [[<a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-type\">type</a>]] internal slot of <var>key</var>\n                    is not <code>\"public\"</code>,\n                    then <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">throw</a> an\n                    <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-InvalidAccessError\"><code>InvalidAccessError</code></a>.\n                  </p>"
        },
        {
          "html": "<p>\n                    Let <var>label</var> be the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-contents-of-arraybuffer\">contents of</a> the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-RsaOaepParams-label\">label</a> member of\n                    <var>normalizedAlgorithm</var> or the empty octet string if the\n                    <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-RsaOaepParams-label\">label</a> member of\n                    <var>normalizedAlgorithm</var> is not present.\n                  </p>"
        },
        {
          "html": "<p>\n                    Perform the encryption operation defined in Section 7.1 of [<cite><a href=\"https://www.w3.org/TR/WebCryptoAPI/#RFC3447\">RFC3447</a></cite>] with the key represented by <var>key</var>\n                    as the recipient's RSA public key, the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-contents-of-arraybuffer\">contents of <var>plaintext</var></a>\n                    as the message to be encrypted, <var>M</var> and <var>label</var>\n                    as the label, <var>L</var>, and with the hash\n                    function specified by the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-RsaHashedKeyAlgorithm-hash\">hash</a>\n                    attribute of the [[<a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-algorithm\">algorithm</a>]] internal slot of\n                    <var>key</var> as the Hash option and MGF1 (defined in Section B.2.1 of\n                    [<cite><a href=\"https://www.w3.org/TR/WebCryptoAPI/#RFC3447\">RFC3447</a></cite>]) as the MGF option.\n                  </p>"
        },
        {
          "html": "<p>\n                    If performing the operation results in an error,\n                    then <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">throw</a> an\n                    <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-OperationError\"><code>OperationError</code></a>.\n                  </p>"
        },
        {
          "html": "<p>\n                    Let <var>ciphertext</var> be the value <var>C</var> that results from performing the\n                    operation.\n                  </p>"
        },
        {
          "html": "<p>\n                    Return a new <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-ArrayBuffer\">ArrayBuffer</a> associated with the\n                    <a href=\"https://www.w3.org/TR/html51/webappapis.html#relevant-global-object\">relevant global object</a>\n                    of <code>this</code> [<a href=\"https://www.w3.org/TR/WebCryptoAPI/#HTML\">HTML</a>], and \n                    containing <var>ciphertext</var>.\n                  </p>"
        }
      ]
    },
    {
      "html": "",
      "rationale": "if",
      "steps": [
        {
          "html": "<p>\n                    If the [[<a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-type\">type</a>]] internal slot of <var>key</var>\n                    is not <code>\"private\"</code>,\n                    then <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">throw</a> an\n                    <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-InvalidAccessError\"><code>InvalidAccessError</code></a>.\n                  </p>"
        },
        {
          "html": "<p>\n                    Let <var>label</var> be the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-contents-of-arraybuffer\">contents of</a> the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-RsaOaepParams-label\">label</a> member of\n                    <var>normalizedAlgorithm</var> or the empty octet string if the\n                    <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-RsaOaepParams-label\">label</a> member of\n                    <var>normalizedAlgorithm</var> is not present.\n                  </p>"
        },
        {
          "html": "<p>\n                    Perform the decryption operation defined in Section 7.1 of [<cite><a href=\"https://www.w3.org/TR/WebCryptoAPI/#RFC3447\">RFC3447</a></cite>] with the key represented by <var>key</var>\n                    as the recipient's RSA private key, the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-contents-of-arraybuffer\">contents of <var>ciphertext</var></a>\n                    as the ciphertext to be decrypted, C, and <var>label</var>\n                    as the label, <var>L</var>, and with the hash\n                    function specified by the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-RsaHashedKeyAlgorithm-hash\">hash</a>\n                    attribute of the [[<a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-algorithm\">algorithm</a>]] internal slot of\n                    <var>key</var> as the Hash option and MGF1 (defined in Section B.2.1 of\n                    [<cite><a href=\"https://www.w3.org/TR/WebCryptoAPI/#RFC3447\">RFC3447</a></cite>]) as the MGF option.\n                  </p>"
        },
        {
          "html": "<p>\n                    If performing the operation results in an error,\n                    then <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">throw</a> an\n                    <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-OperationError\"><code>OperationError</code></a>.\n                  </p>"
        },
        {
          "html": "<p>\n                    Let <var>plaintext</var> the value <var>M</var> that results from performing the\n                    operation.\n                  </p>"
        },
        {
          "html": "<p>\n                    Return a new <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-ArrayBuffer\">ArrayBuffer</a> associated with the\n                    <a href=\"https://www.w3.org/TR/html51/webappapis.html#relevant-global-object\">relevant global object</a>\n                    of <code>this</code> [<a href=\"https://www.w3.org/TR/WebCryptoAPI/#HTML\">HTML</a>], and \n                    containing <var>plaintext</var>.\n                  </p>"
        }
      ]
    },
    {
      "html": "",
      "rationale": "if",
      "steps": [
        {
          "html": "<p>\n                    If <var>usages</var> contains an entry which is not\n                    <code>\"encrypt\"</code>, <code>\"decrypt\"</code>,\n                    <code>\"wrapKey\"</code> or <code>\"unwrapKey\"</code>,\n                    then <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">throw</a> a\n                    <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-SyntaxError\"><code>SyntaxError</code></a>.\n                  </p>"
        },
        {
          "html": "<p>\n                    Generate an RSA key pair, as defined in [<cite><a href=\"https://www.w3.org/TR/WebCryptoAPI/#RFC3447\">RFC3447</a></cite>], with RSA modulus length equal to the\n                    <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-RsaKeyGenParams-modulusLength\">modulusLength</a> member of\n                    <var>normalizedAlgorithm</var> and RSA public exponent equal to the\n                    <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-RsaKeyGenParams-publicExponent\">publicExponent</a> member of\n                    <var>normalizedAlgorithm</var>.\n                  </p>"
        },
        {
          "html": "<p>\n                    If performing the operation results in an error,\n                    then <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">throw</a> an\n                    <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-OperationError\"><code>OperationError</code></a>.\n                  </p>"
        },
        {
          "html": "<p>\n                    Let <var>algorithm</var> be a new\n                    <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-RsaHashedKeyAlgorithm\">RsaHashedKeyAlgorithm</a>\n                    object.\n                  </p>"
        },
        {
          "html": "<p>\n                    Set the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-KeyAlgorithm-name\">name</a> attribute of\n                    <var>algorithm</var> to <code>\"RSA-OAEP\"</code>.\n                  </p>"
        },
        {
          "html": "<p>\n                    Set the\n                    <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-RsaKeyAlgorithm-modulusLength\">modulusLength</a>\n                    attribute of <var>algorithm</var> to equal the\n                    <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-RsaKeyGenParams-modulusLength\">modulusLength</a>\n                    member of <var>normalizedAlgorithm</var>.\n                  </p>"
        },
        {
          "html": "<p>\n                    Set the\n                    <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-RsaKeyAlgorithm-publicExponent\">publicExponent</a>\n                    attribute of <var>algorithm</var> to equal the\n                    <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-RsaKeyGenParams-publicExponent\">publicExponent</a>\n                    member of <var>normalizedAlgorithm</var>.\n                  </p>"
        },
        {
          "html": "<p>\n                    Set the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-RsaHashedKeyAlgorithm-hash\">hash</a> attribute\n                    of <var>algorithm</var> to equal the\n                    <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-RsaHashedKeyGenParams\">hash</a> member of\n                    <var>normalizedAlgorithm</var>.\n                  </p>"
        },
        {
          "html": "<p>\n                    Let <var>publicKey</var> be a new <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey\">CryptoKey</a> associated with the\n                    <a href=\"https://www.w3.org/TR/html51/webappapis.html#relevant-global-object\">relevant global object</a>\n                    of <code>this</code> [<a href=\"https://www.w3.org/TR/WebCryptoAPI/#HTML\">HTML</a>], and \n                    representing the public key of the generated key pair.\n                  </p>"
        },
        {
          "html": "<p>\n                    Set the [[<a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-type\">type</a>]] internal slot of\n                    <var>publicKey</var> to <code>\"public\"</code>\n                  </p>"
        },
        {
          "html": "<p>\n                    Set the [[<a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-algorithm\">algorithm</a>]] internal slot of\n                    <var>publicKey</var> to <var>algorithm</var>.\n                  </p>"
        },
        {
          "html": "<p>\n                    Set the [[<a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-extractable\">extractable</a>]] internal slot of\n                    <var>publicKey</var> to true.\n                  </p>"
        },
        {
          "html": "<p>\n                    Set the [[<a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-usages\">usages</a>]] internal slot of\n                    <var>publicKey</var> to be the\n                    <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-usage-intersection\">usage intersection</a> of\n                    <var>usages</var> and <code>[ \"encrypt\", \"wrapKey\" ]</code>.\n                  </p>"
        },
        {
          "html": "<p>\n                    Let <var>privateKey</var> be a new <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey\">CryptoKey</a> associated with the\n                    <a href=\"https://www.w3.org/TR/html51/webappapis.html#relevant-global-object\">relevant global object</a>\n                    of <code>this</code> [<a href=\"https://www.w3.org/TR/WebCryptoAPI/#HTML\">HTML</a>], and \n                    representing the private key of the generated key pair.\n                  </p>"
        },
        {
          "html": "<p>\n                    Set the [[<a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-type\">type</a>]] internal slot of\n                    <var>privateKey</var> to <code>\"private\"</code>\n                  </p>"
        },
        {
          "html": "<p>\n                    Set the [[<a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-algorithm\">algorithm</a>]] internal slot of\n                    <var>privateKey</var> to <var>algorithm</var>.\n                  </p>"
        },
        {
          "html": "<p>\n                    Set the [[<a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-extractable\">extractable</a>]] internal slot of\n                    <var>privateKey</var> to <var>extractable</var>.\n                  </p>"
        },
        {
          "html": "<p>\n                    Set the [[<a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-usages\">usages</a>]] internal slot of\n                    <var>privateKey</var> to be the\n                    <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-usage-intersection\">usage intersection</a> of\n                    <var>usages</var> and <code>[ \"decrypt\", \"unwrapKey\" ]</code>.\n                  </p>"
        },
        {
          "html": "<p>\n                    Let <var>result</var> be a new <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKeyPair\">CryptoKeyPair</a>\n                    dictionary.\n                  </p>"
        },
        {
          "html": "<p>\n                    Set the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKeyPair-publicKey\">publicKey</a> attribute\n                    of <var>result</var> to be <var>publicKey</var>.\n                  </p>"
        },
        {
          "html": "<p>\n                    Set the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKeyPair-privateKey\">privateKey</a> attribute\n                    of <var>result</var> to be <var>privateKey</var>.\n                  </p>"
        },
        {
          "html": "<p>\n                    Return the result of converting <var>result</var> to an ECMAScript Object, as\n                    defined by [<a href=\"https://www.w3.org/TR/WebCryptoAPI/#WebIDL\">WebIDL</a>].\n                  </p>"
        }
      ]
    },
    {
      "html": "",
      "rationale": "let",
      "steps": [
        {
          "html": "<p>Let <var>keyData</var> be the key data to be imported.</p>"
        },
        {
          "html": "<dl class=\"switch\">\n                    <dt>If <var>format</var> is <code>\"spki\"</code>:</dt>\n                    <dd>\n                      \n                    </dd>\n                    <dt>If <var>format</var> is <code>\"pkcs8\"</code>:</dt>\n                    <dd>\n                      \n                    </dd>\n                    <dt>If <var>format</var> is <code>\"jwk\"</code>:</dt>\n                    <dd>\n                      \n                    </dd>\n                    <dt>Otherwise:</dt>\n                    <dd>\n                      <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">throw</a> a\n                      <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-NotSupportedError\"><code>NotSupportedError</code></a>.\n                    </dd>\n                  </dl>",
          "rationale": ".switch",
          "steps": [
            {
              "operation": "switch",
              "steps": [
                {
                  "case": "If format is \"spki\":",
                  "html": "",
                  "rationale": "if",
                  "steps": [
                    {
                      "html": "<p>\n                            If <var>usages</var> contains an entry which is not\n                            <code>\"encrypt\"</code> or\n                            <code>\"wrapKey\"</code>,\n                            then <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">throw</a> a\n                            <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-SyntaxError\"><code>SyntaxError</code></a>.\n                          </p>"
                    },
                    {
                      "html": "<p>\n                            Let <var>spki</var> be the result of running the\n                            <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-parse-a-spki\">parse a subjectPublicKeyInfo</a>\n                            algorithm over <var>keyData</var>.\n                          </p>"
                    },
                    {
                      "html": "<p>\n                            If an error occurred while parsing,\n                            then <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">throw</a> a\n                            <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-DataError\"><code>DataError</code></a>.\n                          </p>"
                    },
                    {
                      "html": "<p>\n                            Let <var>hash</var> be a string whose initial value is undefined.\n                          </p>"
                    },
                    {
                      "html": "<p>\n                            Let <var>alg</var> be the <code>algorithm</code> object identifier\n                            field of the <code>algorithm</code> AlgorithmIdentifier field of\n                            <var>spki</var>.\n                          </p>"
                    },
                    {
                      "html": "<dl class=\"switch\">\n                            <dt>\n                              If <var>alg</var> is equivalent to the <code>rsaEncryption</code>\n                              OID defined in <a href=\"https://www.w3.org/TR/WebCryptoAPI/#RFC3447\">RFC 3447</a>:\n                            </dt>\n                            <dd>\n                              <p>\n                                Let <var>hash</var> be undefined.\n                              </p>\n                            </dd>\n                            <dt>\n                              If <var>alg</var> is equivalent to the <code>id-RSAES-OAEP</code>\n                              OID defined in <a href=\"https://www.w3.org/TR/WebCryptoAPI/#RFC3447\">RFC 3447</a>:\n                            </dt>\n                            <dd>\n                              \n                            </dd>\n                            <dt>Otherwise:</dt>\n                            <dd>\n                              <p>\n                                <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">throw</a> a\n                                <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-DataError\"><code>DataError</code></a>.\n                              </p>\n                            </dd>\n                          </dl>",
                      "rationale": ".switch",
                      "steps": [
                        {
                          "operation": "switch",
                          "steps": [
                            {
                              "case": "If alg is equivalent to the rsaEncryption OID defined in RFC 3447:",
                              "html": "<p>\n                                Let <var>hash</var> be undefined.\n                              </p>"
                            },
                            {
                              "case": "If alg is equivalent to the id-RSAES-OAEP OID defined in RFC 3447:",
                              "html": "",
                              "rationale": "let",
                              "steps": [
                                {
                                  "html": "<p>\n                                    Let <var>params</var> be the ASN.1 structure contained within\n                                    the <code>parameters</code> field of the <code>algorithm</code>\n                                    AlgorithmIdentifier field of <var>spki</var>.\n                                  </p>"
                                },
                                {
                                  "html": "<p>\n                                    If <var>params</var> is not defined, or is not an instance of\n                                    the <code>RSAES-OAEP-params</code> ASN.1 type defined in\n                                    <a href=\"https://www.w3.org/TR/WebCryptoAPI/#RFC3447\">RFC3447</a>,\n                                    <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">throw</a> a\n                                    <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-DataError\"><code>DataError</code></a>.\n                                  </p>"
                                },
                                {
                                  "html": "<p>\n                                    Let <var>hashAlg</var> be the AlgorithmIdentifier ASN.1 type\n                                    within the <code>hashAlgorithm</code> field of <var>params</var>.\n                                  </p>"
                                },
                                {
                                  "html": "<dl class=\"switch\">\n                                    <dt>\n                                      If the <code>algorithm</code> object identifier field of\n                                      <var>hashAlg</var> is equivalent to the <code>id-sha1</code>\n                                      OID defined in <a href=\"https://www.w3.org/TR/WebCryptoAPI/#RFC3447\">RFC 3447</a>:\n                                    </dt>\n                                    <dd>\n                                      <p>\n                                        Set <var>hash</var> to the string <code>\"SHA-1\"</code>.\n                                      </p>\n                                    </dd>\n                                    <dt>\n                                      If the <code>algorithm</code> object identifier field of\n                                      <var>hashAlg</var> is equivalent to the <code>id-sha256</code>\n                                      OID defined in <a href=\"https://www.w3.org/TR/WebCryptoAPI/#RFC3447\">RFC 3447</a>:\n                                    </dt>\n                                    <dd>\n                                      <p>\n                                        Set <var>hash</var> to the string <code>\"SHA-256\"</code>.\n                                      </p>\n                                    </dd>\n                                    <dt>\n                                      If the <code>algorithm</code> object identifier field of\n                                      <var>hashAlg</var> is equivalent to the <code>id-sha384</code>\n                                      OID defined in <a href=\"https://www.w3.org/TR/WebCryptoAPI/#RFC3447\">RFC 3447</a>:\n                                    </dt>\n                                    <dd>\n                                      <p>\n                                        Set <var>hash</var> to the string <code>\"SHA-384\"</code>.\n                                      </p>\n                                    </dd>\n                                    <dt>\n                                      If the <code>algorithm</code> object identifier field of\n                                      <var>hashAlg</var> is equivalent to the <code>id-sha512</code>\n                                      OID defined in <a href=\"https://www.w3.org/TR/WebCryptoAPI/#RFC3447\">RFC 3447</a>:\n                                    </dt>\n                                    <dd>\n                                      <p>\n                                        Set <var>hash</var> to the string <code>\"SHA-512\"</code>.\n                                      </p>\n                                    </dd>\n                                    <dt>Otherwise:</dt>\n                                    <dd>\n                                      \n                                    </dd>\n                                  </dl>",
                                  "rationale": ".switch",
                                  "steps": [
                                    {
                                      "operation": "switch",
                                      "steps": [
                                        {
                                          "case": "If the algorithm object identifier field of hashAlg is equivalent to the id-sha1 OID defined in RFC 3447:",
                                          "html": "<p>\n                                        Set <var>hash</var> to the string <code>\"SHA-1\"</code>.\n                                      </p>"
                                        },
                                        {
                                          "case": "If the algorithm object identifier field of hashAlg is equivalent to the id-sha256 OID defined in RFC 3447:",
                                          "html": "<p>\n                                        Set <var>hash</var> to the string <code>\"SHA-256\"</code>.\n                                      </p>"
                                        },
                                        {
                                          "case": "If the algorithm object identifier field of hashAlg is equivalent to the id-sha384 OID defined in RFC 3447:",
                                          "html": "<p>\n                                        Set <var>hash</var> to the string <code>\"SHA-384\"</code>.\n                                      </p>"
                                        },
                                        {
                                          "case": "If the algorithm object identifier field of hashAlg is equivalent to the id-sha512 OID defined in RFC 3447:",
                                          "html": "<p>\n                                        Set <var>hash</var> to the string <code>\"SHA-512\"</code>.\n                                      </p>"
                                        },
                                        {
                                          "case": "Otherwise:",
                                          "html": "",
                                          "rationale": "perform",
                                          "steps": [
                                            {
                                              "html": "<p>\n                                            Perform any <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-rsa-oaep-extended-import-steps\">key\n                                            import steps</a> defined by\n                                            <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-applicable-specification\">other applicable\n                                            specifications</a>, passing <var>format</var>, <var>spki</var>\n                                            and obtaining <var>hash</var>.\n                                          </p>"
                                            },
                                            {
                                              "html": "<p>\n                                            If an error occured or there are no\n                                            <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-applicable-specification\">applicable\n                                            specifications</a>,\n                                            <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">throw</a> a\n                                            <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-DataError\"><code>DataError</code></a>.\n                                          </p>"
                                            }
                                          ]
                                        }
                                      ]
                                    }
                                  ]
                                },
                                {
                                  "html": "<p>\n                                    If the <code>algorithm</code> object identifier field of the\n                                    <code>maskGenAlgorithm</code> field of <var>params</var> is not\n                                    equivalent to the OID <code>id-mgf1</code> defined in <a href=\"https://www.w3.org/TR/WebCryptoAPI/#RFC3447\">RFC 3447</a>, <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">throw</a> a <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-NotSupportedError\"><code>NotSupportedError</code></a>.\n                                  </p>"
                                },
                                {
                                  "html": "<p>\n                                    If the <code>parameters</code> field of the\n                                    <code>maskGenAlgorithm</code> field of <var>params</var> is not\n                                    an instance of the <code>HashAlgorithm</code> ASN.1 type that is\n                                    identical in content to the <code>hashAlglorithm</code> field of\n                                    <var>params</var>, <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">throw</a> a <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-NotSupportedError\"><code>NotSupportedError</code></a>.\n                                  </p>"
                                }
                              ]
                            },
                            {
                              "case": "Otherwise:",
                              "html": "<p>\n                                <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">throw</a> a\n                                <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-DataError\"><code>DataError</code></a>.\n                              </p>"
                            }
                          ]
                        }
                      ]
                    },
                    {
                      "html": "<dl>\n                            <dt>\n                              If <var>hash</var> is not undefined:\n                            </dt>\n                            <dd>\n                              \n                            </dd>\n                          </dl>",
                      "rationale": "let",
                      "steps": [
                        {
                          "html": "<p>\n                                    Let <var>normalizedHash</var> be the result of\n                                    <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-normalize-an-algorithm\">normalize an algorithm</a>\n                                    with <code>alg</code> set to <var>hash</var> and <code>op</code> set\n                                    to <code>digest</code>.\n                                  </p>"
                        },
                        {
                          "html": "<p>\n                                    If <var>normalizedHash</var> is not equal to the\n                                    <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-RsaHashedImportParams-hash\">hash</a> member of\n                                    <var>normalizedAlgorithm</var>, <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">throw</a> a <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-DataError\"><code>DataError</code></a>.\n                                  </p>"
                        }
                      ]
                    },
                    {
                      "html": "<p>\n                            Let <var>publicKey</var> be the result of performing the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-parse-an-asn1-structure\">parse an ASN.1 structure</a>\n                            algorithm, with <var>data</var> as the\n                            <code>subjectPublicKeyInfo</code> field of <var>spki</var>,\n                            <var>structure</var> as the <code>RSAPublicKey</code> structure\n                            specified in Section A.1.1 of <a href=\"https://www.w3.org/TR/WebCryptoAPI/#RFC3447\">RFC 3447</a>, and\n                            <var>exactData</var> set to true.\n                          </p>"
                    },
                    {
                      "html": "<p>\n                            If an error occurred while parsing, or it can be determined that <var>publicKey</var>\n                            is not a valid public key according to <a href=\"https://www.w3.org/TR/WebCryptoAPI/#RFC3447\">RFC 3447</a>,\n                            then <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">throw</a> a\n                            <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-DataError\"><code>DataError</code></a>.\n                          </p>"
                    },
                    {
                      "html": "<p>\n                            Let <var>key</var> be a new <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey\">CryptoKey</a> associated with the\n                            <a href=\"https://www.w3.org/TR/html51/webappapis.html#relevant-global-object\">relevant global object</a>\n                            of <code>this</code> [<a href=\"https://www.w3.org/TR/WebCryptoAPI/#HTML\">HTML</a>], and\n                            that represents the RSA public key identified by\n                            <var>publicKey</var>.\n                          </p>"
                    },
                    {
                      "html": "<p>\n                            Set the [[<a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-type\">type</a>]] internal slot of\n                            <var>key</var> to <code>\"public\"</code>\n                          </p>"
                    }
                  ]
                },
                {
                  "case": "If format is \"pkcs8\":",
                  "html": "",
                  "rationale": "if",
                  "steps": [
                    {
                      "html": "<p>\n                            If <var>usages</var> contains an entry which is not\n                            <code>\"decrypt\"</code> or <code>\"unwrapKey\"</code>,\n                            then <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">throw</a> a\n                            <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-SyntaxError\"><code>SyntaxError</code></a>.\n                          </p>"
                    },
                    {
                      "html": "<p>\n                            Let <var>privateKeyInfo</var> be the result of running the\n                            <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-parse-a-privateKeyInfo\">parse a privateKeyInfo</a>\n                            algorithm over <var>keyData</var>.\n                          </p>"
                    },
                    {
                      "html": "<p>\n                            If an error occurred while parsing, then <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">throw</a> a <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-DataError\"><code>DataError</code></a>.\n                          </p>"
                    },
                    {
                      "html": "<p>\n                            Let <var>hash</var> be a string whose initial value is undefined.\n                          </p>"
                    },
                    {
                      "html": "<p>\n                            Let <var>alg</var> be the <code>algorithm</code> object identifier\n                            field of the <code>privateKeyAlgorithm</code>\n                            PrivateKeyAlgorithmIdentifier field of <var>privateKeyInfo</var>.\n                          </p>"
                    },
                    {
                      "html": "<dl class=\"switch\">\n                            <dt>\n                              If <var>alg</var> is equivalent to the <code>rsaEncryption</code>\n                              OID defined in <a href=\"https://www.w3.org/TR/WebCryptoAPI/#RFC3447\">RFC 3447</a>:\n                            </dt>\n                            <dd>\n                              <p>\n                                Let <var>hash</var> be undefined.\n                              </p>\n                            </dd>\n                            <dt>\n                              If <var>alg</var> is equivalent to the <code>id-RSAES-OAEP</code>\n                              OID defined in <a href=\"https://www.w3.org/TR/WebCryptoAPI/#RFC3447\">RFC 3447</a>:\n                            </dt>\n                            <dd>\n                              \n                            </dd>\n                            <dt>Otherwise:</dt>\n                            <dd>\n                              <p>\n                                <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">throw</a> a\n                                <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-DataError\"><code>DataError</code></a>.\n                              </p>\n                            </dd>\n                          </dl>",
                      "rationale": ".switch",
                      "steps": [
                        {
                          "operation": "switch",
                          "steps": [
                            {
                              "case": "If alg is equivalent to the rsaEncryption OID defined in RFC 3447:",
                              "html": "<p>\n                                Let <var>hash</var> be undefined.\n                              </p>"
                            },
                            {
                              "case": "If alg is equivalent to the id-RSAES-OAEP OID defined in RFC 3447:",
                              "html": "",
                              "rationale": "let",
                              "steps": [
                                {
                                  "html": "<p>\n                                    Let <var>params</var> be the ASN.1 structure contained within\n                                    the <code>parameters</code> field of the\n                                    <code>privateKeyAlgorithm</code> PrivateKeyAlgorithmIdentifier\n                                    field of <var>privateKeyInfo</var>.\n                                  </p>"
                                },
                                {
                                  "html": "<p>\n                                    If <var>params</var> is not defined, or is not an instance of\n                                    the <code>RSAES-OAEP-params</code> ASN.1 type defined in <a href=\"https://www.w3.org/TR/WebCryptoAPI/#RFC3447\">RFC3447</a>, <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">throw</a> a <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-NotSupportedError\"><code>NotSupportedError</code></a>.\n                                  </p>"
                                },
                                {
                                  "html": "<p>\n                                    Let <var>hashAlg</var> be the AlgorithmIdentifier ASN.1 type\n                                    within the <code>hashAlgorithm</code> field of\n                                    <var>params</var>.\n                                  </p>"
                                },
                                {
                                  "html": "<dl class=\"switch\">\n                                    <dt>\n                                      If the <code>algorithm</code> object identifier field of\n                                      <var>hashAlg</var> is equivalent to the <code>id-sha1</code>\n                                      OID defined in <a href=\"https://www.w3.org/TR/WebCryptoAPI/#RFC3447\">RFC 3447</a>:\n                                    </dt>\n                                    <dd>\n                                      <p>\n                                        Set <var>hash</var> to the string <code>\"SHA-1\"</code>.\n                                      </p>\n                                    </dd>\n                                    <dt>\n                                      If the <code>algorithm</code> object identifier field of\n                                      <var>hashAlg</var> is equivalent to the\n                                      <code>id-sha256</code> OID defined in <a href=\"https://www.w3.org/TR/WebCryptoAPI/#RFC3447\">RFC\n                                      3447</a>:\n                                    </dt>\n                                    <dd>\n                                      <p>\n                                        Set <var>hash</var> to the string <code>\"SHA-256\"</code>.\n                                      </p>\n                                    </dd>\n                                    <dt>\n                                      If the <code>algorithm</code> object identifier field of\n                                      <var>hashAlg</var> is equivalent to the\n                                      <code>id-sha384</code> OID defined in <a href=\"https://www.w3.org/TR/WebCryptoAPI/#RFC3447\">RFC\n                                      3447</a>:\n                                    </dt>\n                                    <dd>\n                                      <p>\n                                        Set <var>hash</var> to the string <code>\"SHA-384\"</code>.\n                                      </p>\n                                    </dd>\n                                    <dt>\n                                      If the <code>algorithm</code> object identifier field of\n                                      <var>hashAlg</var> is equivalent to the\n                                      <code>id-sha512</code> OID defined in <a href=\"https://www.w3.org/TR/WebCryptoAPI/#RFC3447\">RFC\n                                      3447</a>:\n                                    </dt>\n                                    <dd>\n                                      <p>\n                                        Set <var>hash</var> to the string <code>\"SHA-512\"</code>.\n                                      </p>\n                                    </dd>\n                                    <dt>Otherwise:</dt>\n                                    <dd>\n                                      \n                                    </dd>\n                                  </dl>",
                                  "rationale": ".switch",
                                  "steps": [
                                    {
                                      "operation": "switch",
                                      "steps": [
                                        {
                                          "case": "If the algorithm object identifier field of hashAlg is equivalent to the id-sha1 OID defined in RFC 3447:",
                                          "html": "<p>\n                                        Set <var>hash</var> to the string <code>\"SHA-1\"</code>.\n                                      </p>"
                                        },
                                        {
                                          "case": "If the algorithm object identifier field of hashAlg is equivalent to the id-sha256 OID defined in RFC 3447:",
                                          "html": "<p>\n                                        Set <var>hash</var> to the string <code>\"SHA-256\"</code>.\n                                      </p>"
                                        },
                                        {
                                          "case": "If the algorithm object identifier field of hashAlg is equivalent to the id-sha384 OID defined in RFC 3447:",
                                          "html": "<p>\n                                        Set <var>hash</var> to the string <code>\"SHA-384\"</code>.\n                                      </p>"
                                        },
                                        {
                                          "case": "If the algorithm object identifier field of hashAlg is equivalent to the id-sha512 OID defined in RFC 3447:",
                                          "html": "<p>\n                                        Set <var>hash</var> to the string <code>\"SHA-512\"</code>.\n                                      </p>"
                                        },
                                        {
                                          "case": "Otherwise:",
                                          "html": "",
                                          "rationale": "perform",
                                          "steps": [
                                            {
                                              "html": "<p>\n                                            Perform any <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-rsa-oaep-extended-import-steps\">key\n                                            import steps</a> defined by\n                                            <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-applicable-specification\">other applicable\n                                            specifications</a>, passing <var>format</var>, <var>spki</var>\n                                            and obtaining <var>hash</var>.\n                                          </p>"
                                            },
                                            {
                                              "html": "<p>\n                                            If an error occured or there are no\n                                            <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-applicable-specification\">applicable\n                                            specifications</a>,\n                                            <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">throw</a> a\n                                            <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-DataError\"><code>DataError</code></a>.\n                                          </p>"
                                            }
                                          ]
                                        }
                                      ]
                                    }
                                  ]
                                },
                                {
                                  "html": "<p>\n                                    If the <code>algorithm</code> object identifier field of the\n                                    <code>maskGenAlgorithm</code> field of <var>params</var> is not\n                                    equivalent to the OID <code>id-mgf1</code> defined in <a href=\"https://www.w3.org/TR/WebCryptoAPI/#RFC3447\">RFC 3447</a>, <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">throw</a> a <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-NotSupportedError\"><code>NotSupportedError</code></a>.\n                                  </p>"
                                },
                                {
                                  "html": "<p>\n                                    If the <code>parameters</code> field of the\n                                    <code>maskGenAlgorithm</code> field of <var>params</var> is not\n                                    an instance of the <code>HashAlgorithm</code> ASN.1 type that is\n                                    identical in content to the <code>hashAlglorithm</code> field of\n                                    <var>params</var>, <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">throw</a> a <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-NotSupportedError\"><code>NotSupportedError</code></a>.\n                                  </p>"
                                }
                              ]
                            },
                            {
                              "case": "Otherwise:",
                              "html": "<p>\n                                <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">throw</a> a\n                                <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-DataError\"><code>DataError</code></a>.\n                              </p>"
                            }
                          ]
                        }
                      ]
                    },
                    {
                      "html": "<dl>\n                            <dt>\n                              If <var>hash</var> is not undefined:\n                            </dt>\n                            <dd>\n                              \n                            </dd>\n                          </dl>",
                      "rationale": "let",
                      "steps": [
                        {
                          "html": "<p>\n                                    Let <var>normalizedHash</var> be the result of\n                                    <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-normalize-an-algorithm\">normalize an algorithm</a>\n                                    with <code>alg</code> set to <var>hash</var> and <code>op</code> set\n                                    to <code>digest</code>.\n                                  </p>"
                        },
                        {
                          "html": "<p>\n                                    If <var>normalizedHash</var> is not equal to the\n                                    <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-RsaHashedImportParams-hash\">hash</a> member of\n                                    <var>normalizedAlgorithm</var>, <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">throw</a> a <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-DataError\"><code>DataError</code></a>.\n                                  </p>"
                        }
                      ]
                    },
                    {
                      "html": "<p>\n                            Let <var>rsaPrivateKey</var> be the result of performing the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-parse-an-asn1-structure\">parse an ASN.1 structure</a>\n                            algorithm, with <var>data</var> as the\n                            <code>privateKey</code> field of <var>privateKeyInfo</var>,\n                            <var>structure</var> as the <code>RSAPrivateKey</code> structure\n                            specified in Section A.1.2 of <a href=\"https://www.w3.org/TR/WebCryptoAPI/#RFC3447\">RFC 3447</a>, and\n                            <var>exactData</var> set to true.\n                          </p>"
                    },
                    {
                      "html": "<p>\n                            If an error occurred while parsing, or if <var>rsaPrivateKey</var> is not\n                            a valid RSA private key according to <a href=\"https://www.w3.org/TR/WebCryptoAPI/#RFC3447\">RFC 3447</a>,\n                            then <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">throw</a> a\n                            <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-DataError\"><code>DataError</code></a>.\n                          </p>"
                    },
                    {
                      "html": "<p>\n                            Let <var>key</var> be a new <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey\">CryptoKey</a> associated with the\n                            <a href=\"https://www.w3.org/TR/html51/webappapis.html#relevant-global-object\">relevant global object</a>\n                            of <code>this</code> [<a href=\"https://www.w3.org/TR/WebCryptoAPI/#HTML\">HTML</a>], and\n                            that represents the RSA private key identified by\n                            <var>rsaPrivateKey</var>.\n                          </p>"
                    },
                    {
                      "html": "<p>\n                            Set the [[<a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-type\">type</a>]] internal slot of\n                            <var>key</var> to <code>\"private\"</code>\n                          </p>"
                    }
                  ]
                },
                {
                  "case": "If format is \"jwk\":",
                  "html": "",
                  "rationale": "if",
                  "steps": [
                    {
                      "html": "<dl class=\"switch\">\n                            <dt>If <var>keyData</var> is a <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-JsonWebKey\">JsonWebKey</a> dictionary:</dt>\n                            <dd><p>Let <var>jwk</var> equal <var>keyData</var>.</p></dd>\n                            <dt>Otherwise:</dt>\n                            <dd><p><a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">Throw</a> a <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-DataError\"><code>DataError</code></a>.</p></dd>\n                          </dl>",
                      "rationale": ".switch",
                      "steps": [
                        {
                          "operation": "switch",
                          "steps": [
                            {
                              "case": "If keyData is a JsonWebKey dictionary:",
                              "html": "<p>Let <var>jwk</var> equal <var>keyData</var>.</p>"
                            },
                            {
                              "case": "Otherwise:",
                              "html": "<p><a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">Throw</a> a <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-DataError\"><code>DataError</code></a>.</p>"
                            }
                          ]
                        }
                      ]
                    },
                    {
                      "html": "<p>\n                            If the <code>\"d\"</code> field of <var>jwk</var> is present and\n                            <var>usages</var> contains an entry which is not\n                            <code>\"decrypt\"</code> or <code>\"unwrapKey\"</code>,\n                            then <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">throw</a> a\n                            <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-SyntaxError\"><code>SyntaxError</code></a>.\n                          </p>"
                    },
                    {
                      "html": "<p>\n                            If the <code>\"d\"</code> field of <var>jwk</var> is not present and\n                            <var>usages</var> contains an entry which is not\n                            <code>\"encrypt\"</code> or <code>\"wrapKey\"</code>,\n                            then <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">throw</a> a\n                            <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-SyntaxError\"><code>SyntaxError</code></a>.\n                          </p>"
                    },
                    {
                      "html": "<p>\n                            If the <code>\"kty\"</code> field of <var>jwk</var> is not a\n                            case-sensitive string match to <code>\"RSA\"</code>,\n                            then <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">throw</a> a\n                            <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-DataError\"><code>DataError</code></a>.\n                          </p>"
                    },
                    {
                      "html": "<p>\n                            If <var>usages</var> is non-empty and the <code>\"use\"</code> field of <var>jwk</var> is present and is\n                            not a case-sensitive string match to <code>\"enc\"</code>,\n                            then <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">throw</a> a\n                            <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-DataError\"><code>DataError</code></a>.\n                          </p>"
                    },
                    {
                      "html": "<p>\n                            If the <code>\"key_ops\"</code> field of <var>jwk</var> is present, and\n                            is invalid according to the requirements of\n                            <a href=\"https://www.w3.org/TR/WebCryptoAPI/#jwk\">JSON Web Key</a> or\n                            does not contain all of the specified <var>usages</var> values,\n                            then <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">throw</a> a\n                            <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-DataError\"><code>DataError</code></a>.\n                          </p>"
                    },
                    {
                      "html": "<p>\n                            If the <code>\"ext\"</code> field of <var>jwk</var> is present and\n                            has the value false and <var>extractable</var> is true,\n                            then <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">throw</a> a\n                            <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-DataError\"><code>DataError</code></a>.\n                          </p>"
                    },
                    {
                      "html": "<dl class=\"switch\">\n                            <dt>If the <code>alg</code> field of <var>jwk</var> is not present:</dt>\n                            <dd>Let <var>hash</var> be undefined.</dd>\n                            <dt>\n                              If the <code>alg</code> field of <var>jwk</var> is equal to\n                              <code>\"RSA-OAEP\"</code>:\n                            </dt>\n                            <dd>Let <var>hash</var> be the string <code>\"SHA-1\"</code>.</dd>\n                            <dt>\n                              If the <code>alg</code> field of <var>jwk</var> is equal to\n                              <code>\"RSA-OAEP-256\"</code>:\n                            </dt>\n                            <dd>Let <var>hash</var> be the string <code>\"SHA-256\"</code>.</dd>\n                            <dt>\n                              If the <code>alg</code> field of <var>jwk</var> is equal to\n                              <code>\"RSA-OAEP-384\"</code>:\n                            </dt>\n                            <dd>Let <var>hash</var> be the string <code>\"SHA-384\"</code>.</dd>\n                            <dt>\n                              If the <code>alg</code> field of <var>jwk</var> is equal to\n                              <code>\"RSA-OAEP-512\"</code>:\n                            </dt>\n                            <dd>Let <var>hash</var> be the string <code>\"SHA-512\"</code>.</dd>\n                            <dt>Otherwise:</dt>\n                            <dd>\n                              \n                            </dd>\n                          </dl>",
                      "rationale": ".switch",
                      "steps": [
                        {
                          "operation": "switch",
                          "steps": [
                            {
                              "case": "If the alg field of jwk is not present:",
                              "html": "Let <var>hash</var> be undefined."
                            },
                            {
                              "case": "If the alg field of jwk is equal to \"RSA-OAEP\":",
                              "html": "Let <var>hash</var> be the string <code>\"SHA-1\"</code>."
                            },
                            {
                              "case": "If the alg field of jwk is equal to \"RSA-OAEP-256\":",
                              "html": "Let <var>hash</var> be the string <code>\"SHA-256\"</code>."
                            },
                            {
                              "case": "If the alg field of jwk is equal to \"RSA-OAEP-384\":",
                              "html": "Let <var>hash</var> be the string <code>\"SHA-384\"</code>."
                            },
                            {
                              "case": "If the alg field of jwk is equal to \"RSA-OAEP-512\":",
                              "html": "Let <var>hash</var> be the string <code>\"SHA-512\"</code>."
                            },
                            {
                              "case": "Otherwise:",
                              "html": "",
                              "rationale": "perform",
                              "steps": [
                                {
                                  "html": "<p>\n                                    Perform any <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-rsa-oaep-extended-import-steps\">key\n                                    import steps</a> defined by\n                                    <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-applicable-specification\">other applicable\n                                    specifications</a>, passing <var>format</var>, <var>jwk</var>\n                                    and obtaining <var>hash</var>.\n                                  </p>"
                                },
                                {
                                  "html": "<p>\n                                    If an error occured or there are no\n                                    <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-applicable-specification\">applicable\n                                    specifications</a>,\n                                    <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">throw</a> a\n                                    <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-DataError\"><code>DataError</code></a>.\n                                  </p>"
                                }
                              ]
                            }
                          ]
                        }
                      ]
                    },
                    {
                      "html": "<dl>\n                            <dt>\n                              If <var>hash</var> is not undefined:\n                            </dt>\n                            <dd>\n                              \n                            </dd>\n                          </dl>",
                      "rationale": "let",
                      "steps": [
                        {
                          "html": "<p>\n                                    Let <var>normalizedHash</var> be the result of\n                                    <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-normalize-an-algorithm\">normalize an algorithm</a>\n                                    with <code>alg</code> set to <var>hash</var> and <code>op</code> set\n                                    to <code>digest</code>.\n                                  </p>"
                        },
                        {
                          "html": "<p>\n                                    If <var>normalizedHash</var> is not equal to the\n                                    <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-RsaHashedImportParams-hash\">hash</a> member of\n                                    <var>normalizedAlgorithm</var>, <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">throw</a> a <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-DataError\"><code>DataError</code></a>.\n                                  </p>"
                        }
                      ]
                    },
                    {
                      "html": "<dl class=\"switch\">\n                            <dt>If the <code>\"d\"</code> field of <var>jwk</var> is present:</dt>\n                            <dd>\n                              \n                            </dd>\n                            <dt>Otherwise:</dt>\n                            <dd>\n                              \n                            </dd>\n                          </dl>",
                      "rationale": ".switch",
                      "steps": [
                        {
                          "operation": "switch",
                          "steps": [
                            {
                              "case": "If the \"d\" field of jwk is present:",
                              "html": "",
                              "rationale": "if",
                              "steps": [
                                {
                                  "html": "<p>\n                                    If <var>jwk</var> does not meet the requirements of Section\n                                    6.3.2 of <a href=\"https://www.w3.org/TR/WebCryptoAPI/#jwa\">JSON Web Algorithms</a>, then <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">throw</a> a <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-DataError\"><code>DataError</code></a>.\n                                  </p>"
                                },
                                {
                                  "html": "<p>\n                                    Let <var>privateKey</var> represent the\n                                    RSA public key identified by interpreting <var>jwk</var>\n                                    according to Section 6.3.1 of <a href=\"https://www.w3.org/TR/WebCryptoAPI/#jwa\"> JSON Web\n                                    Algorithms</a>.\n                                  </p>"
                                },
                                {
                                  "html": "<p>\n                                    If <var>privateKey</var> can be determined to not be a valid RSA public key\n                                    according to <a href=\"https://www.w3.org/TR/WebCryptoAPI/#RFC3447\">RFC 3447</a>,\n                                    then <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">throw</a> a\n                                    <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-DataError\"><code>DataError</code></a>.\n                                  </p>"
                                },
                                {
                                  "html": "<p>\n                                    Let <var>key</var> be a new <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey\">CryptoKey</a> representing <var>privateKey</var>.\n                                  </p>"
                                },
                                {
                                  "html": "<p>\n                                    Set the [[<a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-type\">type</a>]] internal slot of\n                                    <var>key</var> to <code>\"private\"</code>\n                                  </p>"
                                }
                              ]
                            },
                            {
                              "case": "Otherwise:",
                              "html": "",
                              "rationale": "if",
                              "steps": [
                                {
                                  "html": "<p>\n                                    If <var>jwk</var> does not meet the requirements of Section\n                                    6.3.1 of <a href=\"https://www.w3.org/TR/WebCryptoAPI/#jwa\">JSON Web Algorithms</a>, then <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">throw</a> a <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-DataError\"><code>DataError</code></a>.\n                                  </p>"
                                },
                                {
                                  "html": "<p>\n                                    Let <var>publicKey</var> represent the\n                                    RSA public key identified by interpreting <var>jwk</var>\n                                    according to Section 6.3.1 of <a href=\"https://www.w3.org/TR/WebCryptoAPI/#jwa\"> JSON Web\n                                    Algorithms</a>.\n                                  </p>"
                                },
                                {
                                  "html": "<p>\n                                    If <var>publicKey</var> can be determined to not be a valid RSA public key\n                                    according to <a href=\"https://www.w3.org/TR/WebCryptoAPI/#RFC3447\">RFC 3447</a>,\n                                    then <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">throw</a> a\n                                    <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-DataError\"><code>DataError</code></a>.\n                                  </p>"
                                },
                                {
                                  "html": "<p>\n                                    Let <var>key</var> be a new <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey\">CryptoKey</a> representing <var>publicKey</var>.\n                                  </p>"
                                },
                                {
                                  "html": "<p>\n                                    Set the [[<a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-type\">type</a>]] internal slot of\n                                    <var>key</var> to <code>\"public\"</code>\n                                  </p>"
                                }
                              ]
                            }
                          ]
                        }
                      ]
                    }
                  ]
                },
                {
                  "case": "Otherwise:",
                  "html": "<a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">throw</a> a\n                      <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-NotSupportedError\"><code>NotSupportedError</code></a>."
                }
              ]
            }
          ]
        },
        {
          "html": "<p>\n                    Let <var>algorithm</var> be a new\n                    <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-RsaHashedKeyAlgorithm\">RsaHashedKeyAlgorithm</a>.\n                  </p>"
        },
        {
          "html": "<p>\n                    Set the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-KeyAlgorithm-name\">name</a> attribute of\n                    <var>algorithm</var> to <code>\"RSA-OAEP\"</code>\n                  </p>"
        },
        {
          "html": "<p>\n                    Set the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-RsaKeyAlgorithm-modulusLength\">modulusLength</a>\n                    attribute of <var>algorithm</var> to the length, in bits, of the RSA public\n                    modulus.\n                  </p>"
        },
        {
          "html": "<p>\n                    Set the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-RsaKeyAlgorithm-publicExponent\">publicExponent</a>\n                    attribute of <var>algorithm</var> to the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-BigInteger\">BigInteger</a>\n                    representation of the RSA public exponent.\n                  </p>"
        },
        {
          "html": "<p>\n                    Set the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-RsaHashedKeyAlgorithm-hash\">hash</a> attribute of\n                    <var>algorithm</var> to the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-RsaHashedImportParams-hash\">hash</a> member of\n                    <var>normalizedAlgorithm</var>.\n                  </p>"
        },
        {
          "html": "<p>\n                    Set the [[<a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-algorithm\">algorithm</a>]] internal slot of\n                    <var>key</var> to <var>algorithm</var>\n                  </p>"
        },
        {
          "html": "<p>Return <var>key</var>.</p>"
        }
      ]
    },
    {
      "html": "",
      "rationale": "let",
      "steps": [
        {
          "html": "<p>\n                    Let <var>key</var> be the key to be exported.\n                  </p>"
        },
        {
          "html": "<p>\n                    If the underlying cryptographic key material represented by the [[<a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-handle\">handle</a>]] internal slot of <var>key</var>\n                    cannot be accessed, then <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">throw</a> an <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-OperationError\"><code>OperationError</code></a>.\n                  </p>"
        },
        {
          "html": "<dl class=\"switch\">\n                    <dt>If <var>format</var> is <code>\"spki\"</code></dt>\n                    <dd>\n                      \n                    </dd>\n                    <dt>If <var>format</var> is <code>\"pkcs8\"</code>:</dt>\n                    <dd>\n                      \n                    </dd>\n                    <dt>If <var>format</var> is <code>\"jwk\"</code>:</dt>\n                    <dd>\n                      <ul>\n                        <li>\n                          <p>\n                            Let <var>jwk</var> be a new <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-JsonWebKey\">JsonWebKey</a>\n                            dictionary.\n                          </p>\n                        </li>\n                        <li>\n                          <p>\n                            Set the <code>kty</code> attribute of <var>jwk</var> to the string\n                            <code>\"RSA\"</code>.\n                          </p>\n                        </li>\n                        <li>\n                          <dl class=\"switch\">\n                            <dt>\n                              If the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-KeyAlgorithm-name\">name</a> attribute of the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-RsaHashedKeyAlgorithm\">hash</a> attribute of the [[<a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-algorithm\">algorithm</a>]] internal slot\n                              of <var>key</var> is <code>\"SHA-1\"</code>:\n                            </dt>\n                            <dd>\n                              <p>\n                                Set the <code>alg</code> attribute of <var>jwk</var> to the string\n                                <code>\"RSA-OAEP\"</code>.\n                              </p>\n                            </dd>\n                            <dt>\n                              If the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-KeyAlgorithm-name\">name</a> attribute of the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-RsaHashedKeyAlgorithm\">hash</a> attribute of the [[<a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-algorithm\">algorithm</a>]] internal slot\n                              of <var>key</var> is <code>\"SHA-256\"</code>:\n                            </dt>\n                            <dd>\n                              <p>\n                                Set the <code>alg</code> attribute of <var>jwk</var> to the string\n                                <code>\"RSA-OAEP-256\"</code>.\n                              </p>\n                            </dd>\n                            <dt>\n                              If the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-KeyAlgorithm-name\">name</a> attribute of the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-RsaHashedKeyAlgorithm\">hash</a> attribute of the [[<a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-algorithm\">algorithm</a>]] internal slot\n                              of <var>key</var> is <code>\"SHA-384\"</code>:\n                            </dt>\n                            <dd>\n                              <p>\n                                Set the <code>alg</code> attribute of <var>jwk</var> to the string\n                                <code>\"RSA-OAEP-384\"</code>.\n                              </p>\n                            </dd>\n                            <dt>\n                              If the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-KeyAlgorithm-name\">name</a> attribute of the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-RsaHashedKeyAlgorithm\">hash</a> attribute of the [[<a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-algorithm\">algorithm</a>]] internal slot\n                              of <var>key</var> is <code>\"SHA-512\"</code>:\n                            </dt>\n                            <dd>\n                              <p>\n                                Set the <code>alg</code> attribute of <var>jwk</var> to the string\n                                <code>\"RSA-OAEP-512\"</code>.\n                              </p>\n                            </dd>\n                            <dt>Otherwise:</dt>\n                            <dd>\n                              \n                            </dd>\n                          </dl>\n                        </li>\n                        <li>\n                          <p>\n                            Set the attributes <code>n</code> and <code>e</code> of <var>jwk</var>\n                            according to the corresponding definitions in <a href=\"https://www.w3.org/TR/WebCryptoAPI/#jwa\">JSON Web\n                            Algorithms</a>, Section 6.3.1.\n                          </p>\n                        </li>\n                        <li>\n                          <dl class=\"switch\">\n                            <dt>\n                              If the [[<a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-type\">type</a>]] internal slot\n                              of <var>key</var> is <code>\"private\"</code>:\n                            </dt>\n                            <dd>\n                              \n                            </dd>\n                          </dl>\n                        </li>\n                        <li>\n                          <p>\n                            Set the <code>key_ops</code> attribute of <var>jwk</var> to the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-usages\">usages</a> attribute of <var>key</var>.\n                          </p>\n                        </li>\n                        <li>\n                          <p>\n                            Set the <code>ext</code> attribute of <var>jwk</var> to the [[<a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-extractable\">extractable</a>]] internal slot\n                            of <var>key</var>.\n                          </p>\n                        </li>\n                        <li>\n                          <p>\n                            Let <var>result</var> be the result of converting <var>jwk</var>\n                            to an ECMAScript Object, as defined by [<a href=\"https://www.w3.org/TR/WebCryptoAPI/#WebIDL\">WebIDL</a>].\n                          </p>\n                        </li>\n                      </ul>\n                    </dd>\n                    <dt>Otherwise</dt>\n                    <dd>\n                      <p>\n                        <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">throw</a> a\n                        <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-NotSupportedError\"><code>NotSupportedError</code></a>.\n                      </p>\n                    </dd>\n                  </dl>",
          "rationale": ".switch",
          "steps": [
            {
              "operation": "switch",
              "steps": [
                {
                  "case": "If format is \"spki\"",
                  "html": "",
                  "rationale": "if",
                  "steps": [
                    {
                      "html": "<p>\n                            If the [[<a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-type\">type</a>]] internal slot of\n                            <var>key</var> is not <code>\"public\"</code>, then <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">throw</a> an <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-InvalidAccessError\"><code>InvalidAccessError</code></a>.\n                          </p>"
                    },
                    {
                      "html": "Set the <var>hashAlgorithm</var> field to an instance of\n                                        the <code>HashAlgorithm</code> ASN.1 type with the\n                                        following properties:",
                      "rationale": ".switch",
                      "steps": [
                        {
                          "operation": "switch",
                          "steps": [
                            {
                              "case": "If the name attribute of the hash attribute of the [[algorithm]] internal slot of key is \"SHA-1\":",
                              "html": "<p>\n                                            Set the <var>algorithm</var> object identifier\n                                            of <var>hashAlgorithm</var> to the\n                                            OID <code>id-sha1</code> defined in <a href=\"https://www.w3.org/TR/WebCryptoAPI/#RFC3447\">RFC 3447</a>.\n                                          </p>"
                            },
                            {
                              "case": "If the name attribute of the hash attribute of the [[algorithm]] internal slot of key is \"SHA-256\":",
                              "html": "<p>\n                                            Set the <var>algorithm</var> object identifier\n                                            of <var>hashAlgorithm</var> to the\n                                            OID <code>id-sha256</code> defined in <a href=\"https://www.w3.org/TR/WebCryptoAPI/#RFC3447\">RFC 3447</a>.\n                                          </p>"
                            },
                            {
                              "case": "If the name attribute of the hash attribute of the [[algorithm]] internal slot of key is \"SHA-384\":",
                              "html": "<p>\n                                            Set the <var>algorithm</var> object identifier\n                                            of <var>hashAlgorithm</var> to the\n                                            OID <code>id-sha384</code> defined in <a href=\"https://www.w3.org/TR/WebCryptoAPI/#RFC3447\">RFC 3447</a>.\n                                          </p>"
                            },
                            {
                              "case": "If the name attribute of the hash attribute of the [[algorithm]] internal slot of key is \"SHA-512\":",
                              "html": "<p>\n                                            Set the <var>algorithm</var> object identifier\n                                            of <var>hashAlgorithm</var> to the\n                                            OID <code>id-sha512</code> defined in <a href=\"https://www.w3.org/TR/WebCryptoAPI/#RFC3447\">RFC 3447</a>.\n                                          </p>"
                            },
                            {
                              "case": "Otherwise:",
                              "html": "",
                              "rationale": "perform",
                              "steps": [
                                {
                                  "html": "<p>\n                                                Perform any <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-rsa-pss-extended-export-steps\">key export steps</a>\n                                                defined by <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-applicable-specification\">other applicable\n                                                specifications</a>, passing <var>format</var> and the\n                                                <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-RsaHashedKeyAlgorithm\">hash</a> attribute of\n                                                the [[<a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-algorithm\">algorithm</a>]]\n                                                internal slot of <var>key</var>\n                                                and obtaining <var>hashOid</var> and <var>hashParams</var>.\n                                              </p>"
                                },
                                {
                                  "html": "<p>\n                                                Set the <var>algorithm</var> object identifier\n                                                of <var>hashAlgorithm</var> to <var>hashOid</var>.\n                                              </p>"
                                },
                                {
                                  "html": "<p>\n                                                Set the <var>params</var> field of <var>hashAlgorithm</var>\n                                                to\n                                                <var>hashParams</var> if <var>hashParams</var> is not\n                                                undefined and omit the <var>params</var> field otherwise.\n                                              </p>"
                                }
                              ]
                            }
                          ]
                        }
                      ]
                    },
                    {
                      "html": "<p>\n                            Let <var>result</var> be a new <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-ArrayBuffer\">ArrayBuffer</a> associated with the\n                            <a href=\"https://www.w3.org/TR/html51/webappapis.html#relevant-global-object\">relevant global object</a>\n                            of <code>this</code> [<a href=\"https://www.w3.org/TR/WebCryptoAPI/#HTML\">HTML</a>], and containing\n                            <var>data</var>.\n                          </p>"
                    }
                  ]
                },
                {
                  "case": "If format is \"pkcs8\":",
                  "html": "",
                  "rationale": "if",
                  "steps": [
                    {
                      "html": "<p>\n                            If the [[<a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-type\">type</a>]] internal slot of\n                            <var>key</var> is not <code>\"private\"</code>, then <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">throw</a> an <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-InvalidAccessError\"><code>InvalidAccessError</code></a>.\n                          </p>"
                    },
                    {
                      "html": "Set the <var>hashAlgorithm</var> field to an instance of\n                                        the <code>HashAlgorithm</code> ASN.1 type with the\n                                        following properties:",
                      "rationale": ".switch",
                      "steps": [
                        {
                          "operation": "switch",
                          "steps": [
                            {
                              "case": "If the name attribute of the hash attribute of the [[algorithm]] internal slot of key is \"SHA-1\":",
                              "html": "<p>\n                                            Set the <var>algorithm</var> object identifier\n                                            of <var>hashAlgorithm</var> to the\n                                            OID <code>id-sha1</code> defined in <a href=\"https://www.w3.org/TR/WebCryptoAPI/#RFC3447\">RFC 3447</a>.\n                                          </p>"
                            },
                            {
                              "case": "If the name attribute of the hash attribute of the [[algorithm]] internal slot of key is \"SHA-256\":",
                              "html": "<p>\n                                            Set the <var>algorithm</var> object identifier\n                                            of <var>hashAlgorithm</var> to the\n                                            OID <code>id-sha256</code> defined in <a href=\"https://www.w3.org/TR/WebCryptoAPI/#RFC3447\">RFC 3447</a>.\n                                          </p>"
                            },
                            {
                              "case": "If the name attribute of the hash attribute of the [[algorithm]] internal slot of key is \"SHA-384\":",
                              "html": "<p>\n                                            Set the <var>algorithm</var> object identifier\n                                            of <var>hashAlgorithm</var> to the\n                                            OID <code>id-sha384</code> defined in <a href=\"https://www.w3.org/TR/WebCryptoAPI/#RFC3447\">RFC 3447</a>.\n                                          </p>"
                            },
                            {
                              "case": "If the name attribute of the hash attribute of the [[algorithm]] internal slot of key is \"SHA-512\":",
                              "html": "<p>\n                                            Set the <var>algorithm</var> object identifier\n                                            of <var>hashAlgorithm</var> to the\n                                            OID <code>id-sha512</code> defined in <a href=\"https://www.w3.org/TR/WebCryptoAPI/#RFC3447\">RFC 3447</a>.\n                                          </p>"
                            },
                            {
                              "case": "Otherwise:",
                              "html": "",
                              "rationale": "perform",
                              "steps": [
                                {
                                  "html": "<p>\n                                                Perform any <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-rsa-oaep-extended-export-steps\">key export steps</a>\n                                                defined by <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-applicable-specification\">other applicable\n                                                specifications</a>, passing <var>format</var> and the\n                                                <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-RsaHashedKeyAlgorithm\">hash</a> attribute of\n                                                the [[<a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-algorithm\">algorithm</a>]]\n                                                internal slot of <var>key</var>\n                                                and obtaining <var>hashOid</var> and <var>hashParams</var>.\n                                              </p>"
                                },
                                {
                                  "html": "<p>\n                                                Set the <var>algorithm</var> object identifier\n                                                of <var>hashAlgorithm</var> to <var>hashOid</var>.\n                                              </p>"
                                },
                                {
                                  "html": "<p>\n                                                Set the <var>params</var> field of <var>hashAlgorithm</var>\n                                                to\n                                                <var>hashParams</var> if <var>hashParams</var> is not\n                                                undefined and omit the <var>params</var> field otherwise.\n                                              </p>"
                                }
                              ]
                            }
                          ]
                        }
                      ]
                    },
                    {
                      "html": "<p>\n                            Let <var>result</var> be a new <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-ArrayBuffer\">ArrayBuffer</a> associated with the\n                            <a href=\"https://www.w3.org/TR/html51/webappapis.html#relevant-global-object\">relevant global object</a>\n                            of <code>this</code> [<a href=\"https://www.w3.org/TR/WebCryptoAPI/#HTML\">HTML</a>], and containing\n                            <var>data</var>.\n                          </p>"
                    }
                  ]
                },
                {
                  "case": "If format is \"jwk\":",
                  "html": "<ul>\n                        <li>\n                          <p>\n                            Let <var>jwk</var> be a new <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-JsonWebKey\">JsonWebKey</a>\n                            dictionary.\n                          </p>\n                        </li>\n                        <li>\n                          <p>\n                            Set the <code>kty</code> attribute of <var>jwk</var> to the string\n                            <code>\"RSA\"</code>.\n                          </p>\n                        </li>\n                        <li>\n                          <dl class=\"switch\">\n                            <dt>\n                              If the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-KeyAlgorithm-name\">name</a> attribute of the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-RsaHashedKeyAlgorithm\">hash</a> attribute of the [[<a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-algorithm\">algorithm</a>]] internal slot\n                              of <var>key</var> is <code>\"SHA-1\"</code>:\n                            </dt>\n                            <dd>\n                              <p>\n                                Set the <code>alg</code> attribute of <var>jwk</var> to the string\n                                <code>\"RSA-OAEP\"</code>.\n                              </p>\n                            </dd>\n                            <dt>\n                              If the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-KeyAlgorithm-name\">name</a> attribute of the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-RsaHashedKeyAlgorithm\">hash</a> attribute of the [[<a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-algorithm\">algorithm</a>]] internal slot\n                              of <var>key</var> is <code>\"SHA-256\"</code>:\n                            </dt>\n                            <dd>\n                              <p>\n                                Set the <code>alg</code> attribute of <var>jwk</var> to the string\n                                <code>\"RSA-OAEP-256\"</code>.\n                              </p>\n                            </dd>\n                            <dt>\n                              If the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-KeyAlgorithm-name\">name</a> attribute of the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-RsaHashedKeyAlgorithm\">hash</a> attribute of the [[<a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-algorithm\">algorithm</a>]] internal slot\n                              of <var>key</var> is <code>\"SHA-384\"</code>:\n                            </dt>\n                            <dd>\n                              <p>\n                                Set the <code>alg</code> attribute of <var>jwk</var> to the string\n                                <code>\"RSA-OAEP-384\"</code>.\n                              </p>\n                            </dd>\n                            <dt>\n                              If the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-KeyAlgorithm-name\">name</a> attribute of the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-RsaHashedKeyAlgorithm\">hash</a> attribute of the [[<a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-algorithm\">algorithm</a>]] internal slot\n                              of <var>key</var> is <code>\"SHA-512\"</code>:\n                            </dt>\n                            <dd>\n                              <p>\n                                Set the <code>alg</code> attribute of <var>jwk</var> to the string\n                                <code>\"RSA-OAEP-512\"</code>.\n                              </p>\n                            </dd>\n                            <dt>Otherwise:</dt>\n                            <dd>\n                              \n                            </dd>\n                          </dl>\n                        </li>\n                        <li>\n                          <p>\n                            Set the attributes <code>n</code> and <code>e</code> of <var>jwk</var>\n                            according to the corresponding definitions in <a href=\"https://www.w3.org/TR/WebCryptoAPI/#jwa\">JSON Web\n                            Algorithms</a>, Section 6.3.1.\n                          </p>\n                        </li>\n                        <li>\n                          <dl class=\"switch\">\n                            <dt>\n                              If the [[<a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-type\">type</a>]] internal slot\n                              of <var>key</var> is <code>\"private\"</code>:\n                            </dt>\n                            <dd>\n                              \n                            </dd>\n                          </dl>\n                        </li>\n                        <li>\n                          <p>\n                            Set the <code>key_ops</code> attribute of <var>jwk</var> to the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-usages\">usages</a> attribute of <var>key</var>.\n                          </p>\n                        </li>\n                        <li>\n                          <p>\n                            Set the <code>ext</code> attribute of <var>jwk</var> to the [[<a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-extractable\">extractable</a>]] internal slot\n                            of <var>key</var>.\n                          </p>\n                        </li>\n                        <li>\n                          <p>\n                            Let <var>result</var> be the result of converting <var>jwk</var>\n                            to an ECMAScript Object, as defined by [<a href=\"https://www.w3.org/TR/WebCryptoAPI/#WebIDL\">WebIDL</a>].\n                          </p>\n                        </li>\n                      </ul>",
                  "rationale": ".switch",
                  "steps": [
                    {
                      "operation": "switch",
                      "steps": [
                        {
                          "case": "If the name attribute of the hash attribute of the [[algorithm]] internal slot of key is \"SHA-1\":",
                          "html": "<p>\n                                Set the <code>alg</code> attribute of <var>jwk</var> to the string\n                                <code>\"RSA-OAEP\"</code>.\n                              </p>"
                        },
                        {
                          "case": "If the name attribute of the hash attribute of the [[algorithm]] internal slot of key is \"SHA-256\":",
                          "html": "<p>\n                                Set the <code>alg</code> attribute of <var>jwk</var> to the string\n                                <code>\"RSA-OAEP-256\"</code>.\n                              </p>"
                        },
                        {
                          "case": "If the name attribute of the hash attribute of the [[algorithm]] internal slot of key is \"SHA-384\":",
                          "html": "<p>\n                                Set the <code>alg</code> attribute of <var>jwk</var> to the string\n                                <code>\"RSA-OAEP-384\"</code>.\n                              </p>"
                        },
                        {
                          "case": "If the name attribute of the hash attribute of the [[algorithm]] internal slot of key is \"SHA-512\":",
                          "html": "<p>\n                                Set the <code>alg</code> attribute of <var>jwk</var> to the string\n                                <code>\"RSA-OAEP-512\"</code>.\n                              </p>"
                        },
                        {
                          "case": "Otherwise:",
                          "html": "",
                          "rationale": "perform",
                          "steps": [
                            {
                              "html": "<p>\n                                    Perform any <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-rsa-oaep-extended-export-steps\">key export steps</a>\n                                    defined by <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-applicable-specification\">other applicable\n                                    specifications</a>, passing <var>format</var> and the\n                                    <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-RsaHashedKeyAlgorithm\">hash</a> attribute of\n                                    the [[<a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-algorithm\">algorithm</a>]]\n                                    internal slot of <var>key</var>\n                                    and obtaining <var>alg</var>.\n                                  </p>"
                            },
                            {
                              "html": "<p>\n                                    Set the <code>alg</code> attribute of <var>jwk</var> to <var>alg</var>.\n                                  </p>"
                            }
                          ]
                        }
                      ]
                    }
                  ],
                  "additional": [
                    {
                      "html": "",
                      "rationale": ".switch",
                      "steps": [
                        {
                          "operation": "switch",
                          "steps": [
                            {
                              "case": "If the [[type]] internal slot of key is \"private\":",
                              "html": "",
                              "rationale": "set",
                              "steps": [
                                {
                                  "html": "<p>\n                                    Set the attributes named <code>d</code>, <code>p</code>,\n                                    <code>q</code>, <code>dp</code>, <code>dq</code>, and\n                                    <code>qi</code> of <var>jwk</var> according to the\n                                    corresponding definitions in <a href=\"https://www.w3.org/TR/WebCryptoAPI/#jwa\">JSON Web\n                                    Algorithms</a>, Section 6.3.2.\n                                  </p>"
                                },
                                {
                                  "html": "<p>\n                                    If the underlying RSA private key represented by the [[<a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-handle\">handle</a>]] internal slot\n                                    of <var>key</var> is represented by more than two primes, set\n                                    the attribute named <code>oth</code> of <var>jwk</var>\n                                    according to the corresponding definition in <a href=\"https://www.w3.org/TR/WebCryptoAPI/#jwa\">JSON Web Algorithms</a>, Section 6.3.2.7\n                                  </p>"
                                }
                              ]
                            }
                          ]
                        }
                      ]
                    }
                  ]
                },
                {
                  "case": "Otherwise",
                  "html": "<p>\n                        <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">throw</a> a\n                        <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-NotSupportedError\"><code>NotSupportedError</code></a>.\n                      </p>"
                }
              ]
            }
          ]
        },
        {
          "html": "<p>\n                    Return <var>result</var>.\n                  </p>"
        }
      ]
    },
    {
      "html": "When signing, the following algorithm should be used:",
      "rationale": "if",
      "steps": [
        {
          "html": "<p>\n                    If the [[<a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-type\">type</a>]] internal slot of\n                    <var>key</var> is not <code>\"private\"</code>, then <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">throw</a> an <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-InvalidAccessError\"><code>InvalidAccessError</code></a>.\n                  </p>"
        },
        {
          "html": "<p>\n                    Let <var>hashAlgorithm</var> be the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-EcdsaParams-hash\">hash</a>\n                    member of <var>normalizedAlgorithm</var>.\n                  </p>"
        },
        {
          "html": "<p>\n                    Let <var>M</var> be the result of performing the digest operation specified by\n                    <var>hashAlgorithm</var> using <var>message</var>.\n                  </p>"
        },
        {
          "html": "<p>\n                    Let <var>d</var> be the ECDSA private key associated with <var>key</var>.\n                  </p>"
        },
        {
          "html": "<p>\n                    Let <var>params</var> be the EC domain parameters associated with\n                    <var>key</var>.\n                  </p>"
        },
        {
          "html": "<dl class=\"switch\">\n                    <dt>\n                      If the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-EcKeyAlgorithm-namedCurve\">namedCurve</a> attribute of the\n                      [[<a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-algorithm\">algorithm</a>]] internal slot of\n                      <var>key</var> is <code>\"P-256\"</code>, <code>\"P-384\"</code> or <code>\"P-521\"</code>:\n                    </dt>\n                    <dd>\n                      \n                    </dd>\n                    <dt>\n                      Otherwise, the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-EcKeyAlgorithm-namedCurve\">namedCurve</a> attribute\n                      of the [[<a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-algorithm\">algorithm</a>]] internal slot of\n                      <var>key</var> is a value specified in an\n                      <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-applicable-specification\">applicable specification</a>:\n                    </dt>\n                    <dd>\n                      <p>\n                        Perform the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-ecdsa-extended-signature-steps\">ECDSA signature steps</a>\n                        specified in that specification, passing in <var>M</var>, <var>params</var>\n                        and <var>d</var> and resulting in <var>result</var>.\n                      </p>\n                    </dd>\n                  </dl>",
          "rationale": ".switch",
          "steps": [
            {
              "operation": "switch",
              "steps": [
                {
                  "case": "If the namedCurve attribute of the [[algorithm]] internal slot of key is \"P-256\", \"P-384\" or \"P-521\":",
                  "html": "",
                  "rationale": "perform",
                  "steps": [
                    {
                      "html": "<p>\n                            Perform the ECDSA signing process, as specified in <a href=\"https://www.w3.org/TR/WebCryptoAPI/#RFC6090\">RFC6090</a>,\n                            Section 5.4, with <var>M</var> as the message, using <var>params</var> as the\n                            EC domain parameters, and with <var>d</var> as the private key.\n                          </p>"
                    },
                    {
                      "html": "<p>\n                          Let <var>r</var> and <var>s</var> be the pair of integers resulting from\n                          performing the ECDSA signing process.\n                          </p>"
                    },
                    {
                      "html": "<p>\n                            Let <var>result</var> be a new empty <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-ArrayBuffer\">ArrayBuffer</a> associated with the\n                            <a href=\"https://www.w3.org/TR/html51/webappapis.html#relevant-global-object\">relevant global object</a>\n                            of <code>this</code> [<a href=\"https://www.w3.org/TR/WebCryptoAPI/#HTML\">HTML</a>].\n                          </p>"
                    },
                    {
                      "html": "<p>\n                            Let <var>n</var> be the smallest integer such that <var>n</var> * 8 is greater than\n                            the logarithm to base 2 of the order of the base point of the elliptic curve identified\n                            by <var>params</var>.\n                          </p>"
                    },
                    {
                      "html": "<p>\n                            <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-convert-integer-to-octet-string\">Convert <var>r</var> to an octet string of\n                            length <var>n</var></a> and append this sequence of bytes to <var>result</var>.\n                          </p>"
                    },
                    {
                      "html": "<p>\n                            <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-convert-integer-to-octet-string\">Convert <var>s</var> to an octet string of\n                            length <var>n</var></a> and append this sequence of bytes to <var>result</var>.\n                          </p>"
                    }
                  ]
                },
                {
                  "case": "Otherwise, the namedCurve attribute of the [[algorithm]] internal slot of key is a value specified in an applicable specification:",
                  "html": "<p>\n                        Perform the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-ecdsa-extended-signature-steps\">ECDSA signature steps</a>\n                        specified in that specification, passing in <var>M</var>, <var>params</var>\n                        and <var>d</var> and resulting in <var>result</var>.\n                      </p>"
                }
              ]
            }
          ]
        },
        {
          "html": "<p>\n                    Return a new <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-ArrayBuffer\">ArrayBuffer</a> associated with the\n                    <a href=\"https://www.w3.org/TR/html51/webappapis.html#relevant-global-object\">relevant global object</a>\n                    of <code>this</code> [<a href=\"https://www.w3.org/TR/WebCryptoAPI/#HTML\">HTML</a>], and containing the\n                    bytes of <var>result</var>.\n                  </p>"
        }
      ]
    },
    {
      "html": "When verifying, the following algorithm should be used:",
      "rationale": "if",
      "steps": [
        {
          "html": "<p>\n                    If the [[<a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-type\">type</a>]] internal slot of\n                    <var>key</var> is not <code>\"public\"</code>, then <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">throw</a> an <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-InvalidAccessError\"><code>InvalidAccessError</code></a>.\n                  </p>"
        },
        {
          "html": "<p>\n                    Let <var>hashAlgorithm</var> be the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-EcdsaParams-hash\">hash</a>\n                    member of\n                    <var>normalizedAlgorithm</var>.\n                  </p>"
        },
        {
          "html": "<p>\n                    Let <var>M</var> be the result of performing the digest operation specified by\n                    <var>hashAlgorithm</var> using <var>message</var>.\n                  </p>"
        },
        {
          "html": "<p>\n                    Let <var>Q</var> be the ECDSA public key associated with <var>key</var>.\n                  </p>"
        },
        {
          "html": "<p>\n                    Let <var>params</var> be the EC domain parameters associated with\n                    <var>key</var>.\n                  </p>"
        },
        {
          "html": "<dl class=\"switch\">\n                    <dt>\n                      If the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-EcKeyAlgorithm-namedCurve\">namedCurve</a> attribute of the\n                      [[<a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-algorithm\">algorithm</a>]] internal slot of\n                      <var>key</var> is <code>\"P-256\"</code>, <code>\"P-384\"</code> or <code>\"P-521\"</code>:\n                    </dt>\n                    <dd>\n                      <p>\n                        Perform the ECDSA verifying process, as specified in <a href=\"https://www.w3.org/TR/WebCryptoAPI/#RFC6090\">RFC6090</a>, Section 5.3, with <var>M</var> as the received\n                        message, <var>signature</var> as the received signature and using\n                        <var>params</var> as the EC domain parameters, and \n                        <var>Q</var> as the public key.\n                      </p>\n                    </dd>\n                    <dt>\n                      Otherwise, the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-EcKeyAlgorithm-namedCurve\">namedCurve</a> attribute\n                      of the [[<a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-algorithm\">algorithm</a>]] internal slot of\n                      <var>key</var> is a value specified in an\n                      <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-applicable-specification\">applicable specification</a>:\n                    </dt>\n                    <dd>\n                      <p>\n                        Perform the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-ecdsa-extended-verification-steps\">ECDSA verification steps</a>\n                        specified in that specification passing in <var>M</var>, <var>signature</var>,\n                        <var>params</var> and <var>Q</var> and resulting in an indication of whether\n                        or not the purported signature is valid.\n                      </p>\n                    </dd>\n                  </dl>",
          "rationale": ".switch",
          "steps": [
            {
              "operation": "switch",
              "steps": [
                {
                  "case": "If the namedCurve attribute of the [[algorithm]] internal slot of key is \"P-256\", \"P-384\" or \"P-521\":",
                  "html": "<p>\n                        Perform the ECDSA verifying process, as specified in <a href=\"https://www.w3.org/TR/WebCryptoAPI/#RFC6090\">RFC6090</a>, Section 5.3, with <var>M</var> as the received\n                        message, <var>signature</var> as the received signature and using\n                        <var>params</var> as the EC domain parameters, and \n                        <var>Q</var> as the public key.\n                      </p>"
                },
                {
                  "case": "Otherwise, the namedCurve attribute of the [[algorithm]] internal slot of key is a value specified in an applicable specification:",
                  "html": "<p>\n                        Perform the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-ecdsa-extended-verification-steps\">ECDSA verification steps</a>\n                        specified in that specification passing in <var>M</var>, <var>signature</var>,\n                        <var>params</var> and <var>Q</var> and resulting in an indication of whether\n                        or not the purported signature is valid.\n                      </p>"
                }
              ]
            }
          ]
        },
        {
          "html": "<p>\n                    Let <var>result</var> be a boolean with the value <code>true</code> if the signature is valid\n                    and the value <code>false</code> otherwise.\n                  </p>"
        },
        {
          "html": "<p>\n                    Return <var>result</var>.\n                  </p>"
        }
      ]
    },
    {
      "html": "",
      "rationale": "if",
      "steps": [
        {
          "html": "<p>\n                    If <var>usages</var> contains a value which is not\n                    one of <code>\"sign\"</code> or <code>\"verify\"</code>,\n                    then <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">throw</a> a\n                    <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-SyntaxError\"><code>SyntaxError</code></a>.\n                  </p>"
        },
        {
          "html": "<dl class=\"switch\">\n                    <dt>\n                      If the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-EcKeyGenParams-namedCurve\">namedCurve</a> member of\n                      <var>normalizedAlgorithm</var> is <code>\"P-256\"</code>, <code>\"P-384\"</code>\n                      or <code>\"P-521\"</code>:\n                    </dt>\n                    <dd>\n                      <p>\n                        Generate an Elliptic Curve key pair, as defined in [<a href=\"https://www.w3.org/TR/WebCryptoAPI/#RFC6090\">RFC6090</a>]\n                        with domain parameters for the curve identified by\n                        the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-EcKeyGenParams-namedCurve\">namedCurve</a> member of\n                        <var>normalizedAlgorithm</var>.\n                      </p>\n                    </dd>\n                    <dt>\n                      If the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-EcKeyGenParams-namedCurve\">namedCurve</a> member of\n                      <var>normalizedAlgorithm</var> is a value specified in an\n                      <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-applicable-specification\">applicable specification</a>:\n                    </dt>\n                    <dd>\n                      <p>\n                        Perform the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-ecdsa-extended-generation-steps\">ECDSA key\n                        generation steps</a> specified in that specification, passing in\n                        <var>normalizedAlgorithm</var> and resulting in an elliptic curve key pair.\n                      </p>\n                    </dd>\n                    <dt>Otherwise:</dt>\n                    <dd>\n                      <p>\n                        <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">throw</a> a\n                        <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-OperationError\"><code>NotSupportedError</code></a>\n                      </p>\n                    </dd>\n                  </dl>",
          "rationale": ".switch",
          "steps": [
            {
              "operation": "switch",
              "steps": [
                {
                  "case": "If the namedCurve member of normalizedAlgorithm is \"P-256\", \"P-384\" or \"P-521\":",
                  "html": "<p>\n                        Generate an Elliptic Curve key pair, as defined in [<a href=\"https://www.w3.org/TR/WebCryptoAPI/#RFC6090\">RFC6090</a>]\n                        with domain parameters for the curve identified by\n                        the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-EcKeyGenParams-namedCurve\">namedCurve</a> member of\n                        <var>normalizedAlgorithm</var>.\n                      </p>"
                },
                {
                  "case": "If the namedCurve member of normalizedAlgorithm is a value specified in an applicable specification:",
                  "html": "<p>\n                        Perform the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-ecdsa-extended-generation-steps\">ECDSA key\n                        generation steps</a> specified in that specification, passing in\n                        <var>normalizedAlgorithm</var> and resulting in an elliptic curve key pair.\n                      </p>"
                },
                {
                  "case": "Otherwise:",
                  "html": "<p>\n                        <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">throw</a> a\n                        <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-OperationError\"><code>NotSupportedError</code></a>\n                      </p>"
                }
              ]
            }
          ]
        },
        {
          "html": "<p>\n                    If performing the key generation operation results in an error,\n                    then <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">throw</a> an\n                    <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-OperationError\"><code>OperationError</code></a>.\n                  </p>"
        },
        {
          "html": "<p>\n                    Let <var>algorithm</var> be a new\n                    <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-EcKeyAlgorithm\">EcKeyAlgorithm</a>\n                    object.\n                  </p>"
        },
        {
          "html": "<p>\n                    Set the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-KeyAlgorithm-name\">name</a> attribute of\n                    <var>algorithm</var> to <code>\"ECDSA\"</code>.\n                  </p>"
        },
        {
          "html": "<p>\n                    Set the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-EcKeyAlgorithm-namedCurve\">namedCurve</a>\n                    attribute of <var>algorithm</var> to equal the\n                    <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-EcKeyGenParams\">namedCurve</a> member of\n                    <var>normalizedAlgorithm</var>.\n                  </p>"
        },
        {
          "html": "<p>\n                    Let <var>publicKey</var> be a new <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey\">CryptoKey</a> associated with the\n                    <a href=\"https://www.w3.org/TR/html51/webappapis.html#relevant-global-object\">relevant global object</a>\n                    of <code>this</code> [<a href=\"https://www.w3.org/TR/WebCryptoAPI/#HTML\">HTML</a>], and \n                    representing the public key of the generated key pair.\n                  </p>"
        },
        {
          "html": "<p>\n                    Set the [[<a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-type\">type</a>]] internal slot of\n                    <var>publicKey</var> to <code>\"public\"</code>\n                  </p>"
        },
        {
          "html": "<p>\n                    Set the [[<a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-algorithm\">algorithm</a>]] internal\n                    slot of <var>publicKey</var> to <var>algorithm</var>.\n                  </p>"
        },
        {
          "html": "<p>\n                    Set the [[<a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-extractable\">extractable</a>]] internal\n                    slot of <var>publicKey</var> to true.\n                  </p>"
        },
        {
          "html": "<p>\n                    Set the [[<a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-usages\">usages</a>]] internal slot of\n                    <var>publicKey</var> to be the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-usage-intersection\">usage\n                    intersection</a> of <var>usages</var> and <code>[ \"verify\" ]</code>.\n                  </p>"
        },
        {
          "html": "<p>\n                    Let <var>privateKey</var> be a new <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey\">CryptoKey</a> associated with the\n                    <a href=\"https://www.w3.org/TR/html51/webappapis.html#relevant-global-object\">relevant global object</a>\n                    of <code>this</code> [<a href=\"https://www.w3.org/TR/WebCryptoAPI/#HTML\">HTML</a>], and \n                    representing the private key of the generated key pair.\n                  </p>"
        },
        {
          "html": "<p>\n                    Set the [[<a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-type\">type</a>]] internal slot of\n                    <var>privateKey</var> to <code>\"private\"</code>\n                  </p>"
        },
        {
          "html": "<p>\n                    Set the [[<a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-algorithm\">algorithm</a>]] internal\n                    slot of <var>privateKey</var> to <var>algorithm</var>.\n                  </p>"
        },
        {
          "html": "<p>\n                    Set the [[<a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-extractable\">extractable</a>]] internal\n                    slot of <var>privateKey</var> to <var>extractable</var>.\n                  </p>"
        },
        {
          "html": "<p>\n                    Set the [[<a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-usages\">usages</a>]] internal slot of\n                    <var>privateKey</var> to be the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-usage-intersection\">usage\n                    intersection</a> of <var>usages</var> and <code>[ \"sign\" ]</code>.\n                  </p>"
        },
        {
          "html": "<p>\n                    Let <var>result</var> be a new <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKeyPair\">CryptoKeyPair</a>\n                    dictionary.\n                  </p>"
        },
        {
          "html": "<p>\n                    Set the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKeyPair-publicKey\">publicKey</a> attribute\n                    of <var>result</var> to be <var>publicKey</var>.\n                  </p>"
        },
        {
          "html": "<p>\n                    Set the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKeyPair-privateKey\">privateKey</a> attribute\n                    of <var>result</var> to be <var>privateKey</var>.\n                  </p>"
        },
        {
          "html": "<p>\n                    Return the result of converting <var>result</var> to an ECMAScript Object, as\n                    defined by [<a href=\"https://www.w3.org/TR/WebCryptoAPI/#WebIDL\">WebIDL</a>].\n                  </p>"
        }
      ]
    },
    {
      "html": "",
      "rationale": "let",
      "steps": [
        {
          "html": "<p>Let <var>keyData</var> be the key data to be imported.</p>"
        },
        {
          "html": "<dl class=\"switch\">\n                    <dt>If <var>format</var> is <code>\"spki\"</code>:</dt>\n                    <dd>\n                      \n                    </dd>\n                    <dt>If <var>format</var> is <code>\"pkcs8\"</code>:</dt>\n                    <dd>\n                      \n                    </dd>\n                    <dt>If <var>format</var> is <code>\"jwk\"</code>:</dt>\n                    <dd>\n                      \n                    </dd>\n                    <dt>If <var>format</var> is <code>\"raw\"</code>:</dt>\n                    <dd>\n                      \n                    </dd>\n                    <dt>Otherwise:</dt>\n                    <dd>\n                      <p>\n                        <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">throw</a> a\n                        <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-NotSupportedError\"><code>NotSupportedError</code></a>.\n                      </p>\n                    </dd>\n                  </dl>",
          "rationale": ".switch",
          "steps": [
            {
              "operation": "switch",
              "steps": [
                {
                  "case": "If format is \"spki\":",
                  "html": "",
                  "rationale": "if",
                  "steps": [
                    {
                      "html": "<p>\n                            If <var>usages</var> contains a value which is not\n                            <code>\"verify\"</code>\n                            then <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">throw</a> a\n                            <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-SyntaxError\"><code>SyntaxError</code></a>.\n                          </p>"
                    },
                    {
                      "html": "<p>\n                            Let <var>spki</var> be the result of running the\n                            <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-parse-a-spki\">parse a subjectPublicKeyInfo</a>\n                            algorithm over <var>keyData</var>\n                          </p>"
                    },
                    {
                      "html": "<p>\n                            If an error occurred while parsing,\n                            then <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">throw</a> a\n                            <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-DataError\"><code>DataError</code></a>.\n                          </p>"
                    },
                    {
                      "html": "<p>\n                            If the <code>algorithm</code> object identifier field of the\n                            <code>algorithm</code> AlgorithmIdentifier field of <var>spki</var> is\n                            not equal to the <code>id-ecPublicKey</code>\n                            object identifier defined in <a href=\"https://www.w3.org/TR/WebCryptoAPI/#RFC5480\">RFC 5480</a>,\n                            then <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">throw</a> a\n                            <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-DataError\"><code>DataError</code></a>.\n                          </p>"
                    },
                    {
                      "html": "<p>\n                            If the <code>parameters</code> field of the <code>algorithm</code>\n                            AlgorithmIdentifier field of <var>spki</var> is absent,\n                            then <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">throw</a> a\n                            <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-DataError\"><code>DataError</code></a>.\n                          </p>"
                    },
                    {
                      "html": "<p>\n                            Let <var>params</var> be the <code>parameters</code> field of the\n                            <code>algorithm</code> AlgorithmIdentifier field of <var>spki</var>.\n                          </p>"
                    },
                    {
                      "html": "<p>\n                            If <var>params</var> is not an instance of the\n                            <code>ECParameters</code> ASN.1 type defined in\n                            <a href=\"https://www.w3.org/TR/WebCryptoAPI/#RFC5480\">RFC 5480</a> that specifies a\n                            <code>namedCurve</code>, then <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">throw</a> a <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-DataError\"><code>DataError</code></a>.\n                          </p>"
                    },
                    {
                      "html": "<p>\n                            Let <var>namedCurve</var> be a string whose initial value is\n                            undefined.\n                          </p>"
                    },
                    {
                      "html": "<dl class=\"switch\">\n                            <dt>\n                              If <var>params</var> is equivalent to the <code>secp256r1</code>\n                              object identifier defined in <a href=\"https://www.w3.org/TR/WebCryptoAPI/#RFC5480\">RFC 5480</a>:\n                            </dt>\n                            <dd>\n                              <p>\n                                Set <var>namedCurve</var> <code>\"P-256\"</code>.\n                              </p>\n                            </dd>\n                            <dt>\n                              If <var>params</var> is equivalent to the <code>secp384r1</code>\n                              object identifier defined in <a href=\"https://www.w3.org/TR/WebCryptoAPI/#RFC5480\">RFC 5480</a>:\n                            </dt>\n                            <dd>\n                              <p>\n                                Set <var>namedCurve</var> <code>\"P-384\"</code>.\n                              </p>\n                            </dd>\n                            <dt>\n                              If <var>params</var> is equivalent to the <code>secp521r1</code>\n                              object identifier defined in <a href=\"https://www.w3.org/TR/WebCryptoAPI/#RFC5480\">RFC 5480</a>:\n                            </dt>\n                            <dd>\n                              <p>\n                                Set <var>namedCurve</var> <code>\"P-521\"</code>.\n                              </p>\n                            </dd>\n                          </dl>",
                      "rationale": ".switch",
                      "steps": [
                        {
                          "operation": "switch",
                          "steps": [
                            {
                              "case": "If params is equivalent to the secp256r1 object identifier defined in RFC 5480:",
                              "html": "<p>\n                                Set <var>namedCurve</var> <code>\"P-256\"</code>.\n                              </p>"
                            },
                            {
                              "case": "If params is equivalent to the secp384r1 object identifier defined in RFC 5480:",
                              "html": "<p>\n                                Set <var>namedCurve</var> <code>\"P-384\"</code>.\n                              </p>"
                            },
                            {
                              "case": "If params is equivalent to the secp521r1 object identifier defined in RFC 5480:",
                              "html": "<p>\n                                Set <var>namedCurve</var> <code>\"P-521\"</code>.\n                              </p>"
                            }
                          ]
                        }
                      ]
                    },
                    {
                      "html": "<dl class=\"switch\">\n                            <dt>If <var>namedCurve</var> is not undefined:</dt>\n                            <dd>\n                              \n                            </dd>\n                            <dt>Otherwise:</dt>\n                            <dd>\n                              \n                            </dd>\n                          </dl>",
                      "rationale": ".switch",
                      "steps": [
                        {
                          "operation": "switch",
                          "steps": [
                            {
                              "case": "If namedCurve is not undefined:",
                              "html": "",
                              "rationale": "let",
                              "steps": [
                                {
                                  "html": "<p>\n                                    Let <var>publicKey</var> be the Elliptic Curve public key identified by\n                                    performing the conversion steps defined in Section 2.3.4 of <a href=\"https://www.w3.org/TR/WebCryptoAPI/#SEC1\">SEC 1</a> using the the <code>subjectPublicKey</code>\n                                    field of <var>spki</var>.\n                                  </p>\n                                  <p>\n                                    The uncompressed point format MUST be supported.\n                                  </p>"
                                },
                                {
                                  "html": "<p>\n                                    If the implementation does not support the compressed point format and\n                                    a compressed point is provided,\n                                    <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">throw</a> a\n                                    <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-DataError\"><code>DataError</code></a>.\n                                  </p>"
                                },
                                {
                                  "html": "<p>\n                                    If a decode error occurs or an identity point is found,\n                                    <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">throw</a> a\n                                    <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-DataError\"><code>DataError</code></a>.\n                                  </p>"
                                },
                                {
                                  "html": "<p>\n                                    Let <var>key</var> be a new <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey\">CryptoKey</a> associated with the\n                                    <a href=\"https://www.w3.org/TR/html51/webappapis.html#relevant-global-object\">relevant global object</a>\n                                    of <code>this</code> [<a href=\"https://www.w3.org/TR/WebCryptoAPI/#HTML\">HTML</a>], and\n                                    that represents <var>publicKey</var>.\n                                  </p>"
                                }
                              ]
                            },
                            {
                              "case": "Otherwise:",
                              "html": "",
                              "rationale": "perform",
                              "steps": [
                                {
                                  "html": "<p>\n                                    Perform any <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-ecdsa-extended-import-steps\">key\n                                    import steps</a> defined by\n                                    <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-applicable-specification\">other applicable\n                                    specifications</a>, passing <var>format</var>, <var>spki</var>\n                                    and obtaining <var>namedCurve</var> and <var>key</var>.\n                                  </p>"
                                },
                                {
                                  "html": "<p>\n                                    If an error occured or there are no\n                                    <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-applicable-specification\">applicable\n                                    specifications</a>,\n                                    <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">throw</a> a\n                                    <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-DataError\"><code>DataError</code></a>.\n                                  </p>"
                                }
                              ]
                            }
                          ]
                        }
                      ]
                    },
                    {
                      "html": "<p>\n                            If <var>namedCurve</var> is defined, and not equal to the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-EcKeyImportParams-namedCurve\">namedCurve</a> member of\n                            <var>normalizedAlgorithm</var>, <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">throw</a> a <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-DataError\"><code>DataError</code></a>.\n                          </p>"
                    },
                    {
                      "html": "<p>\n                            If the public key value is not a valid point on the Elliptic Curve\n                            identified by the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-EcKeyImportParams-namedCurve\">namedCurve</a> member of\n                            <var>normalizedAlgorithm</var> <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">throw</a> a <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-DataError\"><code>DataError</code></a>.\n                          </p>"
                    },
                    {
                      "html": "<p>\n                            Set the [[<a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-type\">type</a>]] internal slot\n                            of <var>key</var> to <code>\"public\"</code>\n                          </p>"
                    },
                    {
                      "html": "<p>\n                            Let <var>algorithm</var> be a new <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-EcKeyAlgorithm\">EcKeyAlgorithm</a>.\n                          </p>"
                    },
                    {
                      "html": "<p>\n                            Set the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-KeyAlgorithm-name\">name</a> attribute of\n                            <var>algorithm</var> to <code>\"ECDSA\"</code>.\n                          </p>"
                    },
                    {
                      "html": "<p>\n                            Set the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-EcKeyAlgorithm-namedCurve\">namedCurve</a>\n                            attribute of <var>algorithm</var> to <var>namedCurve</var>.\n                          </p>"
                    },
                    {
                      "html": "<p>\n                            Set the [[<a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-algorithm\">algorithm</a>]]\n                            internal slot of <var>key</var> to <var>algorithm</var>.\n                          </p>"
                    }
                  ]
                },
                {
                  "case": "If format is \"pkcs8\":",
                  "html": "",
                  "rationale": "if",
                  "steps": [
                    {
                      "html": "<p>\n                            If <var>usages</var> contains a value which is not\n                            <code>\"sign\"</code>\n                            then <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">throw</a> a\n                            <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-SyntaxError\"><code>SyntaxError</code></a>.\n                          </p>"
                    },
                    {
                      "html": "<p>\n                            Let <var>privateKeyInfo</var> be the result of running the\n                            <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-parse-a-privateKeyInfo\">parse a privateKeyInfo</a>\n                            algorithm over <var>keyData</var>.\n                          </p>"
                    },
                    {
                      "html": "<p>\n                            If an error occurs while parsing,\n                            then <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">throw</a> a\n                            <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-DataError\"><code>DataError</code></a>.\n                          </p>"
                    },
                    {
                      "html": "<p>\n                            If the <code>algorithm</code> object identifier field of the\n                            <code>privateKeyAlgorithm</code> PrivateKeyAlgorithm field of\n                            <var>privateKeyInfo</var> is not equal to the\n                            <code>id-ecPublicKey</code> object identifier defined in <a href=\"https://www.w3.org/TR/WebCryptoAPI/#RFC5480\">RFC 5480</a>,\n                            then <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">throw</a> a\n                            <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-DataError\"><code>DataError</code></a>.\n                          </p>"
                    },
                    {
                      "html": "<p>\n                            If the <code>parameters</code> field of the\n                            <code>privateKeyAlgorithm</code> PrivateKeyAlgorithmIdentifier field\n                            of <var>privateKeyInfo</var> is not present,\n                            then <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">throw</a> a\n                            <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-DataError\"><code>DataError</code></a>.\n                          </p>"
                    },
                    {
                      "html": "<p>\n                            Let <var>params</var> be the <code>parameters</code> field of the\n                            <code>privateKeyAlgorithm</code> PrivateKeyAlgorithmIdentifier field\n                            of <var>privateKeyInfo</var>.\n                          </p>"
                    },
                    {
                      "html": "<p>\n                            If <var>params</var> is not an instance of the\n                            <code>ECParameters</code> ASN.1 type defined in\n                            <a href=\"https://www.w3.org/TR/WebCryptoAPI/#RFC5480\">RFC 5480</a> that specifies a\n                            <code>namedCurve</code>, then <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">throw</a> a <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-DataError\"><code>DataError</code></a>.\n                          </p>"
                    },
                    {
                      "html": "<p>\n                            Let <var>namedCurve</var> be a string whose initial value is\n                            undefined.\n                          </p>"
                    },
                    {
                      "html": "<dl class=\"switch\">\n                            <dt>\n                              If <var>params</var> is equivalent to the <code>secp256r1</code>\n                              object identifier defined in <a href=\"https://www.w3.org/TR/WebCryptoAPI/#RFC5480\">RFC 5480</a>:\n                            </dt>\n                            <dd>\n                              <p>\n                                Set <var>namedCurve</var> <code>\"P-256\"</code>.\n                              </p>\n                            </dd>\n                            <dt>\n                              If <var>params</var> is equivalent to the <code>secp384r1</code>\n                              object identifier defined in <a href=\"https://www.w3.org/TR/WebCryptoAPI/#RFC5480\">RFC 5480</a>:\n                            </dt>\n                            <dd>\n                              <p>\n                                Set <var>namedCurve</var> <code>\"P-384\"</code>.\n                              </p>\n                            </dd>\n                            <dt>\n                              If <var>params</var> is equivalent to the <code>secp521r1</code>\n                              object identifier defined in <a href=\"https://www.w3.org/TR/WebCryptoAPI/#RFC5480\">RFC 5480</a>:\n                            </dt>\n                            <dd>\n                              <p>\n                                Set <var>namedCurve</var> <code>\"P-521\"</code>.\n                              </p>\n                            </dd>\n                          </dl>",
                      "rationale": ".switch",
                      "steps": [
                        {
                          "operation": "switch",
                          "steps": [
                            {
                              "case": "If params is equivalent to the secp256r1 object identifier defined in RFC 5480:",
                              "html": "<p>\n                                Set <var>namedCurve</var> <code>\"P-256\"</code>.\n                              </p>"
                            },
                            {
                              "case": "If params is equivalent to the secp384r1 object identifier defined in RFC 5480:",
                              "html": "<p>\n                                Set <var>namedCurve</var> <code>\"P-384\"</code>.\n                              </p>"
                            },
                            {
                              "case": "If params is equivalent to the secp521r1 object identifier defined in RFC 5480:",
                              "html": "<p>\n                                Set <var>namedCurve</var> <code>\"P-521\"</code>.\n                              </p>"
                            }
                          ]
                        }
                      ]
                    },
                    {
                      "html": "<dl class=\"switch\">\n                            <dt>If <var>namedCurve</var> is not undefined:</dt>\n                            <dd>\n                              \n                            </dd>\n                            <dt>Otherwise:</dt>\n                            <dd>\n                              \n                            </dd>\n                          </dl>",
                      "rationale": ".switch",
                      "steps": [
                        {
                          "operation": "switch",
                          "steps": [
                            {
                              "case": "If namedCurve is not undefined:",
                              "html": "",
                              "rationale": "let",
                              "steps": [
                                {
                                  "html": "<p>\n                                    Let <var>ecPrivateKey</var> be the result of performing the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-parse-an-asn1-structure\">parse an ASN.1 structure</a>\n                                    algorithm, with <var>data</var> as the <code>privateKey</code> field\n                                    of <var>privateKeyInfo</var>, <var>structure</var> as the ASN.1\n                                    <code>ECPrivateKey</code> structure specified in Section 3 of <a href=\"https://www.w3.org/TR/WebCryptoAPI/#RFC5915\">RFC 5915</a>, and <var>exactData</var> set to true.\n                                  </p>"
                                },
                                {
                                  "html": "<p>\n                                    If an error occurred while parsing,\n                                    then <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">throw</a> a\n                                    <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-DataError\"><code>DataError</code></a>.\n                                  </p>"
                                },
                                {
                                  "html": "<p>\n                                    If the <code>parameters</code> field of <var>ecPrivateKey</var> is\n                                    present, and is not an instance of the <code>namedCurve</code> ASN.1\n                                    type defined in <a href=\"https://www.w3.org/TR/WebCryptoAPI/#RFC5480\">RFC 5480</a>, or does not contain\n                                    the same object identifier as the <code>parameters</code> field of the\n                                    <code>privateKeyAlgorithm</code> PrivateKeyAlgorithmIdentifier field\n                                    of <var>privateKeyInfo</var>,\n                                    then <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">throw</a> a\n                                    <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-DataError\"><code>DataError</code></a>.\n                                  </p>"
                                },
                                {
                                  "html": "<p>\n                                    Let <var>key</var> be a new <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey\">CryptoKey</a> associated with the\n                                    <a href=\"https://www.w3.org/TR/html51/webappapis.html#relevant-global-object\">relevant global object</a>\n                                    of <code>this</code> [<a href=\"https://www.w3.org/TR/WebCryptoAPI/#HTML\">HTML</a>], and\n                                    that represents the Elliptic Curve private key identified by\n                                    performing the conversion steps defined in Section 3 of <a href=\"https://www.w3.org/TR/WebCryptoAPI/#RFC5915\">RFC 5915</a> using <var>ecPrivateKey</var>.\n                                  </p>"
                                }
                              ]
                            },
                            {
                              "case": "Otherwise:",
                              "html": "",
                              "rationale": "perform",
                              "steps": [
                                {
                                  "html": "<p>\n                                    Perform any <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-ecdsa-extended-import-steps\">key\n                                    import steps</a> defined by\n                                    <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-applicable-specification\">other applicable\n                                    specifications</a>, passing <var>format</var>, <var>privateKeyInfo</var>\n                                    and obtaining <var>namedCurve</var> and <var>key</var>.\n                                  </p>"
                                },
                                {
                                  "html": "<p>\n                                    If an error occured or there are no\n                                    <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-applicable-specification\">applicable\n                                    specifications</a>,\n                                    <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">throw</a> a\n                                    <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-DataError\"><code>DataError</code></a>.\n                                  </p>"
                                }
                              ]
                            }
                          ]
                        }
                      ]
                    },
                    {
                      "html": "<p>\n                            If <var>namedCurve</var> is defined, and not equal to the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-EcKeyImportParams-namedCurve\">namedCurve</a> member of\n                            <var>normalizedAlgorithm</var>, <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">throw</a> a <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-DataError\"><code>DataError</code></a>.\n                          </p>"
                    },
                    {
                      "html": "<p>\n                            If the private key value is not a valid point on the Elliptic Curve\n                            identified by the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-EcKeyImportParams-namedCurve\">namedCurve</a> member of\n                            <var>normalizedAlgorithm</var> <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">throw</a> a <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-DataError\"><code>DataError</code></a>.\n                          </p>"
                    },
                    {
                      "html": "<p>\n                            Set the [[<a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-type\">type</a>]] internal slot\n                            of <var>key</var> to <code>\"private\"</code>\n                          </p>"
                    },
                    {
                      "html": "<p>\n                            Let <var>algorithm</var> be a new <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-EcKeyAlgorithm\">EcKeyAlgorithm</a>.\n                          </p>"
                    },
                    {
                      "html": "<p>\n                            Set the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-KeyAlgorithm-name\">name</a> attribute of\n                            <var>algorithm</var> to <code>\"ECDSA\"</code>.\n                          </p>"
                    },
                    {
                      "html": "<p>\n                            Set the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-EcKeyAlgorithm-namedCurve\">namedCurve</a>\n                            attribute of <var>algorithm</var> to <var>namedCurve</var>.\n                          </p>"
                    },
                    {
                      "html": "<p>\n                            Set the [[<a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-algorithm\">algorithm</a>]]\n                            internal slot of <var>key</var> to <var>algorithm</var>.\n                          </p>"
                    }
                  ]
                },
                {
                  "case": "If format is \"jwk\":",
                  "html": "",
                  "rationale": "if",
                  "steps": [
                    {
                      "html": "<dl class=\"switch\">\n                            <dt>If <var>keyData</var> is a <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-JsonWebKey\">JsonWebKey</a> dictionary:</dt>\n                            <dd><p>Let <var>jwk</var> equal <var>keyData</var>.</p></dd>\n                            <dt>Otherwise:</dt>\n                            <dd><p><a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">Throw</a> a <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-DataError\"><code>DataError</code></a>.</p></dd>\n                          </dl>",
                      "rationale": ".switch",
                      "steps": [
                        {
                          "operation": "switch",
                          "steps": [
                            {
                              "case": "If keyData is a JsonWebKey dictionary:",
                              "html": "<p>Let <var>jwk</var> equal <var>keyData</var>.</p>"
                            },
                            {
                              "case": "Otherwise:",
                              "html": "<p><a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">Throw</a> a <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-DataError\"><code>DataError</code></a>.</p>"
                            }
                          ]
                        }
                      ]
                    },
                    {
                      "html": "<p>\n                            If the <code>\"d\"</code> field is present and <var>usages</var> contains\n                            a value which is not\n                            <code>\"sign\"</code>, or,\n                            if the <code>\"d\"</code> field is not present and <var>usages</var> contains\n                            a value which is not\n                            <code>\"verify\"</code>\n                            then <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">throw</a> a\n                            <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-SyntaxError\"><code>SyntaxError</code></a>.\n                          </p>"
                    },
                    {
                      "html": "<p>\n                            If the <code>\"kty\"</code> field of <var>jwk</var> is not\n                            <code>\"EC\"</code>,\n                            then <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">throw</a> a\n                            <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-DataError\"><code>DataError</code></a>.\n                          </p>"
                    },
                    {
                      "html": "<p>\n                            If <var>usages</var> is non-empty and the <code>\"use\"</code> field of <var>jwk</var> is present and is\n                            not  <code>\"sig\"</code>,\n                            then <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">throw</a> a\n                            <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-DataError\"><code>DataError</code></a>.\n                          </p>"
                    },
                    {
                      "html": "<p>\n                            If the <code>\"key_ops\"</code> field of <var>jwk</var> is present, and\n                            is invalid according to the requirements of <a href=\"https://www.w3.org/TR/WebCryptoAPI/#jwk\">JSON Web\n                            Key</a>, or it does not contain all of the specified <var>usages</var>\n                            values,\n                            then <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">throw</a> a\n                            <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-DataError\"><code>DataError</code></a>.\n                          </p>"
                    },
                    {
                      "html": "<p>\n                            If the <code>\"ext\"</code> field of <var>jwk</var> is present and\n                            has the value false and <var>extractable</var> is true,\n                            then <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">throw</a> a\n                            <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-DataError\"><code>DataError</code></a>.\n                          </p>"
                    },
                    {
                      "html": "<p>\n                            Let <var>namedCurve</var> be a string whose value is equal to the\n                            <code>\"crv\"</code> field of <var>jwk</var>.\n                          </p>"
                    },
                    {
                      "html": "<p>\n                            If <var>namedCurve</var> is not equal to the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-EcKeyImportParams-namedCurve\">namedCurve</a> member of\n                            <var>normalizedAlgorithm</var>, <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">throw</a> a <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-DataError\"><code>DataError</code></a>.\n                          </p>"
                    },
                    {
                      "html": "<dl class=\"switch\">\n                            <dt>\n                              If <var>namedCurve</var> is equal to <code>\"P-256\"</code>,\n                              <code>\"P-384\"</code> or <code>\"P-521\"</code>:\n                            </dt>\n                            <dd>\n                              \n                            </dd>\n                            <dt>\n                              Otherwise:\n                            </dt>\n                            <dd>\n                              \n                            </dd>\n                          </dl>",
                      "rationale": ".switch",
                      "steps": [
                        {
                          "operation": "switch",
                          "steps": [
                            {
                              "case": "If namedCurve is equal to \"P-256\", \"P-384\" or \"P-521\":",
                              "html": "",
                              "rationale": "let",
                              "steps": [
                                {
                                  "html": "<p>\n                                    Let <var>algNamedCurve</var> be a string whose initial value is\n                                    undefined.\n                                  </p>"
                                },
                                {
                                  "html": "<dl class=\"switch\">\n                                    <dt>If the <code>\"alg\"</code> field is not present:</dt>\n                                    <dd>\n                                      Let <var>algNamedCurve</var> be undefined.\n                                    </dd>\n                                    <dt>\n                                      If the <code>\"alg\"</code> field is equal to the string \"ES256\":\n                                    </dt>\n                                    <dd>\n                                      Let <var>algNamedCurve</var> be the string <code>\"P-256\"</code>.\n                                    </dd>\n                                    <dt>\n                                      If the <code>\"alg\"</code> field is equal to the string \"ES384\":\n                                    </dt>\n                                    <dd>\n                                      Let <var>algNamedCurve</var> be the string <code>\"P-384\"</code>.\n                                    </dd>\n                                    <dt>\n                                      If the <code>\"alg\"</code> field is equal to the string \"ES512\":\n                                    </dt>\n                                    <dd>\n                                      Let <var>algNamedCurve</var> be the string <code>\"P-521\"</code>.\n                                    </dd>\n                                    <dt>otherwise:</dt>\n                                    <dd>\n                                      <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">throw</a> a\n                                      <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-DataError\"><code>DataError</code></a>.\n                                    </dd>\n                                  </dl>",
                                  "rationale": ".switch",
                                  "steps": [
                                    {
                                      "operation": "switch",
                                      "steps": [
                                        {
                                          "case": "If the \"alg\" field is not present:",
                                          "html": "Let <var>algNamedCurve</var> be undefined."
                                        },
                                        {
                                          "case": "If the \"alg\" field is equal to the string \"ES256\":",
                                          "html": "Let <var>algNamedCurve</var> be the string <code>\"P-256\"</code>."
                                        },
                                        {
                                          "case": "If the \"alg\" field is equal to the string \"ES384\":",
                                          "html": "Let <var>algNamedCurve</var> be the string <code>\"P-384\"</code>."
                                        },
                                        {
                                          "case": "If the \"alg\" field is equal to the string \"ES512\":",
                                          "html": "Let <var>algNamedCurve</var> be the string <code>\"P-521\"</code>."
                                        },
                                        {
                                          "case": "otherwise:",
                                          "html": "<a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">throw</a> a\n                                      <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-DataError\"><code>DataError</code></a>."
                                        }
                                      ]
                                    }
                                  ]
                                },
                                {
                                  "html": "<p>\n                                    If <var>algNamedCurve</var> is defined, and is not equal to\n                                    <var>namedCurve</var>, <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">throw</a> a <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-DataError\"><code>DataError</code></a>.\n                                  </p>"
                                },
                                {
                                  "html": "<dl class=\"switch\">\n                                    <dt>If the <code>\"d\"</code> field is present:</dt>\n                                    <dd>\n                                      \n                                    </dd>\n                                    <dt>Otherwise:</dt>\n                                    <dd>\n                                      \n                                    </dd>\n                                  </dl>",
                                  "rationale": ".switch",
                                  "steps": [
                                    {
                                      "operation": "switch",
                                      "steps": [
                                        {
                                          "case": "If the \"d\" field is present:",
                                          "html": "",
                                          "rationale": "if",
                                          "steps": [
                                            {
                                              "html": "<p>\n                                            If <var>jwk</var> does not meet the requirements of Section\n                                            6.2.2 of <a href=\"https://www.w3.org/TR/WebCryptoAPI/#jwa\">JSON Web Algorithms</a>, then <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">throw</a> a <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-DataError\"><code>DataError</code></a>.\n                                          </p>"
                                            },
                                            {
                                              "html": "<p>\n                                            Let <var>key</var> be a new <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey\">CryptoKey</a> object that represents the\n                                            Elliptic Curve private key identified by interpreting\n                                            <var>jwk</var> according to Section 6.2.2 of <a href=\"https://www.w3.org/TR/WebCryptoAPI/#jwa\">JSON Web Algorithms</a>.\n                                          </p>"
                                            },
                                            {
                                              "html": "<p>\n                                            Set the [[<a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-type\">type</a>]]\n                                            internal slot of <var>Key</var> to <code>\"private\"</code>.\n                                          </p>"
                                            }
                                          ]
                                        },
                                        {
                                          "case": "Otherwise:",
                                          "html": "",
                                          "rationale": "if",
                                          "steps": [
                                            {
                                              "html": "<p>\n                                            If <var>jwk</var> does not meet the requirements of Section\n                                            6.2.1 of <a href=\"https://www.w3.org/TR/WebCryptoAPI/#jwa\">JSON Web Algorithms</a>, then <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">throw</a> a <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-DataError\"><code>DataError</code></a>.\n                                          </p>"
                                            },
                                            {
                                              "html": "<p>\n                                            Let <var>key</var> be a new <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey\">CryptoKey</a> object that represents the\n                                            Elliptic Curve public key identified by interpreting\n                                            <var>jwk</var> according to Section 6.2.1 of <a href=\"https://www.w3.org/TR/WebCryptoAPI/#jwa\">JSON Web Algorithms</a>.\n                                          </p>"
                                            },
                                            {
                                              "html": "<p>\n                                            Set the [[<a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-type\">type</a>]]\n                                            internal slot of <var>Key</var> to <code>\"public\"</code>.\n                                          </p>"
                                            }
                                          ]
                                        }
                                      ]
                                    }
                                  ]
                                }
                              ]
                            },
                            {
                              "case": "Otherwise:",
                              "html": "",
                              "rationale": "perform",
                              "steps": [
                                {
                                  "html": "<p>\n                                    Perform any <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-ecdsa-extended-import-steps\">key\n                                    import steps</a> defined by\n                                    <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-applicable-specification\">other applicable\n                                    specifications</a>, passing <var>format</var>, <var>jwk</var>\n                                    and obtaining <var>key</var>.\n                                  </p>"
                                },
                                {
                                  "html": "<p>\n                                    If an error occured or there are no\n                                    <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-applicable-specification\">applicable\n                                    specifications</a>,\n                                    <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">throw</a> a\n                                    <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-DataError\"><code>DataError</code></a>.\n                                  </p>"
                                }
                              ]
                            }
                          ]
                        }
                      ]
                    },
                    {
                      "html": "<p>\n                            If the key value is not a valid point on the Elliptic Curve\n                            identified by the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-EcKeyImportParams-namedCurve\">namedCurve</a> member of\n                            <var>normalizedAlgorithm</var> <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">throw</a> a <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-DataError\"><code>DataError</code></a>.\n                          </p>"
                    },
                    {
                      "html": "<p>\n                            Let <var>algorithm</var> be a new instance of an <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-EcKeyAlgorithm\">EcKeyAlgorithm</a> object.\n                          </p>"
                    },
                    {
                      "html": "<p>\n                            Set the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-KeyAlgorithm-name\">name</a> attribute of\n                            <var>algorithm</var> to <code>\"ECDSA\"</code>.\n                          </p>"
                    },
                    {
                      "html": "<p>\n                            Set the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-EcKeyAlgorithm-namedCurve\">namedCurve</a>\n                            attribute of <var>algorithm</var> to <var>namedCurve</var>.\n                          </p>"
                    },
                    {
                      "html": "<p>\n                            Set the [[<a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-algorithm\">algorithm</a>]]\n                            internal slot of <var>key</var> to <var>algorithm</var>.\n                          </p>"
                    }
                  ]
                },
                {
                  "case": "If format is \"raw\":",
                  "html": "",
                  "rationale": "if",
                  "steps": [
                    {
                      "html": "<p>\n                            If the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-EcKeyImportParams-namedCurve\">namedCurve</a>\n                            member of <var>normalizedAlgorithm</var> is not a\n                            <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-NamedCurve\">named curve</a>,\n                            then <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">throw</a> a\n                            <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-DataError\"><code>DataError</code></a>.\n                          </p>"
                    },
                    {
                      "html": "<p>\n                            If <var>usages</var> contains a value which is not\n                            <code>\"verify\"</code>\n                            then <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">throw</a> a\n                            <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-SyntaxError\"><code>SyntaxError</code></a>.\n                          </p>"
                    },
                    {
                      "html": "<dl class=\"switch\">\n                            <dt>\n                              If <var>namedCurve</var> is <code>\"P-256\"</code>,\n                              <code>\"P-384\"</code> or <code>\"P-521\"</code>:\n                            </dt>\n                            <dd>\n                              \n                            </dd>\n                            <dt>Otherwise:</dt>\n                            <dd>\n                              \n                            </dd>\n                          </dl>",
                      "rationale": ".switch",
                      "steps": [
                        {
                          "operation": "switch",
                          "steps": [
                            {
                              "case": "If namedCurve is \"P-256\", \"P-384\" or \"P-521\":",
                              "html": "",
                              "rationale": "let",
                              "steps": [
                                {
                                  "html": "<p>\n                                    Let <var>Q</var> be the elliptic curve point on the curve identified\n                                    by the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-EcKeyImportParams-namedCurve\">namedCurve</a>\n                                    member of <var>normalizedAlgorithm</var> identified by performing\n                                    the conversion steps defined in Section 2.3.4 of <a href=\"https://www.w3.org/TR/WebCryptoAPI/#SEC1\">SEC 1</a> on <var>keyData</var>.\n                                  </p>\n                                  <p>\n                                    The uncompressed point format MUST be supported.\n                                  </p>"
                                },
                                {
                                  "html": "<p>\n                                    If the implementation does not support the compressed point format and\n                                    a compressed point is provided,\n                                    <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">throw</a> a\n                                    <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-DataError\"><code>DataError</code></a>.\n                                  </p>"
                                },
                                {
                                  "html": "<p>\n                                    If a decode error occurs or an identity point is found,\n                                    <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">throw</a> a\n                                    <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-DataError\"><code>DataError</code></a>.\n                                  </p>"
                                },
                                {
                                  "html": "<p>\n                                    Let <var>key</var> be a new <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey\">CryptoKey</a> associated with the\n                                    <a href=\"https://www.w3.org/TR/html51/webappapis.html#relevant-global-object\">relevant global object</a>\n                                    of <code>this</code> [<a href=\"https://www.w3.org/TR/WebCryptoAPI/#HTML\">HTML</a>], and\n                                    that represents <var>Q</var>\n                                  </p>"
                                }
                              ]
                            },
                            {
                              "case": "Otherwise:",
                              "html": "",
                              "rationale": "perform",
                              "steps": [
                                {
                                  "html": "<p>\n                                    Perform any <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-ecdh-extended-import-steps\">key\n                                    import steps</a> defined by\n                                    <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-applicable-specification\">other applicable\n                                    specifications</a>, passing <var>format</var>, <var>keyData</var>\n                                    and obtaining <var>key</var>.\n                                  </p>"
                                },
                                {
                                  "html": "<p>\n                                    If an error occured or there are no\n                                    <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-applicable-specification\">applicable\n                                    specifications</a>,\n                                    <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">throw</a> a\n                                    <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-DataError\"><code>DataError</code></a>.\n                                  </p>"
                                }
                              ]
                            }
                          ]
                        }
                      ]
                    },
                    {
                      "html": "<p>\n                            Let <var>algorithm</var> be a new <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-EcKeyAlgorithm\">EcKeyAlgorithm</a> object.\n                          </p>"
                    },
                    {
                      "html": "<p>\n                            Set the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-KeyAlgorithm-name\">name</a> attribute of\n                            <var>algorithm</var> to <code>\"ECDH\"</code>.\n                          </p>"
                    },
                    {
                      "html": "<p>\n                            Set the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-EcKeyAlgorithm-namedCurve\">namedCurve</a>\n                            attribute of <var>algorithm</var> to equal the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-EcKeyImportParams-namedCurve\">namedCurve</a> member of\n                            <var>normalizedAlgorithm</var>.\n                          </p>"
                    },
                    {
                      "html": "<p>\n                            Set the [[<a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-type\">type</a>]] internal slot\n                            of <var>key</var> to <code>\"public\"</code>\n                          </p>"
                    },
                    {
                      "html": "<p>\n                            Set the [[<a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-algorithm\">algorithm</a>]]\n                            internal slot of <var>key</var> to <var>algorithm</var>.\n                          </p>"
                    }
                  ]
                },
                {
                  "case": "Otherwise:",
                  "html": "<p>\n                        <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">throw</a> a\n                        <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-NotSupportedError\"><code>NotSupportedError</code></a>.\n                      </p>"
                }
              ]
            }
          ]
        },
        {
          "html": "<p>\n                    Return <var>key</var>\n                  </p>"
        }
      ]
    },
    {
      "html": "",
      "rationale": "let",
      "steps": [
        {
          "html": "<p>\n                    Let <var>key</var> be the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey\">CryptoKey</a> to be\n                    exported.\n                  </p>"
        },
        {
          "html": "<p>\n                    If the underlying cryptographic key material represented by the [[<a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-handle\">handle</a>]] internal slot of <var>key</var>\n                    cannot be accessed, then <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">throw</a> an <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-OperationError\"><code>OperationError</code></a>.\n                  </p>"
        },
        {
          "html": "<dl class=\"switch\">\n                    <dt>If <var>format</var> is <code>\"spki\"</code>:</dt>\n                    <dd>\n                      \n                    </dd>\n                    <dt>If <var>format</var> is <code>\"pkcs8\"</code>:</dt>\n                    <dd>\n                      \n                    </dd>\n                    <dt>If <var>format</var> is <code>\"jwk\"</code>:</dt>\n                    <dd>\n                      \n                    </dd>\n                    <dt>\n                      If <var>format</var> is <code>\"raw\"</code>:\n                    </dt>\n                    <dd>\n                      \n                    </dd>\n                    <dt>Otherwise:</dt>\n                    <dd>\n                      <p>\n                        <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">throw</a> a\n                        <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-NotSupportedError\"><code>NotSupportedError</code></a>.\n                      </p>\n                    </dd>\n                  </dl>",
          "rationale": ".switch",
          "steps": [
            {
              "operation": "switch",
              "steps": [
                {
                  "case": "If format is \"spki\":",
                  "html": "",
                  "rationale": "if",
                  "steps": [
                    {
                      "html": "<p>\n                            If the [[<a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-type\">type</a>]] internal slot\n                            of <var>key</var> is not <code>\"public\"</code>, then <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">throw</a> an <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-InvalidAccessError\"><code>InvalidAccessError</code></a>.\n                          </p>"
                    },
                    {
                      "html": "Set the <var>parameters</var> field to an instance of the\n                                    <code>ECParameters</code> ASN.1 type defined in\n                                    <a href=\"https://www.w3.org/TR/WebCryptoAPI/#RFC5480\">RFC 5480</a> as follows:",
                      "rationale": ".switch",
                      "steps": [
                        {
                          "operation": "switch",
                          "steps": [
                            {
                              "case": "If the namedCurve attribute of the [[algorithm]] internal slot of key is \"P-256\", \"P-384\" or \"P-521\":",
                              "html": "Let <var>keyData</var> be the\n                                        <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-octet-string\">octet string</a> that\n                                        represents the Elliptic Curve public key represented by the [[<a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-handle\">handle</a>]] internal slot of\n                                        <var>key</var> according to the encoding rules specified in\n                                        Section 2.2 of <a href=\"https://www.w3.org/TR/WebCryptoAPI/#RFC5480\">RFC 5480</a> and using the\n                                        uncompressed form. and <var>keyData</var>.",
                              "rationale": ".switch",
                              "steps": [
                                {
                                  "operation": "switch",
                                  "steps": [
                                    {
                                      "case": "If the namedCurve attribute of the [[algorithm]] internal slot of key is \"P-256\":",
                                      "html": "<p>\n                                            Set <var>parameters</var> to the <code>namedCurve</code> choice\n                                            with value equal to the object identifier\n                                            <code>secp256r1</code> defined in <a href=\"https://www.w3.org/TR/WebCryptoAPI/#RFC5480\">RFC\n                                            5480</a>\n                                          </p>"
                                    },
                                    {
                                      "case": "If the namedCurve attribute of the [[algorithm]] internal slot of key is \"P-384\":",
                                      "html": "<p>\n                                            Set <var>parameters</var> to the <code>namedCurve</code> choice\n                                            with value equal to the object identifier\n                                            <code>secp384r1</code> defined in <a href=\"https://www.w3.org/TR/WebCryptoAPI/#RFC5480\">RFC\n                                            5480</a>\n                                          </p>"
                                    },
                                    {
                                      "case": "If the namedCurve attribute of the [[algorithm]] internal slot of key is \"P-521\":",
                                      "html": "<p>\n                                            Set <var>parameters</var> to the <code>namedCurve</code> choice\n                                            with value equal to the object identifier\n                                            <code>secp521r1</code> defined in <a href=\"https://www.w3.org/TR/WebCryptoAPI/#RFC5480\">RFC\n                                            5480</a>\n                                          </p>"
                                    }
                                  ]
                                }
                              ]
                            },
                            {
                              "case": "Otherwise:",
                              "html": "",
                              "rationale": "perform",
                              "steps": [
                                {
                                  "html": "<p>\n                                            Perform any <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-ecdsa-extended-export-steps\">key export steps</a>\n                                            defined by <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-applicable-specification\">other applicable\n                                            specifications</a>, passing <var>format</var> and the\n                                            <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-EcKeyAlgorithm-namedCurve\">namedCurve</a> attribute of\n                                            the [[<a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-algorithm\">algorithm</a>]]\n                                            internal slot of <var>key</var>\n                                            and obtaining <var>namedCurveOid</var> and <var>keyData</var>.\n                                          </p>"
                                },
                                {
                                  "html": "<p>\n                                            Set <var>parameters</var> to the <code>namedCurve</code> choice\n                                            with value equal to the object identifier <var>namedCurveOid</var>.\n                                          </p>"
                                }
                              ]
                            }
                          ]
                        }
                      ]
                    },
                    {
                      "html": "<p>\n                            Let <var>result</var> be a new <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-ArrayBuffer\">ArrayBuffer</a> associated with the\n                            <a href=\"https://www.w3.org/TR/html51/webappapis.html#relevant-global-object\">relevant global object</a>\n                            of <code>this</code> [<a href=\"https://www.w3.org/TR/WebCryptoAPI/#HTML\">HTML</a>], and containing\n                            <var>data</var>.\n                          </p>"
                    }
                  ]
                },
                {
                  "case": "If format is \"pkcs8\":",
                  "html": "",
                  "rationale": "if",
                  "steps": [
                    {
                      "html": "<p>\n                            If the [[<a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-type\">type</a>]] internal slot\n                            of <var>key</var> is not <code>\"private\"</code>, then <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">throw</a> an <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-InvalidAccessError\"><code>InvalidAccessError</code></a>.\n                          </p>"
                    },
                    {
                      "html": "Set the <var>parameters</var> field to an instance of the\n                                    <code>ECParameters</code> ASN.1 type defined in\n                                    <a href=\"https://www.w3.org/TR/WebCryptoAPI/#RFC5480\">RFC 5480</a> as follows:",
                      "rationale": ".switch",
                      "steps": [
                        {
                          "operation": "switch",
                          "steps": [
                            {
                              "case": "If the namedCurve attribute of the [[algorithm]] internal slot of key is \"P-256\", \"P-384\" or \"P-521\":",
                              "html": "Let <var>keyData</var> be the result of DER-encoding\n                                        an instance of the <code>ECPrivateKey</code> structure defined in\n                                        Section 3 of <a href=\"https://www.w3.org/TR/WebCryptoAPI/#RFC5915\">RFC 5915</a> for the Elliptic\n                                        Curve private key represented by the [[<a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-handle\">handle</a>]] internal slot of\n                                        <var>key</var> and that conforms to the following:",
                              "rationale": ".switch",
                              "steps": [
                                {
                                  "operation": "switch",
                                  "steps": [
                                    {
                                      "case": "If the namedCurve attribute of the [[algorithm]] internal slot of key is \"P-256\":",
                                      "html": "<p>\n                                            Set <var>parameters</var> to the <code>namedCurve</code> choice\n                                            with value equal to the object identifier \n                                            <code>secp256r1</code> defined in <a href=\"https://www.w3.org/TR/WebCryptoAPI/#RFC5480\">RFC\n                                            5480</a>\n                                          </p>"
                                    },
                                    {
                                      "case": "If the namedCurve attribute of the [[algorithm]] internal slot of key is \"P-384\":",
                                      "html": "<p>\n                                            Set <var>parameters</var> to the <code>namedCurve</code> choice\n                                            with value equal to the object identifier\n                                            <code>secp384r1</code> defined in <a href=\"https://www.w3.org/TR/WebCryptoAPI/#RFC5480\">RFC\n                                            5480</a>\n                                          </p>"
                                    },
                                    {
                                      "case": "If the namedCurve attribute of the [[algorithm]] internal slot of key is \"P-521\":",
                                      "html": "<p>\n                                            Set <var>parameters</var> to the <code>namedCurve</code> choice\n                                            with value equal to the object identifier\n                                            <code>secp521r1</code> defined in <a href=\"https://www.w3.org/TR/WebCryptoAPI/#RFC5480\">RFC\n                                            5480</a>\n                                          </p>"
                                    }
                                  ]
                                }
                              ]
                            },
                            {
                              "case": "Otherwise:",
                              "html": "",
                              "rationale": "perform",
                              "steps": [
                                {
                                  "html": "<p>\n                                            Perform any <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-ecdsa-extended-export-steps\">key export steps</a>\n                                            defined by <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-applicable-specification\">other applicable\n                                            specifications</a>, passing <var>format</var> and the\n                                            <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-EcKeyAlgorithm-namedCurve\">namedCurve</a> attribute of\n                                            the [[<a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-algorithm\">algorithm</a>]]\n                                            internal slot of <var>key</var>\n                                            and obtaining <var>namedCurveOid</var> and <var>keyData</var>.\n                                          </p>"
                                },
                                {
                                  "html": "<p>\n                                            Set <var>parameters</var> to the <code>namedCurve</code> choice\n                                            with value equal to the object identifier <var>namedCurveOid</var>.\n                                          </p>"
                                }
                              ]
                            }
                          ]
                        }
                      ]
                    },
                    {
                      "html": "<p>\n                            Let <var>result</var> be a new <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-ArrayBuffer\">ArrayBuffer</a> associated with the\n                            <a href=\"https://www.w3.org/TR/html51/webappapis.html#relevant-global-object\">relevant global object</a>\n                            of <code>this</code> [<a href=\"https://www.w3.org/TR/WebCryptoAPI/#HTML\">HTML</a>], and containing\n                            <var>data</var>.\n                          </p>"
                    }
                  ]
                },
                {
                  "case": "If format is \"jwk\":",
                  "html": "",
                  "rationale": "let",
                  "steps": [
                    {
                      "html": "<p>\n                            Let <var>jwk</var> be a new <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-JsonWebKey\">JsonWebKey</a>\n                            dictionary.\n                          </p>"
                    },
                    {
                      "html": "<p>\n                            Set the <code>kty</code> attribute of <var>jwk</var> to\n                            <code>\"EC\"</code>.\n                          </p>"
                    },
                    {
                      "html": "<dl class=\"switch\">\n                            <dt>\n                              If the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-EcKeyAlgorithm-namedCurve\">namedCurve</a>\n                              attribute of the [[<a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-algorithm\">algorithm</a>]] internal slot\n                              of <var>key</var> is <code>\"P-256\"</code>, <code>\"P-384\"</code> or\n                              <code>\"P-521\"</code>:\n                            </dt>\n                            <dd>\n                              \n                            </dd>\n                            <dt>\n                              Otherwise:\n                            </dt>\n                            <dd>\n                              \n                            </dd>\n                          </dl>",
                      "rationale": ".switch",
                      "steps": [
                        {
                          "operation": "switch",
                          "steps": [
                            {
                              "case": "If the namedCurve attribute of the [[algorithm]] internal slot of key is \"P-256\", \"P-384\" or \"P-521\":",
                              "html": "",
                              "rationale": "if",
                              "steps": [
                                {
                                  "html": "<dl class=\"switch\">\n                                    <dt>\n                                      If the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-EcKeyAlgorithm-namedCurve\">namedCurve</a>\n                                      attribute of the [[<a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-algorithm\">algorithm</a>]] internal slot\n                                      of <var>key</var> is <code>\"P-256\"</code>:\n                                    </dt>\n                                    <dd>\n                                      Set the <code>crv</code> attribute of <var>jwk</var> to\n                                      <code>\"P-256\"</code>\n                                    </dd>\n                                    <dt>\n                                      If the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-EcKeyAlgorithm-namedCurve\">namedCurve</a>\n                                      attribute of the [[<a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-algorithm\">algorithm</a>]] internal slot\n                                      of <var>key</var> is <code>\"P-384\"</code>:\n                                    </dt>\n                                    <dd>\n                                      Set the <code>crv</code> attribute of <var>jwk</var> to\n                                      <code>\"P-384\"</code>\n                                    </dd>\n                                    <dt>\n                                      If the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-EcKeyAlgorithm-namedCurve\">namedCurve</a>\n                                      attribute of the [[<a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-algorithm\">algorithm</a>]] internal slot\n                                      of <var>key</var> is <code>\"P-521\"</code>:\n                                    </dt>\n                                    <dd>\n                                      Set the <code>crv</code> attribute of <var>jwk</var> to\n                                      <code>\"P-521\"</code>\n                                    </dd>\n                                  </dl>",
                                  "rationale": ".switch",
                                  "steps": [
                                    {
                                      "operation": "switch",
                                      "steps": [
                                        {
                                          "case": "If the namedCurve attribute of the [[algorithm]] internal slot of key is \"P-256\":",
                                          "html": "Set the <code>crv</code> attribute of <var>jwk</var> to\n                                      <code>\"P-256\"</code>"
                                        },
                                        {
                                          "case": "If the namedCurve attribute of the [[algorithm]] internal slot of key is \"P-384\":",
                                          "html": "Set the <code>crv</code> attribute of <var>jwk</var> to\n                                      <code>\"P-384\"</code>"
                                        },
                                        {
                                          "case": "If the namedCurve attribute of the [[algorithm]] internal slot of key is \"P-521\":",
                                          "html": "Set the <code>crv</code> attribute of <var>jwk</var> to\n                                      <code>\"P-521\"</code>"
                                        }
                                      ]
                                    }
                                  ]
                                },
                                {
                                  "html": "<p>\n                                    Set the <code>x</code> attribute of <var>jwk</var> according to the\n                                    definition in Section 6.2.1.2 of <a href=\"https://www.w3.org/TR/WebCryptoAPI/#jwa\">JSON Web\n                                    Algorithms</a>.\n                                  </p>"
                                },
                                {
                                  "html": "<p>\n                                    Set the <code>y</code> attribute of <var>jwk</var> according to the\n                                    definition in Section 6.2.1.3 of <a href=\"https://www.w3.org/TR/WebCryptoAPI/#jwa\">JSON Web\n                                    Algorithms</a>.\n                                  </p>"
                                },
                                {
                                  "html": "<dl class=\"switch\">\n                                    <dt>\n                                      If the [[<a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-type\">type</a>]] internal slot\n                                      of <var>key</var> is <code>\"private\"</code>\n                                    </dt>\n                                    <dd>\n                                      <p>\n                                        Set the <code>d</code> attribute of <var>jwk</var> according to\n                                        the definition in Section 6.2.2.1 of <a href=\"https://www.w3.org/TR/WebCryptoAPI/#jwa\">JSON Web\n                                        Algorithms</a>.\n                                      </p>\n                                    </dd>\n                                  </dl>",
                                  "rationale": ".switch",
                                  "steps": [
                                    {
                                      "operation": "switch",
                                      "steps": [
                                        {
                                          "case": "If the [[type]] internal slot of key is \"private\"",
                                          "html": "<p>\n                                        Set the <code>d</code> attribute of <var>jwk</var> according to\n                                        the definition in Section 6.2.2.1 of <a href=\"https://www.w3.org/TR/WebCryptoAPI/#jwa\">JSON Web\n                                        Algorithms</a>.\n                                      </p>"
                                        }
                                      ]
                                    }
                                  ]
                                }
                              ]
                            },
                            {
                              "case": "Otherwise:",
                              "html": "",
                              "rationale": "perform",
                              "steps": [
                                {
                                  "html": "<p>\n                                    Perform any <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-ecdsa-extended-export-steps\">key export steps</a>\n                                    defined by <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-applicable-specification\">other applicable\n                                    specifications</a>, passing <var>format</var> and the\n                                    <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-EcKeyAlgorithm-namedCurve\">namedCurve</a> attribute of\n                                    the [[<a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-algorithm\">algorithm</a>]]\n                                    internal slot of <var>key</var>\n                                    and obtaining <var>namedCurve</var> and a new value of <var>jwk</var>.\n                                  </p>"
                                },
                                {
                                  "html": "<p>\n                                    Set the <code>crv</code> attribute of <var>jwk</var> to\n                                    <var>namedCurve</var>.\n                                  </p>"
                                }
                              ]
                            }
                          ]
                        }
                      ]
                    },
                    {
                      "html": "<p>\n                            Set the <code>key_ops</code> attribute of <var>jwk</var> to the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-usages\">usages</a> attribute of <var>key</var>.\n                          </p>"
                    },
                    {
                      "html": "<p>\n                            Set the <code>ext</code> attribute of <var>jwk</var> to the [[<a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-extractable\">extractable</a>]] internal slot\n                            of <var>key</var>.\n                          </p>"
                    },
                    {
                      "html": "<p>\n                            Let <var>result</var> be the result of converting <var>jwk</var>\n                            to an ECMAScript Object, as defined by [<a href=\"https://www.w3.org/TR/WebCryptoAPI/#WebIDL\">WebIDL</a>].\n                          </p>"
                    }
                  ]
                },
                {
                  "case": "If format is \"raw\":",
                  "html": "",
                  "rationale": "if",
                  "steps": [
                    {
                      "html": "<p>\n                            If the [[<a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-type\">type</a>]] internal slot\n                            of <var>key</var> is not <code>\"public\"</code>, then <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">throw</a> an <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-InvalidAccessError\"><code>InvalidAccessError</code></a>.\n                          </p>"
                    },
                    {
                      "html": "<dl class=\"switch\">\n                            <dt>\n                              If the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-EcKeyAlgorithm-namedCurve\">namedCurve</a>\n                              attribute of the [[<a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-algorithm\">algorithm</a>]] internal slot\n                              of <var>key</var> is <code>\"P-256\"</code>, <code>\"P-384\"</code>\n                              or <code>\"P-521\"</code>:\n                            </dt>\n                            <dd>\n                              <p>\n                                Let <var>data</var> be an <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-octet-string\">octet string</a> representing the Elliptic Curve\n                                point <var>Q</var> represented by [[<a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-handle\">handle</a>]] internal slot of\n                                <var>key</var> according to <a href=\"https://www.w3.org/TR/WebCryptoAPI/#SEC1\">SEC 1</a> 2.3.3 using the uncompressed format.\n                              </p>\n                            </dd>\n                            <dt>Otherwise:</dt>\n                            <dd>\n                              <p>\n                                Perform any <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-ecdh-extended-export-steps\">key export steps</a>\n                                defined by <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-applicable-specification\">other applicable\n                                specifications</a>, passing <var>format</var> and the\n                                <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-EcKeyAlgorithm-namedCurve\">namedCurve</a> attribute of\n                                the [[<a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-algorithm\">algorithm</a>]]\n                                internal slot of <var>key</var>\n                                and obtaining <var>namedCurve</var> and <var>data</var>.\n                              </p>\n                            </dd>\n                          </dl>",
                      "rationale": ".switch",
                      "steps": [
                        {
                          "operation": "switch",
                          "steps": [
                            {
                              "case": "If the namedCurve attribute of the [[algorithm]] internal slot of key is \"P-256\", \"P-384\" or \"P-521\":",
                              "html": "<p>\n                                Let <var>data</var> be an <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-octet-string\">octet string</a> representing the Elliptic Curve\n                                point <var>Q</var> represented by [[<a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-handle\">handle</a>]] internal slot of\n                                <var>key</var> according to <a href=\"https://www.w3.org/TR/WebCryptoAPI/#SEC1\">SEC 1</a> 2.3.3 using the uncompressed format.\n                              </p>"
                            },
                            {
                              "case": "Otherwise:",
                              "html": "<p>\n                                Perform any <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-ecdh-extended-export-steps\">key export steps</a>\n                                defined by <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-applicable-specification\">other applicable\n                                specifications</a>, passing <var>format</var> and the\n                                <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-EcKeyAlgorithm-namedCurve\">namedCurve</a> attribute of\n                                the [[<a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-algorithm\">algorithm</a>]]\n                                internal slot of <var>key</var>\n                                and obtaining <var>namedCurve</var> and <var>data</var>.\n                              </p>"
                            }
                          ]
                        }
                      ]
                    },
                    {
                      "html": "<p>\n                            Let <var>result</var> be a new <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-ArrayBuffer\">ArrayBuffer</a> associated with the\n                            <a href=\"https://www.w3.org/TR/html51/webappapis.html#relevant-global-object\">relevant global object</a>\n                            of <code>this</code> [<a href=\"https://www.w3.org/TR/WebCryptoAPI/#HTML\">HTML</a>], and containing\n                            <var>data</var>.\n                          </p>"
                    }
                  ]
                },
                {
                  "case": "Otherwise:",
                  "html": "<p>\n                        <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">throw</a> a\n                        <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-NotSupportedError\"><code>NotSupportedError</code></a>.\n                      </p>"
                }
              ]
            }
          ]
        },
        {
          "html": "<p>\n                    Return <var>result</var>.\n                  </p>"
        }
      ]
    },
    {
      "html": "",
      "rationale": "if",
      "steps": [
        {
          "html": "<p>\n                    If <var>usages</var> contains an entry which is not\n                    <code>\"deriveKey\"</code> or <code>\"deriveBits\"</code>\n                    then <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">throw</a> a\n                    <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-SyntaxError\"><code>SyntaxError</code></a>.\n                  </p>"
        },
        {
          "html": "<dl class=\"switch\">\n                    <dt>\n                      If the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-EcKeyGenParams-namedCurve\">namedCurve</a> member of\n                      <var>normalizedAlgorithm</var> is <code>\"P-256\"</code>, <code>\"P-384\"</code>\n                      or <code>\"P-521\"</code>:\n                    </dt>\n                    <dd>\n                      <p>\n                        Generate an Elliptic Curve key pair, as defined in [<a href=\"https://www.w3.org/TR/WebCryptoAPI/#RFC6090\">RFC6090</a>] with domain parameters for the curve identified by\n                        the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-EcKeyGenParams-namedCurve\">namedCurve</a> member of\n                        <var>normalizedAlgorithm</var>.\n                      </p>\n                    </dd>\n                    <dt>\n                      If the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-EcKeyGenParams-namedCurve\">namedCurve</a> member of\n                      <var>normalizedAlgorithm</var> is a value specified in an\n                      <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-applicable-specification\">applicable specification</a> that\n                      specifies the use of that value with ECDH:\n                    </dt>\n                    <dd>\n                      <p>\n                        Perform the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-ecdh-extended-generation-steps\">ECDH key\n                        generation steps</a> specified in that specification, passing in\n                        <var>normalizedAlgorithm</var> and resulting in an elliptic curve key pair.\n                      </p>\n                    </dd>\n                    <dt>Otherwise:</dt>\n                    <dd>\n                      <p>\n                        <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">throw</a> a\n                        <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-OperationError\"><code>NotSupportedError</code></a>\n                      </p>\n                    </dd>\n                  </dl>",
          "rationale": ".switch",
          "steps": [
            {
              "operation": "switch",
              "steps": [
                {
                  "case": "If the namedCurve member of normalizedAlgorithm is \"P-256\", \"P-384\" or \"P-521\":",
                  "html": "<p>\n                        Generate an Elliptic Curve key pair, as defined in [<a href=\"https://www.w3.org/TR/WebCryptoAPI/#RFC6090\">RFC6090</a>] with domain parameters for the curve identified by\n                        the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-EcKeyGenParams-namedCurve\">namedCurve</a> member of\n                        <var>normalizedAlgorithm</var>.\n                      </p>"
                },
                {
                  "case": "If the namedCurve member of normalizedAlgorithm is a value specified in an applicable specification that specifies the use of that value with ECDH:",
                  "html": "<p>\n                        Perform the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-ecdh-extended-generation-steps\">ECDH key\n                        generation steps</a> specified in that specification, passing in\n                        <var>normalizedAlgorithm</var> and resulting in an elliptic curve key pair.\n                      </p>"
                },
                {
                  "case": "Otherwise:",
                  "html": "<p>\n                        <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">throw</a> a\n                        <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-OperationError\"><code>NotSupportedError</code></a>\n                      </p>"
                }
              ]
            }
          ]
        },
        {
          "html": "<p>\n                    If performing the operation results in an error,\n                    then <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">throw</a> a\n                    <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-OperationError\"><code>OperationError</code></a>.\n                  </p>"
        },
        {
          "html": "<p>\n                    Let <var>algorithm</var> be a new\n                    <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-EcKeyAlgorithm\">EcKeyAlgorithm</a>\n                    object.\n                  </p>"
        },
        {
          "html": "<p>\n                    Set the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-Algorithm-name\">name</a> member of\n                    <var>algorithm</var> to <code>\"ECDH\"</code>.\n                  </p>"
        },
        {
          "html": "<p>\n                    Set the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-EcKeyAlgorithm-namedCurve\">namedCurve</a>\n                    attribute of <var>algorithm</var> to equal the\n                    <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-EcKeyGenParams\">namedCurve</a> member of\n                    <var>normalizedAlgorithm</var>.\n                  </p>"
        },
        {
          "html": "<p>\n                    Let <var>publicKey</var> be a new <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey\">CryptoKey</a> associated with the\n                    <a href=\"https://www.w3.org/TR/html51/webappapis.html#relevant-global-object\">relevant global object</a>\n                    of <code>this</code> [<a href=\"https://www.w3.org/TR/WebCryptoAPI/#HTML\">HTML</a>], and \n                    representing the public key of the generated key pair.\n                  </p>"
        },
        {
          "html": "<p>\n                    Set the [[<a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-type\">type</a>]] internal slot of\n                    <var>publicKey</var> to <code>\"public\"</code>\n                  </p>"
        },
        {
          "html": "<p>\n                    Set the [[<a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-algorithm\">algorithm</a>]] internal\n                    slot of <var>publicKey</var> to <var>algorithm</var>.\n                  </p>"
        },
        {
          "html": "<p>\n                    Set the [[<a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-extractable\">extractable</a>]] internal\n                    slot of <var>publicKey</var> to true.\n                  </p>"
        },
        {
          "html": "<p>\n                    Set the [[<a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-usages\">usages</a>]] internal slot of\n                    <var>publicKey</var> to be the empty list.\n                  </p>"
        },
        {
          "html": "<p>\n                    Let <var>privateKey</var> be a new <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey\">CryptoKey</a> associated with the\n                    <a href=\"https://www.w3.org/TR/html51/webappapis.html#relevant-global-object\">relevant global object</a>\n                    of <code>this</code> [<a href=\"https://www.w3.org/TR/WebCryptoAPI/#HTML\">HTML</a>], and \n                    representing the private key of the generated key pair.\n                  </p>"
        },
        {
          "html": "<p>\n                    Set the [[<a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-type\">type</a>]] internal slot of\n                    <var>privateKey</var> to <code>\"private\"</code>\n                  </p>"
        },
        {
          "html": "<p>\n                    Set the [[<a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-algorithm\">algorithm</a>]] internal\n                    slot of <var>privateKey</var> to <var>algorithm</var>.\n                  </p>"
        },
        {
          "html": "<p>\n                    Set the [[<a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-extractable\">extractable</a>]] internal\n                    slot of <var>privateKey</var> to <var>extractable</var>.\n                  </p>"
        },
        {
          "html": "<p>\n                    Set the [[<a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-usages\">usages</a>]] internal slot of\n                    <var>privateKey</var> to be the\n                    <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-usage-intersection\">usage intersection</a> of\n                    <var>usages</var> and <code>[ \"deriveKey\", \"deriveBits\" ]</code>.\n                  </p>"
        },
        {
          "html": "<p>\n                    Let <var>result</var> be a new <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKeyPair\">CryptoKeyPair</a>\n                    dictionary.\n                  </p>"
        },
        {
          "html": "<p>\n                    Set the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKeyPair-publicKey\">publicKey</a> attribute\n                    of <var>result</var> to be <var>publicKey</var>.\n                  </p>"
        },
        {
          "html": "<p>\n                    Set the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKeyPair-privateKey\">privateKey</a> attribute\n                    of <var>result</var> to be <var>privateKey</var>.\n                  </p>"
        },
        {
          "html": "<p>\n                    Return the result of converting <var>result</var> to an ECMAScript Object, as\n                    defined by [<a href=\"https://www.w3.org/TR/WebCryptoAPI/#WebIDL\">WebIDL</a>].\n                  </p>"
        }
      ]
    },
    {
      "html": "",
      "rationale": "if",
      "steps": [
        {
          "html": "<p>\n                    If the [[<a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-type\">type</a>]] internal slot of\n                    <var>key</var> is not <code>\"private\"</code>, then <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">throw</a> an <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-InvalidAccessError\"><code>InvalidAccessError</code></a>.\n                  </p>"
        },
        {
          "html": "<p>\n                    Let <var>publicKey</var> be the\n                    <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-EcdhKeyDeriveParams-public\">public</a> member of\n                    <var>normalizedAlgorithm</var>.\n                  </p>"
        },
        {
          "html": "<p>\n                    If the [[<a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-type\">type</a>]] internal slot of\n                    <var>publicKey</var> is not <code>\"public\"</code>, then <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">throw</a> an <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-InvalidAccessError\"><code>InvalidAccessError</code></a>.\n                  </p>"
        },
        {
          "html": "<p>\n                    If the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-KeyAlgorithm-name\">name</a> attribute of\n                    the [[<a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-algorithm\">algorithm</a>]] internal slot of\n                    <var>publicKey</var> is not equal to the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-KeyAlgorithm-name\">name</a> property of the [[<a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-algorithm\">algorithm</a>]] internal slot of\n                    <var>key</var>, then <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">throw</a> an <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-InvalidAccessError\"><code>InvalidAccessError</code></a>.\n                  </p>"
        },
        {
          "html": "<p>\n                    If the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-EcKeyAlgorithm-namedCurve\">namedCurve</a> attribute of\n                    the [[<a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-algorithm\">algorithm</a>]] internal slot of\n                    <var>publicKey</var> is not equal to the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-EcKeyAlgorithm-namedCurve\">namedCurve</a> property of the [[<a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-algorithm\">algorithm</a>]] internal slot of\n                    <var>key</var>, then <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">throw</a> an <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-InvalidAccessError\"><code>InvalidAccessError</code></a>.\n                  </p>"
        },
        {
          "html": "<dl class=\"switch\">\n                    <dt>\n                      If the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-EcKeyAlgorithm-namedCurve\">namedCurve</a> property of the [[<a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-algorithm\">algorithm</a>]] internal slot of\n                    <var>key</var> is <code>\"P-256\"</code>, <code>\"P-384\"</code>\n                      or <code>\"P-521\"</code>:\n                    </dt>\n                    <dd>\n                      \n                    </dd>\n                    <dt>\n                      If the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-EcKeyAlgorithm-namedCurve\">namedCurve</a> property of the [[<a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-algorithm\">algorithm</a>]] internal slot of\n                    <var>key</var> is a value specified in an\n                      <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-applicable-specification\">applicable specification</a> that\n                      specifies the use of that value with ECDH:\n                    </dt>\n                    <dd>\n                      <p>\n                        Perform the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-ecdh-extended-derivation-steps\">ECDH key\n                        derivation steps</a> specified in that specification, passing in\n                        <var>key</var> and <var>publicKey</var> and resulting in <var>secret</var>.\n                      </p>\n                    </dd>\n                    <dt>Otherwise:</dt>\n                    <dd>\n                      <p>\n                        <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">throw</a> a\n                        <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-OperationError\"><code>NotSupportedError</code></a>\n                      </p>\n                    </dd>\n                  </dl>",
          "rationale": ".switch",
          "steps": [
            {
              "operation": "switch",
              "steps": [
                {
                  "case": "If the namedCurve property of the [[algorithm]] internal slot of key is \"P-256\", \"P-384\" or \"P-521\":",
                  "html": "",
                  "rationale": "perform",
                  "steps": [
                    {
                      "html": "<p>\n                            Perform the ECDH primitive specified in <a href=\"https://www.w3.org/TR/WebCryptoAPI/#RFC6090\">RFC6090</a> Section\n                            4 with <var>key</var> as the EC private key <var>d</var> and the EC public\n                            key represented by the [[<a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-handle\">handle</a>]]\n                            internal slot of <var>publicKey</var> as the EC public key.\n                          </p>"
                    },
                    {
                      "html": "<p>\n                            Let <var>secret</var> be the result of applying the field element to\n                            <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-octet-string\">octet string</a> conversion defined in Section\n                            6.2 of <a href=\"https://www.w3.org/TR/WebCryptoAPI/#RFC6090\">RFC6090</a>\n                            to the output of the ECDH primitive.\n                          </p>"
                    }
                  ]
                },
                {
                  "case": "If the namedCurve property of the [[algorithm]] internal slot of key is a value specified in an applicable specification that specifies the use of that value with ECDH:",
                  "html": "<p>\n                        Perform the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-ecdh-extended-derivation-steps\">ECDH key\n                        derivation steps</a> specified in that specification, passing in\n                        <var>key</var> and <var>publicKey</var> and resulting in <var>secret</var>.\n                      </p>"
                },
                {
                  "case": "Otherwise:",
                  "html": "<p>\n                        <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">throw</a> a\n                        <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-OperationError\"><code>NotSupportedError</code></a>\n                      </p>"
                }
              ]
            }
          ]
        },
        {
          "html": "<p>\n                    If performing the operation results in an error,\n                    then <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">throw</a> a\n                    <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-OperationError\"><code>OperationError</code></a>.\n                  </p>"
        },
        {
          "html": "<dl class=\"switch\">\n                    <dt>If <var>length</var> is null:</dt>\n                    <dd>Return <var>secret</var></dd>\n                    <dt>Otherwise:</dt>\n                    <dd>\n                      <dl class=\"switch\">\n                        <dt>\n                          If the length of <var>secret</var> in bits is less than\n                          <var>length</var>:\n                        </dt>\n                        <dd>\n                          <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">throw</a> an\n                          <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-OperationError\"><code>OperationError</code></a>.\n                        </dd>\n                        <dt>Otherwise:</dt>\n                        <dd>\n                          Return an <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-octet-string-containing\">octet string containing</a> the first <var>length</var> bits of <var>secret</var>.\n                        </dd>\n                      </dl>\n                    </dd>\n                  </dl>",
          "rationale": ".switch",
          "steps": [
            {
              "operation": "switch",
              "steps": [
                {
                  "case": "If length is null:",
                  "html": "Return <var>secret</var>"
                },
                {
                  "case": "Otherwise:",
                  "html": "<dl class=\"switch\">\n                        <dt>\n                          If the length of <var>secret</var> in bits is less than\n                          <var>length</var>:\n                        </dt>\n                        <dd>\n                          <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">throw</a> an\n                          <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-OperationError\"><code>OperationError</code></a>.\n                        </dd>\n                        <dt>Otherwise:</dt>\n                        <dd>\n                          Return an <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-octet-string-containing\">octet string containing</a> the first <var>length</var> bits of <var>secret</var>.\n                        </dd>\n                      </dl>",
                  "rationale": ".switch",
                  "steps": [
                    {
                      "operation": "switch",
                      "steps": [
                        {
                          "case": "If the length of secret in bits is less than length:",
                          "html": "<a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">throw</a> an\n                          <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-OperationError\"><code>OperationError</code></a>."
                        },
                        {
                          "case": "Otherwise:",
                          "html": "Return an <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-octet-string-containing\">octet string containing</a> the first <var>length</var> bits of <var>secret</var>."
                        }
                      ]
                    }
                  ]
                }
              ]
            }
          ]
        }
      ]
    },
    {
      "html": "",
      "rationale": "let",
      "steps": [
        {
          "html": "<p>Let <var>keyData</var> be the key data to be imported.</p>"
        },
        {
          "html": "<dl class=\"switch\">\n                    <dt>If <var>format</var> is <code>\"spki\"</code>:</dt>\n                    <dd>\n                      \n                    </dd>\n                    <dt>If <var>format</var> is <code>\"pkcs8\"</code>:</dt>\n                    <dd>\n                      \n                    </dd>\n                    <dt>If <var>format</var> is <code>\"jwk\"</code>:</dt>\n                    <dd>\n                      \n                    </dd>\n                    <dt>If <var>format</var> is <code>\"raw\"</code>:</dt>\n                    <dd>\n                      \n                    </dd>\n                  </dl>",
          "rationale": ".switch",
          "steps": [
            {
              "operation": "switch",
              "steps": [
                {
                  "case": "If format is \"spki\":",
                  "html": "",
                  "rationale": "if",
                  "steps": [
                    {
                      "html": "<p>\n                            If <var>usages</var> is not empty\n                            then <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">throw</a> a\n                            <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-SyntaxError\"><code>SyntaxError</code></a>.\n                          </p>"
                    },
                    {
                      "html": "<p>\n                            Let <var>spki</var> be the result of running the\n                            <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-parse-a-spki\">parse a subjectPublicKeyInfo</a>\n                            algorithm over <var>keyData</var>\n                          </p>"
                    },
                    {
                      "html": "<p>\n                            If an error occurred while parsing,\n                            then <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">throw</a> a\n                            <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-DataError\"><code>DataError</code></a>.\n                          </p>"
                    },
                    {
                      "html": "<p>\n                            If the <code>algorithm</code> object identifier field of the\n                            <code>algorithm</code> AlgorithmIdentifier field of <var>spki</var> is\n                            not equal to the <code>id-ecPublicKey</code> or <code>id-ecDH</code>\n                            object identifiers defined in <a href=\"https://www.w3.org/TR/WebCryptoAPI/#RFC5480\">RFC 5480</a>,\n                            then <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">throw</a> a\n                            <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-DataError\"><code>DataError</code></a>.\n                          </p>"
                    },
                    {
                      "html": "<p>\n                            If the <code>parameters</code> field of the <code>algorithm</code>\n                            AlgorithmIdentifier field of <var>spki</var> is absent,\n                            then <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">throw</a> a\n                            <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-DataError\"><code>DataError</code></a>.\n                          </p>"
                    },
                    {
                      "html": "<p>\n                            Let <var>params</var> be the <code>parameters</code> field of the\n                            <code>algorithm</code> AlgorithmIdentifier field of <var>spki</var>.\n                          </p>"
                    },
                    {
                      "html": "<p>\n                            If <var>params</var> is not an instance of the\n                            <code>ECParameters</code> ASN.1 type defined in\n                            <a href=\"https://www.w3.org/TR/WebCryptoAPI/#RFC5480\">RFC 5480</a> that specifies a\n                            <code>namedCurve</code>, then <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">throw</a> a <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-DataError\"><code>DataError</code></a>.\n                          </p>"
                    },
                    {
                      "html": "<p>\n                            Let <var>namedCurve</var> be a string whose initial value is\n                            undefined.\n                          </p>"
                    },
                    {
                      "html": "<dl class=\"switch\">\n                            <dt>\n                              If <var>params</var> is equivalent to the <code>secp256r1</code>\n                              object identifier defined in <a href=\"https://www.w3.org/TR/WebCryptoAPI/#RFC5480\">RFC 5480</a>:\n                            </dt>\n                            <dd>\n                              <p>\n                                Set <var>namedCurve</var> <code>\"P-256\"</code>.\n                              </p>\n                            </dd>\n                            <dt>\n                              If <var>params</var> is equivalent to the <code>secp384r1</code>\n                              object identifier defined in <a href=\"https://www.w3.org/TR/WebCryptoAPI/#RFC5480\">RFC 5480</a>:\n                            </dt>\n                            <dd>\n                              <p>\n                                Set <var>namedCurve</var> <code>\"P-384\"</code>.\n                              </p>\n                            </dd>\n                            <dt>\n                              If <var>params</var> is equivalent to the <code>secp521r1</code>\n                              object identifier defined in <a href=\"https://www.w3.org/TR/WebCryptoAPI/#RFC5480\">RFC 5480</a>:\n                            </dt>\n                            <dd>\n                              <p>\n                                Set <var>namedCurve</var> <code>\"P-521\"</code>.\n                              </p>\n                            </dd>\n                          </dl>",
                      "rationale": ".switch",
                      "steps": [
                        {
                          "operation": "switch",
                          "steps": [
                            {
                              "case": "If params is equivalent to the secp256r1 object identifier defined in RFC 5480:",
                              "html": "<p>\n                                Set <var>namedCurve</var> <code>\"P-256\"</code>.\n                              </p>"
                            },
                            {
                              "case": "If params is equivalent to the secp384r1 object identifier defined in RFC 5480:",
                              "html": "<p>\n                                Set <var>namedCurve</var> <code>\"P-384\"</code>.\n                              </p>"
                            },
                            {
                              "case": "If params is equivalent to the secp521r1 object identifier defined in RFC 5480:",
                              "html": "<p>\n                                Set <var>namedCurve</var> <code>\"P-521\"</code>.\n                              </p>"
                            }
                          ]
                        }
                      ]
                    },
                    {
                      "html": "<dl class=\"switch\">\n                            <dt>If <var>namedCurve</var> is not undefined:</dt>\n                            <dd>\n                              \n                            </dd>\n                            <dt>Otherwise:</dt>\n                            <dd>\n                              \n                            </dd>\n                          </dl>",
                      "rationale": ".switch",
                      "steps": [
                        {
                          "operation": "switch",
                          "steps": [
                            {
                              "case": "If namedCurve is not undefined:",
                              "html": "",
                              "rationale": "let",
                              "steps": [
                                {
                                  "html": "<p>\n                                    Let <var>publicKey</var> be the Elliptic Curve public key identified by\n                                    performing the conversion steps defined in Section 2.3.4 of <a href=\"https://www.w3.org/TR/WebCryptoAPI/#SEC1\">SEC 1</a> to the <code>subjectPublicKey</code> field of\n                                    <var>spki</var>.\n                                  </p>\n                                  <p>\n                                    The uncompressed point format MUST be supported.\n                                  </p>"
                                },
                                {
                                  "html": "<p>\n                                    If the implementation does not support the compressed point format and\n                                    a compressed point is provided,\n                                    <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">throw</a> a\n                                    <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-DataError\"><code>DataError</code></a>.\n                                  </p>"
                                },
                                {
                                  "html": "<p>\n                                    If a decode error occurs or an identity point is found,\n                                    <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">throw</a> a\n                                    <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-DataError\"><code>DataError</code></a>.\n                                  </p>"
                                },
                                {
                                  "html": "<p>\n                                    Let <var>key</var> be a new <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey\">CryptoKey</a> associated with the\n                                    <a href=\"https://www.w3.org/TR/html51/webappapis.html#relevant-global-object\">relevant global object</a>\n                                    of <code>this</code> [<a href=\"https://www.w3.org/TR/WebCryptoAPI/#HTML\">HTML</a>], and\n                                    that represents <var>publicKey</var>.\n                                  </p>"
                                }
                              ]
                            },
                            {
                              "case": "Otherwise:",
                              "html": "",
                              "rationale": "perform",
                              "steps": [
                                {
                                  "html": "<p>\n                                    Perform any <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-ecdh-extended-import-steps\">key\n                                    import steps</a> defined by\n                                    <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-applicable-specification\">other applicable\n                                    specifications</a>, passing <var>format</var>, <var>spki</var>\n                                    and obtaining <var>namedCurve</var> and <var>key</var>.\n                                  </p>"
                                },
                                {
                                  "html": "<p>\n                                    If an error occured or there are no\n                                    <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-applicable-specification\">applicable\n                                    specifications</a>,\n                                    <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">throw</a> a\n                                    <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-DataError\"><code>DataError</code></a>.\n                                  </p>"
                                }
                              ]
                            }
                          ]
                        }
                      ]
                    },
                    {
                      "html": "<p>\n                            If <var>namedCurve</var> is defined, and not equal to the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-EcKeyImportParams-namedCurve\">namedCurve</a> member of\n                            <var>normalizedAlgorithm</var>, <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">throw</a> a <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-DataError\"><code>DataError</code></a>.\n                          </p>"
                    },
                    {
                      "html": "<p>\n                            If the key value is not a valid point on the Elliptic Curve\n                            identified by the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-EcKeyImportParams-namedCurve\">namedCurve</a> member of\n                            <var>normalizedAlgorithm</var> <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">throw</a> a <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-DataError\"><code>DataError</code></a>.\n                          </p>"
                    },
                    {
                      "html": "<p>\n                            Set the [[<a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-type\">type</a>]] internal slot\n                            of <var>key</var> to <code>\"public\"</code>\n                          </p>"
                    },
                    {
                      "html": "<p>\n                            Let <var>algorithm</var> be a new <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-EcKeyAlgorithm\">EcKeyAlgorithm</a>.\n                          </p>"
                    },
                    {
                      "html": "<p>\n                            Set the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-KeyAlgorithm-name\">name</a> attribute of\n                            <var>algorithm</var> to <code>\"ECDH\"</code>.\n                          </p>"
                    },
                    {
                      "html": "<p>\n                            Set the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-EcKeyAlgorithm-namedCurve\">namedCurve</a>\n                            attribute of <var>algorithm</var> to <var>namedCurve</var>.\n                          </p>"
                    },
                    {
                      "html": "<p>\n                            Set the [[<a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-algorithm\">algorithm</a>]]\n                            internal slot of <var>key</var> to <var>algorithm</var>.\n                          </p>"
                    }
                  ]
                },
                {
                  "case": "If format is \"pkcs8\":",
                  "html": "",
                  "rationale": "if",
                  "steps": [
                    {
                      "html": "<p>\n                            If <var>usages</var> contains an entry which is not\n                            <code>\"deriveKey\"</code> or <code>\"deriveBits\"</code>\n                            then <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">throw</a> a\n                            <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-SyntaxError\"><code>SyntaxError</code></a>.\n                          </p>"
                    },
                    {
                      "html": "<p>\n                            Let <var>privateKeyInfo</var> be the result of running the\n                            <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-parse-a-privateKeyInfo\">parse a privateKeyInfo</a>\n                            algorithm over <var>keyData</var>.\n                          </p>"
                    },
                    {
                      "html": "<p>\n                            If an error occurs while parsing,\n                            <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">throw</a> a\n                            <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-DataError\"><code>DataError</code></a>.\n                          </p>"
                    },
                    {
                      "html": "<p>\n                            If the <code>algorithm</code> object identifier field of the\n                            <code>privateKeyAlgorithm</code> PrivateKeyAlgorithm field of\n                            <var>privateKeyInfo</var> is not equal to the\n                            <code>id-ecPublicKey</code> or <code>id-ecDH</code> object identifiers\n                            defined in <a href=\"https://www.w3.org/TR/WebCryptoAPI/#RFC5480\">RFC 5480</a>,\n                            <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">throw</a> a\n                            <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-DataError\"><code>DataError</code></a>.\n                          </p>"
                    },
                    {
                      "html": "<p>\n                            If the <code>parameters</code> field of the\n                            <code>privateKeyAlgorithm</code> PrivateKeyAlgorithmIdentifier field\n                            of <var>privateKeyInfo</var> is not present,\n                            <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">throw</a> a\n                            <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-DataError\"><code>DataError</code></a>.\n                          </p>"
                    },
                    {
                      "html": "<p>\n                            Let <var>params</var> be the <code>parameters</code> field of the\n                            <code>privateKeyAlgorithm</code> PrivateKeyAlgorithmIdentifier field\n                            of <var>privateKeyInfo</var>.\n                          </p>"
                    },
                    {
                      "html": "<p>\n                            If <var>params</var> is not an instance of the\n                            <code>ECParameters</code> ASN.1 type defined in\n                            <a href=\"https://www.w3.org/TR/WebCryptoAPI/#RFC5480\">RFC 5480</a> that specifies a\n                            <code>namedCurve</code>, then <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">throw</a> a <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-DataError\"><code>DataError</code></a>.\n                          </p>"
                    },
                    {
                      "html": "<p>\n                            Let <var>namedCurve</var> be a string whose initial value is\n                            undefined.\n                          </p>"
                    },
                    {
                      "html": "<dl class=\"switch\">\n                            <dt>\n                              If <var>params</var> is equivalent to the <code>secp256r1</code>\n                              object identifier defined in <a href=\"https://www.w3.org/TR/WebCryptoAPI/#RFC5480\">RFC 5480</a>:\n                            </dt>\n                            <dd>\n                              <p>\n                                Set <var>namedCurve</var> to <code>\"P-256\"</code>.\n                              </p>\n                            </dd>\n                            <dt>\n                              If <var>params</var> is equivalent to the <code>secp384r1</code>\n                              object identifier defined in <a href=\"https://www.w3.org/TR/WebCryptoAPI/#RFC5480\">RFC 5480</a>:\n                            </dt>\n                            <dd>\n                              <p>\n                                Set <var>namedCurve</var> to <code>\"P-384\"</code>.\n                              </p>\n                            </dd>\n                            <dt>\n                              If <var>params</var> is equivalent to the <code>secp521r1</code>\n                              object identifier defined in <a href=\"https://www.w3.org/TR/WebCryptoAPI/#RFC5480\">RFC 5480</a>:\n                            </dt>\n                            <dd>\n                              <p>\n                                Set <var>namedCurve</var> to <code>\"P-521\"</code>.\n                              </p>\n                            </dd>\n                          </dl>",
                      "rationale": ".switch",
                      "steps": [
                        {
                          "operation": "switch",
                          "steps": [
                            {
                              "case": "If params is equivalent to the secp256r1 object identifier defined in RFC 5480:",
                              "html": "<p>\n                                Set <var>namedCurve</var> to <code>\"P-256\"</code>.\n                              </p>"
                            },
                            {
                              "case": "If params is equivalent to the secp384r1 object identifier defined in RFC 5480:",
                              "html": "<p>\n                                Set <var>namedCurve</var> to <code>\"P-384\"</code>.\n                              </p>"
                            },
                            {
                              "case": "If params is equivalent to the secp521r1 object identifier defined in RFC 5480:",
                              "html": "<p>\n                                Set <var>namedCurve</var> to <code>\"P-521\"</code>.\n                              </p>"
                            }
                          ]
                        }
                      ]
                    },
                    {
                      "html": "<dl class=\"switch\">\n                            <dt>If <var>namedCurve</var> is not undefined:</dt>\n                            <dd>\n                              \n                            </dd>\n                            <dt>Otherwise:</dt>\n                            <dd>\n                              \n                            </dd>\n                          </dl>",
                      "rationale": ".switch",
                      "steps": [
                        {
                          "operation": "switch",
                          "steps": [
                            {
                              "case": "If namedCurve is not undefined:",
                              "html": "",
                              "rationale": "let",
                              "steps": [
                                {
                                  "html": "<p>\n                                    Let <var>ecPrivateKey</var> be the result of performing the\n                                    <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-parse-an-asn1-structure\">parse an ASN.1 structure</a>\n                                    algorithm, with <var>data</var> as the <code>privateKey</code> field\n                                    of <var>privateKeyInfo</var>, <var>structure</var> as the ASN.1\n                                    <code>ECPrivateKey</code> structure specified in Section 3 of\n                                    <a href=\"https://www.w3.org/TR/WebCryptoAPI/#RFC5915\">RFC 5915</a>, and <var>exactData</var> set to true.\n                                  </p>"
                                },
                                {
                                  "html": "<p>\n                                    If an error occurred while parsing,\n                                    then <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">throw</a> a\n                                    <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-DataError\"><code>DataError</code></a>.\n                                  </p>"
                                },
                                {
                                  "html": "<p>\n                                    If the <code>parameters</code> field of <var>ecPrivateKey</var> is\n                                    present, and is not an instance of the <code>namedCurve</code> ASN.1\n                                    type defined in <a href=\"https://www.w3.org/TR/WebCryptoAPI/#RFC5480\">RFC 5480</a>, or does not contain\n                                    the same object identifier as the <code>parameters</code> field of the\n                                    <code>privateKeyAlgorithm</code> PrivateKeyAlgorithmIdentifier field\n                                    of <var>privateKeyInfo</var>,\n                                    <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">throw</a> a\n                                    <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-DataError\"><code>DataError</code></a>.\n                                  </p>"
                                },
                                {
                                  "html": "<p>\n                                    Let <var>key</var> be a new <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey\">CryptoKey</a> associated with the\n                                    <a href=\"https://www.w3.org/TR/html51/webappapis.html#relevant-global-object\">relevant global object</a>\n                                    of <code>this</code> [<a href=\"https://www.w3.org/TR/WebCryptoAPI/#HTML\">HTML</a>], and\n                                    that represents the Elliptic Curve private key identified by\n                                    performing the conversion steps defined in Section 3 of <a href=\"https://www.w3.org/TR/WebCryptoAPI/#RFC5915\">RFC 5915</a> using <var>ecPrivateKey</var>.\n                                  </p>"
                                }
                              ]
                            },
                            {
                              "case": "Otherwise:",
                              "html": "",
                              "rationale": "perform",
                              "steps": [
                                {
                                  "html": "<p>\n                                    Perform any <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-ecdh-extended-import-steps\">key\n                                    import steps</a> defined by\n                                    <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-applicable-specification\">other applicable\n                                    specifications</a>, passing <var>format</var>, <var>privateKeyInfo</var>\n                                    and obtaining <var>namedCurve</var> and <var>key</var>.\n                                  </p>"
                                },
                                {
                                  "html": "<p>\n                                    If an error occured or there are no\n                                    <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-applicable-specification\">applicable\n                                    specifications</a>,\n                                    <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">throw</a> a\n                                    <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-DataError\"><code>DataError</code></a>.\n                                  </p>"
                                }
                              ]
                            }
                          ]
                        }
                      ]
                    },
                    {
                      "html": "<p>\n                            If <var>namedCurve</var> is defined, and not equal to the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-EcKeyImportParams-namedCurve\">namedCurve</a> member of\n                            <var>normalizedAlgorithm</var>, <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">throw</a> a <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-DataError\"><code>DataError</code></a>.\n                          </p>"
                    },
                    {
                      "html": "<p>\n                            If the key value is not a valid point on the Elliptic Curve\n                            identified by the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-EcKeyImportParams-namedCurve\">namedCurve</a> member of\n                            <var>normalizedAlgorithm</var> <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">throw</a> a <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-DataError\"><code>DataError</code></a>.\n                          </p>"
                    },
                    {
                      "html": "<p>\n                            Set the [[<a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-type\">type</a>]] internal slot\n                            of <var>key</var> to <code>\"private\"</code>.\n                          </p>"
                    },
                    {
                      "html": "<p>\n                            Let <var>algorithm</var> be a new <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-EcKeyAlgorithm\">EcKeyAlgorithm</a>.\n                          </p>"
                    },
                    {
                      "html": "<p>\n                            Set the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-KeyAlgorithm-name\">name</a> attribute of\n                            <var>algorithm</var> to <code>\"ECDH\"</code>.\n                          </p>"
                    },
                    {
                      "html": "<p>\n                            Set the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-EcKeyAlgorithm-namedCurve\">namedCurve</a>\n                            attribute of <var>algorithm</var> to <var>namedCurve</var>.\n                          </p>"
                    },
                    {
                      "html": "<p>\n                            Set the [[<a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-algorithm\">algorithm</a>]]\n                            internal slot of <var>key</var> to <var>algorithm</var>.\n                          </p>"
                    }
                  ]
                },
                {
                  "case": "If format is \"jwk\":",
                  "html": "",
                  "rationale": "if",
                  "steps": [
                    {
                      "html": "<dl class=\"switch\">\n                            <dt>If <var>keyData</var> is a <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-JsonWebKey\">JsonWebKey</a> dictionary:</dt>\n                            <dd><p>Let <var>jwk</var> equal <var>keyData</var>.</p></dd>\n                            <dt>Otherwise:</dt>\n                            <dd><p><a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">Throw</a> a <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-DataError\"><code>DataError</code></a>.</p></dd>\n                          </dl>",
                      "rationale": ".switch",
                      "steps": [
                        {
                          "operation": "switch",
                          "steps": [
                            {
                              "case": "If keyData is a JsonWebKey dictionary:",
                              "html": "<p>Let <var>jwk</var> equal <var>keyData</var>.</p>"
                            },
                            {
                              "case": "Otherwise:",
                              "html": "<p><a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">Throw</a> a <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-DataError\"><code>DataError</code></a>.</p>"
                            }
                          ]
                        }
                      ]
                    },
                    {
                      "html": "<p>\n                            If the <code>\"d\"</code> field is present and if <var>usages</var>\n                            contains an entry which is not\n                            <code>\"deriveKey\"</code> or <code>\"deriveBits\"</code>\n                            then <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">throw</a> a\n                            <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-SyntaxError\"><code>SyntaxError</code></a>.\n                          </p>"
                    },
                    {
                      "html": "<p>\n                            If the <code>\"d\"</code> field is not present and if <var>usages</var> is not\n                            empty\n                            then <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">throw</a> a\n                            <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-SyntaxError\"><code>SyntaxError</code></a>.\n                          </p>"
                    },
                    {
                      "html": "<p>\n                            If the <code>\"kty\"</code> field of <var>jwk</var> is\n                            not <code>\"EC\"</code>,\n                            then <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">throw</a> a\n                            <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-DataError\"><code>DataError</code></a>.\n                          </p>"
                    },
                    {
                      "html": "<p>\n                            If <var>usages</var> is non-empty and the <code>\"use\"</code> field of <var>jwk</var> is present\n                            and is not equal to <code>\"enc\"</code> then <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">throw</a> a\n                            <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-DataError\"><code>DataError</code></a>.\n                          </p>"
                    },
                    {
                      "html": "<p>\n                            If the <code>\"key_ops\"</code> field of <var>jwk</var> is present, and\n                            is invalid according to the requirements of <a href=\"https://www.w3.org/TR/WebCryptoAPI/#jwk\">JSON Web\n                            Key</a>, or it does not contain all of the specified <var>usages</var>\n                            values, then <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">throw</a> a <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-DataError\"><code>DataError</code></a>.\n                          </p>"
                    },
                    {
                      "html": "<p>\n                            If the <code>\"ext\"</code> field of <var>jwk</var> is present and\n                            has the value false and <var>extractable</var> is true,\n                            then <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">throw</a> a\n                            <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-DataError\"><code>DataError</code></a>.\n                          </p>"
                    },
                    {
                      "html": "<p>\n                            Let <var>namedCurve</var> be a string whose value is equal to the\n                            <code>\"crv\"</code> field of <var>jwk</var>.\n                          </p>"
                    },
                    {
                      "html": "<p>\n                            If <var>namedCurve</var> is not equal to the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-EcKeyImportParams-namedCurve\">namedCurve</a> member of\n                            <var>normalizedAlgorithm</var>, <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">throw</a> a <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-DataError\"><code>DataError</code></a>.\n                          </p>"
                    },
                    {
                      "html": "<dl class=\"switch\">\n                            <dt>\n                              If <var>namedCurve</var> is <code>\"P-256\"</code>,\n                              <code>\"P-384\"</code> or <code>\"P-521\"</code>:\n                            </dt>\n                            <dd>\n                              <dl class=\"switch\">\n                                <dt>If the <code>\"d\"</code> field is present:</dt>\n                                <dd>\n                                  \n                                </dd>\n                                <dt>Otherwise:</dt>\n                                <dd>\n                                  \n                                </dd>\n                              </dl>\n                            </dd>\n                            <dt>Otherwise</dt>\n                            <dd>\n                              \n                            </dd>\n                          </dl>",
                      "rationale": ".switch",
                      "steps": [
                        {
                          "operation": "switch",
                          "steps": [
                            {
                              "case": "If namedCurve is \"P-256\", \"P-384\" or \"P-521\":",
                              "html": "<dl class=\"switch\">\n                                <dt>If the <code>\"d\"</code> field is present:</dt>\n                                <dd>\n                                  \n                                </dd>\n                                <dt>Otherwise:</dt>\n                                <dd>\n                                  \n                                </dd>\n                              </dl>",
                              "rationale": ".switch",
                              "steps": [
                                {
                                  "operation": "switch",
                                  "steps": [
                                    {
                                      "case": "If the \"d\" field is present:",
                                      "html": "",
                                      "rationale": "if",
                                      "steps": [
                                        {
                                          "html": "<p>\n                                        If <var>jwk</var> does not meet the requirements of Section\n                                        6.2.2 of <a href=\"https://www.w3.org/TR/WebCryptoAPI/#jwa\">JSON Web Algorithms</a>, then <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">throw</a> a <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-DataError\"><code>DataError</code></a>.\n                                      </p>"
                                        },
                                        {
                                          "html": "<p>\n                                        Let <var>key</var> be a new <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey\">CryptoKey</a> object that represents the\n                                        Elliptic Curve private key identified by interpreting\n                                        <var>jwk</var> according to Section 6.2.2 of <a href=\"https://www.w3.org/TR/WebCryptoAPI/#jwa\">JSON Web Algorithms</a>.\n                                      </p>"
                                        },
                                        {
                                          "html": "<p>\n                                        Set the [[<a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-type\">type</a>]]\n                                        internal slot of <var>Key</var> to <code>\"private\"</code>.\n                                      </p>"
                                        }
                                      ]
                                    },
                                    {
                                      "case": "Otherwise:",
                                      "html": "",
                                      "rationale": "if",
                                      "steps": [
                                        {
                                          "html": "<p>\n                                        If <var>jwk</var> does not meet the requirements of Section\n                                        6.2.1 of <a href=\"https://www.w3.org/TR/WebCryptoAPI/#jwa\">JSON Web Algorithms</a>, then <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">throw</a> a <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-DataError\"><code>DataError</code></a>.\n                                      </p>"
                                        },
                                        {
                                          "html": "<p>\n                                        Let <var>key</var> be a new <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey\">CryptoKey</a> object that represents the\n                                        Elliptic Curve public key identified by interpreting\n                                        <var>jwk</var> according to Section 6.2.1 of <a href=\"https://www.w3.org/TR/WebCryptoAPI/#jwa\">JSON Web Algorithms</a>.\n                                      </p>"
                                        },
                                        {
                                          "html": "<p>\n                                        Set the [[<a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-type\">type</a>]]\n                                        internal slot of <var>Key</var> to <code>\"public\"</code>.\n                                      </p>"
                                        }
                                      ]
                                    }
                                  ]
                                }
                              ]
                            },
                            {
                              "case": "Otherwise",
                              "html": "",
                              "rationale": "perform",
                              "steps": [
                                {
                                  "html": "<p>\n                                    Perform any <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-ecdh-extended-import-steps\">key\n                                    import steps</a> defined by\n                                    <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-applicable-specification\">other applicable\n                                    specifications</a>, passing <var>format</var>, <var>jwk</var>\n                                    and obtaining <var>key</var>.\n                                  </p>"
                                },
                                {
                                  "html": "<p>\n                                    If an error occured or there are no\n                                    <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-applicable-specification\">applicable\n                                    specifications</a>,\n                                    <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">throw</a> a\n                                    <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-DataError\"><code>DataError</code></a>.\n                                  </p>"
                                }
                              ]
                            }
                          ]
                        }
                      ]
                    },
                    {
                      "html": "<p>\n                            If the key value is not a valid point on the Elliptic Curve\n                            identified by the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-EcKeyImportParams-namedCurve\">namedCurve</a> member of\n                            <var>normalizedAlgorithm</var> <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">throw</a> a <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-DataError\"><code>DataError</code></a>.\n                          </p>"
                    },
                    {
                      "html": "<p>\n                            Let <var>algorithm</var> be a new instance of an <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-EcKeyAlgorithm\">EcKeyAlgorithm</a> object.\n                          </p>"
                    },
                    {
                      "html": "<p>\n                            Set the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-KeyAlgorithm-name\">name</a> attribute of\n                            <var>algorithm</var> to <code>\"ECDH\"</code>.\n                          </p>"
                    },
                    {
                      "html": "<p>\n                            Set the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-EcKeyAlgorithm-namedCurve\">namedCurve</a>\n                            attribute of <var>algorithm</var> to <var>namedCurve</var>.\n                          </p>"
                    },
                    {
                      "html": "<p>\n                            Set the [[<a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-algorithm\">algorithm</a>]]\n                            internal slot of <var>key</var> to <var>algorithm</var>.\n                          </p>"
                    }
                  ]
                },
                {
                  "case": "If format is \"raw\":",
                  "html": "",
                  "rationale": "if",
                  "steps": [
                    {
                      "html": "<p>\n                            If the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-EcKeyImportParams-namedCurve\">namedCurve</a>\n                            member of <var>normalizedAlgorithm</var> is not a\n                            <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-NamedCurve\">named curve</a>,\n                            then <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">throw</a> a\n                            <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-DataError\"><code>DataError</code></a>.\n                          </p>"
                    },
                    {
                      "html": "<p>\n                            If <var>usages</var> is not the empty list,\n                            then <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">throw</a> a\n                            <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-DataError\"><code>SyntaxError</code></a>.\n                          </p>"
                    },
                    {
                      "html": "<dl class=\"switch\">\n                            <dt>\n                              If <var>namedCurve</var> is <code>\"P-256\"</code>,\n                              <code>\"P-384\"</code> or <code>\"P-521\"</code>:\n                            </dt>\n                            <dd>\n                              \n                            </dd>\n                            <dt>Otherwise:</dt>\n                            <dd>\n                              \n                            </dd>\n                          </dl>",
                      "rationale": ".switch",
                      "steps": [
                        {
                          "operation": "switch",
                          "steps": [
                            {
                              "case": "If namedCurve is \"P-256\", \"P-384\" or \"P-521\":",
                              "html": "",
                              "rationale": "let",
                              "steps": [
                                {
                                  "html": "<p>\n                                    Let <var>Q</var> be the Elliptic Curve public key on the curve identified\n                                    by the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-EcKeyImportParams-namedCurve\">namedCurve</a>\n                                    member of <var>normalizedAlgorithm</var> identified by performing\n                                    the conversion steps defined in Section 2.3.4 of <a href=\"https://www.w3.org/TR/WebCryptoAPI/#SEC1\">SEC 1</a> to <var>keyData</var>.\n                                  </p>\n                                  <p>\n                                    The uncompressed point format MUST be supported.\n                                  </p>"
                                },
                                {
                                  "html": "<p>\n                                    If the implementation does not support the compressed point format and\n                                    a compressed point is provided,\n                                    <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">throw</a> a\n                                    <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-DataError\"><code>DataError</code></a>.\n                                  </p>"
                                },
                                {
                                  "html": "<p>\n                                    If a decode error occurs or an identity point is found,\n                                    <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">throw</a> a\n                                    <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-DataError\"><code>DataError</code></a>.\n                                  </p>"
                                },
                                {
                                  "html": "<p>\n                                    Let <var>key</var> be a new <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey\">CryptoKey</a> associated with the\n                                    <a href=\"https://www.w3.org/TR/html51/webappapis.html#relevant-global-object\">relevant global object</a>\n                                    of <code>this</code> [<a href=\"https://www.w3.org/TR/WebCryptoAPI/#HTML\">HTML</a>], and\n                                    that represents <var>Q</var>.\n                                  </p>"
                                }
                              ]
                            },
                            {
                              "case": "Otherwise:",
                              "html": "",
                              "rationale": "perform",
                              "steps": [
                                {
                                  "html": "<p>\n                                    Perform any <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-ecdh-extended-import-steps\">key\n                                    import steps</a> defined by\n                                    <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-applicable-specification\">other applicable\n                                    specifications</a>, passing <var>format</var>, <var>keyData</var>\n                                    and obtaining <var>key</var>.\n                                  </p>"
                                },
                                {
                                  "html": "<p>\n                                    If an error occured or there are no\n                                    <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-applicable-specification\">applicable\n                                    specifications</a>,\n                                    <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">throw</a> a\n                                    <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-DataError\"><code>DataError</code></a>.\n                                  </p>"
                                }
                              ]
                            }
                          ]
                        }
                      ]
                    },
                    {
                      "html": "<p>\n                            Let <var>algorithm</var> be a new <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-EcKeyAlgorithm\">EcKeyAlgorithm</a> object.\n                          </p>"
                    },
                    {
                      "html": "<p>\n                            Set the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-KeyAlgorithm-name\">name</a> attribute of\n                            <var>algorithm</var> to <code>\"ECDH\"</code>.\n                          </p>"
                    },
                    {
                      "html": "<p>\n                            Set the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-EcKeyAlgorithm-namedCurve\">namedCurve</a>\n                            attribute of <var>algorithm</var> to equal the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-EcKeyImportParams-namedCurve\">namedCurve</a> member of\n                            <var>normalizedAlgorithm</var>.\n                          </p>"
                    },
                    {
                      "html": "<p>\n                            Set the [[<a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-type\">type</a>]] internal slot\n                            of <var>key</var> to <code>\"public\"</code>\n                          </p>"
                    },
                    {
                      "html": "<p>\n                            Set the [[<a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-algorithm\">algorithm</a>]]\n                            internal slot of <var>key</var> to <var>algorithm</var>.\n                          </p>"
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "html": "<p>\n                    Return <var>key</var>\n                  </p>"
        }
      ]
    },
    {
      "html": "",
      "rationale": "let",
      "steps": [
        {
          "html": "<p>\n                    Let <var>key</var> be the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey\">CryptoKey</a> to be\n                    exported.\n                  </p>"
        },
        {
          "html": "<p>\n                    If the underlying cryptographic key material represented by the [[<a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-handle\">handle</a>]] internal slot of <var>key</var>\n                    cannot be accessed, then <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">throw</a> an <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-OperationError\"><code>OperationError</code></a>.\n                  </p>"
        },
        {
          "html": "<dl class=\"switch\">\n                    <dt>If <var>format</var> is <code>\"spki\"</code>:</dt>\n                    <dd>\n                      \n                    </dd>\n                    <dt>If <var>format</var> is <code>\"pkcs8\"</code>:</dt>\n                    <dd>\n                      \n                    </dd>\n                    <dt>If <var>format</var> is <code>\"jwk\"</code>:</dt>\n                    <dd>\n                      \n                    </dd>\n                    <dt>\n                      If <var>format</var> is <code>\"raw\"</code>:\n                    </dt>\n                    <dd>\n                      \n                    </dd>\n                  </dl>",
          "rationale": ".switch",
          "steps": [
            {
              "operation": "switch",
              "steps": [
                {
                  "case": "If format is \"spki\":",
                  "html": "",
                  "rationale": "if",
                  "steps": [
                    {
                      "html": "<p>\n                            If the [[<a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-type\">type</a>]] internal slot\n                            of <var>key</var> is not <code>\"public\"</code>, then <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">throw</a> an <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-InvalidAccessError\"><code>InvalidAccessError</code></a>.\n                          </p>"
                    },
                    {
                      "html": "Set the <var>parameters</var> field to an instance of the\n                                    <code>ECParameters</code> ASN.1 type defined in\n                                    <a href=\"https://www.w3.org/TR/WebCryptoAPI/#RFC5480\">RFC 5480</a> as follows:",
                      "rationale": ".switch",
                      "steps": [
                        {
                          "operation": "switch",
                          "steps": [
                            {
                              "case": "If the namedCurve attribute of the [[algorithm]] internal slot of key is \"P-256\", \"P-384\" or \"P-521\":",
                              "html": "Let <var>keyData</var> be the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-octet-string\">octet string</a> that\n                                        represents the Elliptic Curve public key represented by the [[<a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-handle\">handle</a>]] internal slot of\n                                        <var>key</var> according to the encoding rules specified in\n                                        Section 2.3.3 of <a href=\"https://www.w3.org/TR/WebCryptoAPI/#SEC1\">SEC 1</a> and using the\n                                        uncompressed form.",
                              "rationale": ".switch",
                              "steps": [
                                {
                                  "operation": "switch",
                                  "steps": [
                                    {
                                      "case": "If the namedCurve attribute of the [[algorithm]] internal slot of key is \"P-256\":",
                                      "html": "<p>\n                                            Set <var>parameters</var> to the <var>namedCurve</var> choice\n                                            with value equal to the object identifier\n                                            <code>secp256r1</code> defined in <a href=\"https://www.w3.org/TR/WebCryptoAPI/#RFC5480\">RFC\n                                            5480</a>\n                                          </p>"
                                    },
                                    {
                                      "case": "If the namedCurve attribute of the [[algorithm]] internal slot of key is \"P-384\":",
                                      "html": "<p>\n                                            Set <var>parameters</var> to the <var>namedCurve</var> choice\n                                            with value equal to the object identifier\n                                            <code>secp384r1</code> defined in <a href=\"https://www.w3.org/TR/WebCryptoAPI/#RFC5480\">RFC\n                                            5480</a>\n                                          </p>"
                                    },
                                    {
                                      "case": "If the namedCurve attribute of the [[algorithm]] internal slot of key is \"P-521\":",
                                      "html": "<p>\n                                            Set <var>parameters</var> to the <var>namedCurve</var> choice\n                                            with value equal to the object identifier\n                                            <code>secp521r1</code> defined in <a href=\"https://www.w3.org/TR/WebCryptoAPI/#RFC5480\">RFC\n                                            5480</a>\n                                          </p>"
                                    }
                                  ]
                                }
                              ]
                            },
                            {
                              "case": "Otherwise:",
                              "html": "",
                              "rationale": "perform",
                              "steps": [
                                {
                                  "html": "<p>\n                                            Perform any <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-ecdh-extended-export-steps\">key export steps</a>\n                                            defined by <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-applicable-specification\">other applicable\n                                            specifications</a>, passing <var>format</var> and the\n                                            <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-EcKeyAlgorithm-namedCurve\">namedCurve</a> attribute of\n                                            the [[<a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-algorithm\">algorithm</a>]]\n                                            internal slot of <var>key</var>\n                                            and obtaining <var>namedCurveOid</var> and <var>keyData</var>.\n                                          </p>"
                                },
                                {
                                  "html": "<p>\n                                            Set <var>parameters</var> to the <code>namedCurve</code> choice\n                                            with value equal to the object identifier <var>namedCurveOid</var>.\n                                          </p>"
                                }
                              ]
                            }
                          ]
                        }
                      ]
                    }
                  ]
                },
                {
                  "case": "If format is \"pkcs8\":",
                  "html": "",
                  "rationale": "if",
                  "steps": [
                    {
                      "html": "<p>\n                            If the [[<a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-type\">type</a>]] internal slot\n                            of <var>key</var> is not <code>\"private\"</code>, then <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">throw</a> an <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-InvalidAccessError\"><code>InvalidAccessError</code></a>.\n                          </p>"
                    },
                    {
                      "html": "Set the <var>parameters</var> field to an instance of the\n                                    <code>ECParameters</code> ASN.1 type defined in\n                                    <a href=\"https://www.w3.org/TR/WebCryptoAPI/#RFC5480\">RFC 5480</a> as follows:",
                      "rationale": ".switch",
                      "steps": [
                        {
                          "operation": "switch",
                          "steps": [
                            {
                              "case": "If the namedCurve attribute of the [[algorithm]] internal slot of key is \"P-256\", \"P-384\" or \"P-521\":",
                              "html": "Let <var>keyData</var> be the result of DER-encoding\n                                        an instance of the <code>ECPrivateKey</code> structure defined in\n                                        Section 3 of <a href=\"https://www.w3.org/TR/WebCryptoAPI/#RFC5915\">RFC 5915</a> for the Elliptic\n                                        Curve private key represented by the [[<a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-handle\">handle</a>]] internal slot of\n                                        <var>key</var> and that conforms to the following:",
                              "rationale": ".switch",
                              "steps": [
                                {
                                  "operation": "switch",
                                  "steps": [
                                    {
                                      "case": "If the namedCurve attribute of the [[algorithm]] internal slot of key is \"P-256\":",
                                      "html": "<p>\n                                            Set <var>parameters</var> to the <var>namedCurve</var> choice\n                                            with value equal to the object identifier\n                                            <code>secp256r1</code> defined in <a href=\"https://www.w3.org/TR/WebCryptoAPI/#RFC5480\">RFC\n                                            5480</a>\n                                          </p>"
                                    },
                                    {
                                      "case": "If the namedCurve attribute of the [[algorithm]] internal slot of key is \"P-384\":",
                                      "html": "<p>\n                                            Set <var>parameters</var> to the <var>namedCurve</var> choice\n                                            with value equal to the object identifier\n                                            <code>secp384r1</code> defined in <a href=\"https://www.w3.org/TR/WebCryptoAPI/#RFC5480\">RFC\n                                            5480</a>\n                                          </p>"
                                    },
                                    {
                                      "case": "If the namedCurve attribute of the [[algorithm]] internal slot of key is \"P-521\":",
                                      "html": "<p>\n                                            Set <var>parameters</var> to the <var>namedCurve</var> choice\n                                            with value equal to the object identifier\n                                            <code>secp521r1</code> defined in <a href=\"https://www.w3.org/TR/WebCryptoAPI/#RFC5480\">RFC\n                                            5480</a>\n                                          </p>"
                                    }
                                  ]
                                }
                              ]
                            },
                            {
                              "case": "Otherwise:",
                              "html": "",
                              "rationale": "perform",
                              "steps": [
                                {
                                  "html": "<p>\n                                            Perform any <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-ecdh-extended-export-steps\">key export steps</a>\n                                            defined by <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-applicable-specification\">other applicable\n                                            specifications</a>, passing <var>format</var> and the\n                                            <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-EcKeyAlgorithm-namedCurve\">namedCurve</a> attribute of\n                                            the [[<a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-algorithm\">algorithm</a>]]\n                                            internal slot of <var>key</var>\n                                            and obtaining <var>namedCurveOid</var> and <var>keyData</var>.\n                                          </p>"
                                },
                                {
                                  "html": "<p>\n                                            Set <var>parameters</var> to the <code>namedCurve</code> choice\n                                            with value equal to the object identifier <var>namedCurveOid</var>.\n                                          </p>"
                                }
                              ]
                            }
                          ]
                        }
                      ]
                    }
                  ]
                },
                {
                  "case": "If format is \"jwk\":",
                  "html": "",
                  "rationale": "let",
                  "steps": [
                    {
                      "html": "<p>\n                            Let <var>jwk</var> be a new <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-JsonWebKey\">JsonWebKey</a>\n                            dictionary.\n                          </p>"
                    },
                    {
                      "html": "<p>\n                            Set the <code>kty</code> attribute of <var>jwk</var> to\n                            <code>\"EC\"</code>.\n                          </p>"
                    },
                    {
                      "html": "<dl class=\"switch\">\n                            <dt>\n                              If the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-EcKeyAlgorithm-namedCurve\">namedCurve</a>\n                              attribute of the [[<a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-algorithm\">algorithm</a>]] internal slot\n                              of <var>key</var> is <code>\"P-256\"</code>, <code>\"P-384\"</code>\n                              or <code>\"P-521\"</code>:\n                            </dt>\n                            <dd>\n                              \n                            </dd>\n                            <dt>\n                              Otherwise:\n                            </dt>\n                            <dd>\n                              \n                            </dd>\n                          </dl>",
                      "rationale": ".switch",
                      "steps": [
                        {
                          "operation": "switch",
                          "steps": [
                            {
                              "case": "If the namedCurve attribute of the [[algorithm]] internal slot of key is \"P-256\", \"P-384\" or \"P-521\":",
                              "html": "",
                              "rationale": "if",
                              "steps": [
                                {
                                  "html": "<dl class=\"switch\">\n                                    <dt>\n                                      If the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-EcKeyAlgorithm-namedCurve\">namedCurve</a>\n                                      attribute of the [[<a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-algorithm\">algorithm</a>]] internal slot\n                                      of <var>key</var> is <code>\"P-256\"</code>:\n                                    </dt>\n                                    <dd>\n                                      Set the <code>crv</code> attribute of <var>jwk</var> to\n                                      <code>\"P-256\"</code>\n                                    </dd>\n                                    <dt>\n                                      If the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-EcKeyAlgorithm-namedCurve\">namedCurve</a>\n                                      attribute of the [[<a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-algorithm\">algorithm</a>]] internal slot\n                                      of <var>key</var> is <code>\"P-384\"</code>:\n                                    </dt>\n                                    <dd>\n                                      Set the <code>crv</code> attribute of <var>jwk</var> to\n                                      <code>\"P-384\"</code>\n                                    </dd>\n                                    <dt>\n                                      If the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-EcKeyAlgorithm-namedCurve\">namedCurve</a>\n                                      attribute of the [[<a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-algorithm\">algorithm</a>]] internal slot\n                                      of <var>key</var> is <code>\"P-521\"</code>:\n                                    </dt>\n                                    <dd>\n                                      Set the <code>crv</code> attribute of <var>jwk</var> to\n                                      <code>\"P-521\"</code>\n                                    </dd>\n                                  </dl>",
                                  "rationale": ".switch",
                                  "steps": [
                                    {
                                      "operation": "switch",
                                      "steps": [
                                        {
                                          "case": "If the namedCurve attribute of the [[algorithm]] internal slot of key is \"P-256\":",
                                          "html": "Set the <code>crv</code> attribute of <var>jwk</var> to\n                                      <code>\"P-256\"</code>"
                                        },
                                        {
                                          "case": "If the namedCurve attribute of the [[algorithm]] internal slot of key is \"P-384\":",
                                          "html": "Set the <code>crv</code> attribute of <var>jwk</var> to\n                                      <code>\"P-384\"</code>"
                                        },
                                        {
                                          "case": "If the namedCurve attribute of the [[algorithm]] internal slot of key is \"P-521\":",
                                          "html": "Set the <code>crv</code> attribute of <var>jwk</var> to\n                                      <code>\"P-521\"</code>"
                                        }
                                      ]
                                    }
                                  ]
                                },
                                {
                                  "html": "<p>\n                                    Set the <code>x</code> attribute of <var>jwk</var> according to the\n                                    definition in Section 6.2.1.2 of <a href=\"https://www.w3.org/TR/WebCryptoAPI/#jwa\">JSON Web\n                                    Algorithms</a>.\n                                  </p>"
                                },
                                {
                                  "html": "<p>\n                                    Set the <code>y</code> attribute of <var>jwk</var> according to the\n                                    definition in Section 6.2.1.3 of <a href=\"https://www.w3.org/TR/WebCryptoAPI/#jwa\">JSON Web\n                                    Algorithms</a>.\n                                  </p>"
                                },
                                {
                                  "html": "<dl class=\"switch\">\n                                    <dt>\n                                      If the [[<a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-type\">type</a>]] internal slot\n                                      of <var>key</var> is <code>\"private\"</code>\n                                    </dt>\n                                    <dd>\n                                      <p>\n                                        Set the <code>d</code> attribute of <var>jwk</var> according to the\n                                        definition in Section 6.2.2.1 of <a href=\"https://www.w3.org/TR/WebCryptoAPI/#jwa\">JSON Web\n                                        Algorithms</a>.\n                                      </p>\n                                    </dd>\n                                  </dl>",
                                  "rationale": ".switch",
                                  "steps": [
                                    {
                                      "operation": "switch",
                                      "steps": [
                                        {
                                          "case": "If the [[type]] internal slot of key is \"private\"",
                                          "html": "<p>\n                                        Set the <code>d</code> attribute of <var>jwk</var> according to the\n                                        definition in Section 6.2.2.1 of <a href=\"https://www.w3.org/TR/WebCryptoAPI/#jwa\">JSON Web\n                                        Algorithms</a>.\n                                      </p>"
                                        }
                                      ]
                                    }
                                  ]
                                }
                              ]
                            },
                            {
                              "case": "Otherwise:",
                              "html": "",
                              "rationale": "perform",
                              "steps": [
                                {
                                  "html": "<p>\n                                    Perform any <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-ecdh-extended-export-steps\">key export steps</a>\n                                    defined by <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-applicable-specification\">other applicable\n                                    specifications</a>, passing <var>format</var> and the\n                                    <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-EcKeyAlgorithm-namedCurve\">namedCurve</a> attribute of\n                                    the [[<a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-algorithm\">algorithm</a>]]\n                                    internal slot of <var>key</var>\n                                    and obtaining <var>namedCurve</var> and a new value of <var>jwk</var>.\n                                  </p>"
                                },
                                {
                                  "html": "<p>\n                                    Set the <code>crv</code> attribute of <var>jwk</var> to\n                                    <var>namedCurve</var>.\n                                  </p>"
                                }
                              ]
                            }
                          ]
                        }
                      ]
                    },
                    {
                      "html": "<p>\n                            Set the <code>key_ops</code> attribute of <var>jwk</var> to the\n                            <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-usages\">usages</a> attribute of <var>key</var>.\n                          </p>"
                    },
                    {
                      "html": "<p>\n                            Set the <code>ext</code> attribute of <var>jwk</var> to the [[<a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-extractable\">extractable</a>]] internal slot\n                            of <var>key</var>.\n                          </p>"
                    },
                    {
                      "html": "<p>\n                            Let <var>result</var> be the result of converting <var>jwk</var>\n                            to an ECMAScript Object, as defined by [<a href=\"https://www.w3.org/TR/WebCryptoAPI/#WebIDL\">WebIDL</a>].\n                          </p>"
                    }
                  ]
                },
                {
                  "case": "If format is \"raw\":",
                  "html": "",
                  "rationale": "if",
                  "steps": [
                    {
                      "html": "<p>\n                            If the [[<a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-type\">type</a>]] internal slot\n                            of <var>key</var> is not <code>\"public\"</code>, then <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">throw</a> an <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-InvalidAccessError\"><code>InvalidAccessError</code></a>.\n                          </p>"
                    },
                    {
                      "html": "<dl class=\"switch\">\n                            <dt>\n                              If the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-EcKeyAlgorithm-namedCurve\">namedCurve</a>\n                              attribute of the [[<a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-algorithm\">algorithm</a>]] internal slot\n                              of <var>key</var> is <code>\"P-256\"</code>, <code>\"P-384\"</code>\n                              or <code>\"P-521\"</code>:\n                            </dt>\n                            <dd>\n                              <p>\n                                Let <var>data</var> be the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-octet-string\">octet string</a> that\n                                represents the Elliptic Curve public key represented by the [[<a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-handle\">handle</a>]] internal slot of\n                                <var>key</var> according to the encoding rules specified in\n                                Section 2.3.3 of <a href=\"https://www.w3.org/TR/WebCryptoAPI/#SEC1\">SEC 1</a> and using the\n                                uncompressed form.\n                              </p>\n                            </dd>\n                            <dt>Otherwise:</dt>\n                            <dd>\n                              <p>\n                                Perform any <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-ecdh-extended-export-steps\">key export steps</a>\n                                defined by <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-applicable-specification\">other applicable\n                                specifications</a>, passing <var>format</var> and the\n                                <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-EcKeyAlgorithm-namedCurve\">namedCurve</a> attribute of\n                                the [[<a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-algorithm\">algorithm</a>]]\n                                internal slot of <var>key</var>\n                                and obtaining <var>namedCurve</var> and <var>data</var>.\n                              </p>\n                            </dd>\n                          </dl>",
                      "rationale": ".switch",
                      "steps": [
                        {
                          "operation": "switch",
                          "steps": [
                            {
                              "case": "If the namedCurve attribute of the [[algorithm]] internal slot of key is \"P-256\", \"P-384\" or \"P-521\":",
                              "html": "<p>\n                                Let <var>data</var> be the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-octet-string\">octet string</a> that\n                                represents the Elliptic Curve public key represented by the [[<a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-handle\">handle</a>]] internal slot of\n                                <var>key</var> according to the encoding rules specified in\n                                Section 2.3.3 of <a href=\"https://www.w3.org/TR/WebCryptoAPI/#SEC1\">SEC 1</a> and using the\n                                uncompressed form.\n                              </p>"
                            },
                            {
                              "case": "Otherwise:",
                              "html": "<p>\n                                Perform any <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-ecdh-extended-export-steps\">key export steps</a>\n                                defined by <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-applicable-specification\">other applicable\n                                specifications</a>, passing <var>format</var> and the\n                                <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-EcKeyAlgorithm-namedCurve\">namedCurve</a> attribute of\n                                the [[<a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-algorithm\">algorithm</a>]]\n                                internal slot of <var>key</var>\n                                and obtaining <var>namedCurve</var> and <var>data</var>.\n                              </p>"
                            }
                          ]
                        }
                      ]
                    },
                    {
                      "html": "<p>\n                            Let <var>result</var> be a new <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-ArrayBuffer\">ArrayBuffer</a> associated with the\n                            <a href=\"https://www.w3.org/TR/html51/webappapis.html#relevant-global-object\">relevant global object</a>\n                            of <code>this</code> [<a href=\"https://www.w3.org/TR/WebCryptoAPI/#HTML\">HTML</a>], and containing\n                            <var>data</var>.\n                          </p>"
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "html": "<p>\n                    Return <var>result</var>.\n                  </p>"
        }
      ]
    },
    {
      "html": "",
      "rationale": "if",
      "steps": [
        {
          "html": "<p>\n                    If the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-AesCtrParams-counter\">counter</a> member of\n                    <var>normalizedAlgorithm</var> does not have length 16\n                    bytes,\n                    then <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">throw</a> an\n                    <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-OperationError\"><code>OperationError</code></a>.\n                  </p>"
        },
        {
          "html": "<p>\n                    If the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-AesCtrParams-length\">length</a> member of\n                    <var>normalizedAlgorithm</var> is zero or is greater\n                    than 128,\n                    then <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">throw</a> an\n                    <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-OperationError\"><code>OperationError</code></a>.\n                  </p>"
        },
        {
          "html": "<p>\n                    Let <var>ciphertext</var> be the result of performing the CTR Encryption\n                    operation described in Section 6.5 of [<a href=\"https://www.w3.org/TR/WebCryptoAPI/#SP800-38A\">NIST SP800-38A</a>] using AES as the block cipher, <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-contents-of-arraybuffer\">the contents of</a> the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-AesCtrParams-counter\">counter</a> member of\n                    <var>normalizedAlgorithm</var> as the initial value of the counter block, the\n                    <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-AesCtrParams-length\">length</a> member of\n                    <var>normalizedAlgorithm</var> as the input parameter <var>m</var> to the\n                    standard counter block incrementing function defined in Appendix B.1 of\n                    [<a href=\"https://www.w3.org/TR/WebCryptoAPI/#SP800-38A\">NIST SP800-38A</a>] and <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-contents-of-arraybuffer\">the contents of\n                    <var>plaintext</var></a> as the input plaintext.\n                  </p>"
        },
        {
          "html": "<p>\n                    Return a new <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-ArrayBuffer\">ArrayBuffer</a> associated with the\n                    <a href=\"https://www.w3.org/TR/html51/webappapis.html#relevant-global-object\">relevant global object</a>\n                    of <code>this</code> [<a href=\"https://www.w3.org/TR/WebCryptoAPI/#HTML\">HTML</a>], and \n                    containing <var>ciphertext</var>.\n                  </p>"
        }
      ]
    },
    {
      "html": "",
      "rationale": "if",
      "steps": [
        {
          "html": "<p>\n                    If the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-AesCtrParams-counter\">counter</a> member of\n                    <var>normalizedAlgorithm</var> does not have length 16\n                    bytes,\n                    then <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">throw</a> an\n                    <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-OperationError\"><code>OperationError</code></a>.\n                  </p>"
        },
        {
          "html": "<p>\n                    If the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-AesCtrParams-length\">length</a> member of\n                    <var>normalizedAlgorithm</var> is zero or is greater\n                    than 128,\n                    then <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">throw</a> an\n                    <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-OperationError\"><code>OperationError</code></a>.\n                  </p>"
        },
        {
          "html": "<p>\n                    Let <var>plaintext</var> be the result of performing the CTR Decryption\n                    operation described in Section 6.5 of [<a href=\"https://www.w3.org/TR/WebCryptoAPI/#SP800-38A\">NIST SP800-38A</a>] using AES as the block cipher, <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-contents-of-arraybuffer\">the contents of</a> the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-AesCtrParams-counter\">counter</a> member of\n                    <var>normalizedAlgorithm</var> as the initial value of the counter block, the\n                    <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-AesCtrParams-length\">length</a> member of\n                    <var>normalizedAlgorithm</var> as the input parameter <var>m</var> to the\n                    standard counter block incrementing function defined in Appendix B.1 of\n                    [<a href=\"https://www.w3.org/TR/WebCryptoAPI/#SP800-38A\">NIST SP800-38A</a>] and <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-contents-of-arraybuffer\">the contents of\n                    <var>ciphertext</var></a> as the input ciphertext.\n                  </p>"
        },
        {
          "html": "<p>\n                    Return a new <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-ArrayBuffer\">ArrayBuffer</a> associated with the\n                    <a href=\"https://www.w3.org/TR/html51/webappapis.html#relevant-global-object\">relevant global object</a>\n                    of <code>this</code> [<a href=\"https://www.w3.org/TR/WebCryptoAPI/#HTML\">HTML</a>], and \n                    containing <var>plaintext</var>.\n                  </p>"
        }
      ]
    },
    {
      "html": "",
      "rationale": "if",
      "steps": [
        {
          "html": "<p>\n                    If <var>usages</var> contains any entry which is not\n                    one of <code>\"encrypt\"</code>, <code>\"decrypt\"</code>,\n                    <code>\"wrapKey\"</code> or <code>\"unwrapKey\"</code>,\n                    then <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">throw</a> a\n                    <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-SyntaxError\"><code>SyntaxError</code></a>.\n                  </p>"
        },
        {
          "html": "<p>\n                    If the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-AesKeyGenParams-length\">length</a> member of\n                    <var>normalizedAlgorithm</var> is not equal to one of\n                    128, 192 or 256,\n                    then <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">throw</a> an\n                    <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-OperationError\"><code>OperationError</code></a>.\n                  </p>"
        },
        {
          "html": "<p>\n                    Generate an AES key of length\n                    equal to the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-AesKeyGenParams-length\">length</a> member of\n                    <var>normalizedAlgorithm</var>.\n                  </p>"
        },
        {
          "html": "<p>\n                    If the key generation step fails,\n                    then <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">throw</a> an\n                    <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-OperationError\"><code>OperationError</code></a>.\n                  </p>"
        },
        {
          "html": "<p>\n                    Let <var>key</var> be a new\n                    <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey\">CryptoKey</a> object representing the\n                    generated AES key.\n                  </p>"
        },
        {
          "html": "<p>\n                    Let <var>algorithm</var> be a new\n                    <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-AesKeyAlgorithm\">AesKeyAlgorithm</a>.\n                  </p>"
        },
        {
          "html": "<p>\n                    Set the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-KeyAlgorithm-name\">name</a> attribute of\n                    <var>algorithm</var> to <code>\"AES-CTR\"</code>.\n                  </p>"
        },
        {
          "html": "<p>\n                    Set the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-AesKeyAlgorithm-length\">length</a> attribute of\n                    <var>algorithm</var> to equal the\n                    <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-AesKeyGenParams-length\">length</a> member of\n                    <var>normalizedAlgorithm</var>.\n                  </p>"
        },
        {
          "html": "<p>\n                    Set the [[<a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-algorithm\">algorithm</a>]] internal\n                    slot of <var>key</var> to <var>algorithm</var>.\n                  </p>"
        },
        {
          "html": "<p>\n                    Set the [[<a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-extractable\">extractable</a>]] internal\n                    slot of <var>key</var> to be <var>extractable</var>.\n                  </p>"
        },
        {
          "html": "<p>\n                    Set the [[<a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-usages\">usages</a>]] internal slot of\n                    <var>key</var> to be <var>usages</var>.\n                  </p>"
        },
        {
          "html": "<p>\n                    Return <var>key</var>.\n                  </p>"
        }
      ]
    },
    {
      "html": "",
      "rationale": "if",
      "steps": [
        {
          "html": "<p>\n                    If <var>usages</var> contains an entry which is not\n                    one of <code>\"encrypt\"</code>, <code>\"decrypt\"</code>,\n                    <code>\"wrapKey\"</code> or <code>\"unwrapKey\"</code>,\n                    then <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">throw</a> a\n                    <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-SyntaxError\"><code>SyntaxError</code></a>.\n                  </p>"
        },
        {
          "html": "<dl class=\"switch\">\n                    <dt>If <var>format</var> is <code>\"raw\"</code>:</dt>\n                    <dd>\n                      \n                    </dd>\n                    <dt>If <var>format</var> is <code>\"jwk\"</code>:</dt>\n                    <dd>\n                      \n                    </dd>\n                    <dt>Otherwise:</dt>\n                    <dd>\n                      <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">throw</a> a\n                      <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-NotSupportedError\"><code>NotSupportedError</code></a>.\n                    </dd>\n                  </dl>",
          "rationale": ".switch",
          "steps": [
            {
              "operation": "switch",
              "steps": [
                {
                  "case": "If format is \"raw\":",
                  "html": "",
                  "rationale": "let",
                  "steps": [
                    {
                      "html": "<p>\n                            Let <var>data</var> be the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-octet-string\">octet string</a> contained in <var>keyData</var>.\n                          </p>"
                    },
                    {
                      "html": "<p>\n                            If the length in bits of <var>data</var> is not 128, 192 or 256\n                            then <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">throw</a> a\n                            <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-DataError\"><code>DataError</code></a>.\n                          </p>"
                    }
                  ]
                },
                {
                  "case": "If format is \"jwk\":",
                  "html": "",
                  "rationale": "if",
                  "steps": [
                    {
                      "html": "<dl class=\"switch\">\n                            <dt>If <var>keyData</var> is a <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-JsonWebKey\">JsonWebKey</a> dictionary:</dt>\n                            <dd><p>Let <var>jwk</var> equal <var>keyData</var>.</p></dd>\n                            <dt>Otherwise:</dt>\n                            <dd><p><a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">Throw</a> a <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-DataError\"><code>DataError</code></a>.</p></dd>\n                          </dl>",
                      "rationale": ".switch",
                      "steps": [
                        {
                          "operation": "switch",
                          "steps": [
                            {
                              "case": "If keyData is a JsonWebKey dictionary:",
                              "html": "<p>Let <var>jwk</var> equal <var>keyData</var>.</p>"
                            },
                            {
                              "case": "Otherwise:",
                              "html": "<p><a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">Throw</a> a <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-DataError\"><code>DataError</code></a>.</p>"
                            }
                          ]
                        }
                      ]
                    },
                    {
                      "html": "<p>\n                            If the <code>\"kty\"</code> field of <var>jwk</var> is not\n                             <code>\"oct\"</code>,\n                            then <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">throw</a> a\n                            <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-DataError\"><code>DataError</code></a>.\n                          </p>"
                    },
                    {
                      "html": "<p>\n                            If <var>jwk</var> does not meet the requirements of\n                            Section 6.4 of <a href=\"https://www.w3.org/TR/WebCryptoAPI/#jwa\">JSON Web Algorithms</a>,\n                            then <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">throw</a> a\n                            <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-DataError\"><code>DataError</code></a>.\n                          </p>"
                    },
                    {
                      "html": "<p>\n                            Let <var>data</var> be the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-octet-string\">octet string</a> obtained by decoding the\n                            <code>\"k\"</code> field of <var>jwk</var>.\n                          </p>"
                    },
                    {
                      "html": "<dl class=\"switch\">\n                            <dt>If <var>data</var> has length 128 bits:</dt>\n                            <dd>\n                              If the <code>\"alg\"</code> field of <var>jwk</var> is present, and is\n                              not <code>\"A128CTR\"</code>, then <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">throw</a> a <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-DataError\"><code>DataError</code></a>.\n                            </dd>\n                            <dt>If <var>data</var> has length 192 bits:</dt>\n                            <dd>\n                              If the <code>\"alg\"</code> field of <var>jwk</var> is present, and is\n                              not <code>\"A192CTR\"</code>, then <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">throw</a> a <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-DataError\"><code>DataError</code></a>.\n                            </dd>\n                            <dt>If <var>data</var> has length 256 bits:</dt>\n                            <dd>\n                              If the <code>\"alg\"</code> field of <var>jwk</var> is present, and is\n                              not <code>\"A256CTR\"</code>, then <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">throw</a> a <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-DataError\"><code>DataError</code></a>.\n                            </dd>\n                            <dt>Otherwise:</dt>\n                            <dd>\n                              <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">throw</a> a\n                              <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-DataError\"><code>DataError</code></a>.</dd>\n                          </dl>",
                      "rationale": ".switch",
                      "steps": [
                        {
                          "operation": "switch",
                          "steps": [
                            {
                              "case": "If data has length 128 bits:",
                              "html": "If the <code>\"alg\"</code> field of <var>jwk</var> is present, and is\n                              not <code>\"A128CTR\"</code>, then <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">throw</a> a <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-DataError\"><code>DataError</code></a>."
                            },
                            {
                              "case": "If data has length 192 bits:",
                              "html": "If the <code>\"alg\"</code> field of <var>jwk</var> is present, and is\n                              not <code>\"A192CTR\"</code>, then <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">throw</a> a <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-DataError\"><code>DataError</code></a>."
                            },
                            {
                              "case": "If data has length 256 bits:",
                              "html": "If the <code>\"alg\"</code> field of <var>jwk</var> is present, and is\n                              not <code>\"A256CTR\"</code>, then <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">throw</a> a <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-DataError\"><code>DataError</code></a>."
                            },
                            {
                              "case": "Otherwise:",
                              "html": "<a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">throw</a> a\n                              <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-DataError\"><code>DataError</code></a>."
                            }
                          ]
                        }
                      ]
                    },
                    {
                      "html": "<p>\n                            If <var>usages</var> is non-empty and the <code>\"use\"</code> field of <var>jwk</var> is present and is\n                            not <code>\"enc\"</code>,\n                            then <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">throw</a> a\n                            <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-DataError\"><code>DataError</code></a>.\n                          </p>"
                    },
                    {
                      "html": "<p>\n                            If the <code>\"key_ops\"</code> field of <var>jwk</var> is present, and\n                            is invalid according to the requirements of\n                            <a href=\"https://www.w3.org/TR/WebCryptoAPI/#jwk\">JSON Web Key</a> or\n                            does not contain all of the specified <var>usages</var> values,\n                            then <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">throw</a> a\n                            <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-DataError\"><code>DataError</code></a>.\n                          </p>"
                    },
                    {
                      "html": "<p>\n                            If the <code>\"ext\"</code> field of <var>jwk</var> is present and\n                            has the value false and <var>extractable</var> is true,\n                            then <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">throw</a> a\n                            <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-DataError\"><code>DataError</code></a>.\n                          </p>"
                    }
                  ]
                },
                {
                  "case": "Otherwise:",
                  "html": "<a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">throw</a> a\n                      <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-NotSupportedError\"><code>NotSupportedError</code></a>."
                }
              ]
            }
          ]
        },
        {
          "html": "<p>\n                    Let <var>key</var> be a new <code><a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey\">CryptoKey</a></code> object representing an AES key with\n                    value <var>data</var>.\n                  </p>"
        },
        {
          "html": "<p>\n                    Let <var>algorithm</var> be a new\n                    <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-AesKeyAlgorithm\">AesKeyAlgorithm</a>.\n                  </p>"
        },
        {
          "html": "<p>\n                    Set the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-KeyAlgorithm-name\">name</a> attribute of\n                    <var>algorithm</var> to <code>\"AES-CTR\"</code>.\n                  </p>"
        },
        {
          "html": "<p>\n                    Set the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-AesKeyAlgorithm-length\">length</a> attribute of\n                    <var>algorithm</var> to the length, in bits, of <var>data</var>.\n                  </p>"
        },
        {
          "html": "<p>\n                    Set the [[<a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-algorithm\">algorithm</a>]] internal\n                    slot of <var>key</var> to <var>algorithm</var>.\n                  </p>"
        },
        {
          "html": "<p>\n                    Return <var>key</var>.\n                  </p>"
        }
      ]
    },
    {
      "html": "",
      "rationale": "if",
      "steps": [
        {
          "html": "<p>\n                    If the underlying cryptographic key material represented by the [[<a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-handle\">handle</a>]] internal slot of <var>key</var>\n                    cannot be accessed, then <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">throw</a> an <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-OperationError\"><code>OperationError</code></a>.\n                  </p>"
        },
        {
          "html": "<dl class=\"switch\">\n                    <dt>If <var>format</var> is <code>\"raw\"</code>:</dt>\n                    <dd>\n                      \n                    </dd>\n                    <dt>If <var>format</var> is <code>\"jwk\"</code>:</dt>\n                    <dd>\n                      \n                    </dd>\n                    <dt>Otherwise:</dt>\n                    <dd>\n                      <p>\n                        <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">throw</a> a\n                        <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-NotSupportedError\"><code>NotSupportedError</code></a>.\n                      </p>\n                    </dd>\n                  </dl>",
          "rationale": ".switch",
          "steps": [
            {
              "operation": "switch",
              "steps": [
                {
                  "case": "If format is \"raw\":",
                  "html": "",
                  "rationale": "let",
                  "steps": [
                    {
                      "html": "<p>\n                            Let <var>data</var> be the raw octets of the key represented by [[<a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-handle\">handle</a>]] internal slot of\n                            <var>key</var>.\n                          </p>"
                    },
                    {
                      "html": "<p>\n                            Let <var>result</var> be a new <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-ArrayBuffer\">ArrayBuffer</a> associated with the\n                            <a href=\"https://www.w3.org/TR/html51/webappapis.html#relevant-global-object\">relevant global object</a>\n                            of <code>this</code> [<a href=\"https://www.w3.org/TR/WebCryptoAPI/#HTML\">HTML</a>], and containing\n                            <var>data</var>.\n                          </p>"
                    }
                  ]
                },
                {
                  "case": "If format is \"jwk\":",
                  "html": "",
                  "rationale": "let",
                  "steps": [
                    {
                      "html": "<p>\n                            Let <var>jwk</var> be a new <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-JsonWebKey\">JsonWebKey</a>\n                            dictionary.\n                          </p>"
                    },
                    {
                      "html": "<p>\n                            Set the <code>kty</code> attribute of <var>jwk</var> to the\n                            string <code>\"oct\"</code>.\n                          </p>"
                    },
                    {
                      "html": "<p>\n                            Set the <code>k</code> attribute of <var>jwk</var> to be a string\n                            containing the raw octets of the key represented by [[<a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-handle\">handle</a>]] internal slot of\n                            <var>key</var>, encoded according to Section 6.4 of <a href=\"https://www.w3.org/TR/WebCryptoAPI/#jwa\">JSON Web Algorithms</a>.\n                          </p>"
                    },
                    {
                      "html": "<dl class=\"switch\">\n                            <dt>If the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-AesKeyAlgorithm-length\">length</a> attribute of\n                            <var>key</var> is 128:</dt>\n                            <dd>Set the <code>alg</code> attribute of <var>jwk</var> to\n                            the string <code>\"A128CTR\"</code>.</dd>\n                            <dt>If the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-AesKeyAlgorithm-length\">length</a> attribute of\n                            <var>key</var> is 192:</dt>\n                            <dd>Set the <code>alg</code> attribute of <var>jwk</var> to\n                            the string <code>\"A192CTR\"</code>.</dd>\n                            <dt>If the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-AesKeyAlgorithm-length\">length</a> attribute of\n                            <var>key</var> is 256:</dt>\n                            <dd>Set the <code>alg</code> attribute of <var>jwk</var> to\n                            the string <code>\"A256CTR\"</code>.</dd>\n                          </dl>",
                      "rationale": ".switch",
                      "steps": [
                        {
                          "operation": "switch",
                          "steps": [
                            {
                              "case": "If the length attribute of key is 128:",
                              "html": "Set the <code>alg</code> attribute of <var>jwk</var> to\n                            the string <code>\"A128CTR\"</code>."
                            },
                            {
                              "case": "If the length attribute of key is 192:",
                              "html": "Set the <code>alg</code> attribute of <var>jwk</var> to\n                            the string <code>\"A192CTR\"</code>."
                            },
                            {
                              "case": "If the length attribute of key is 256:",
                              "html": "Set the <code>alg</code> attribute of <var>jwk</var> to\n                            the string <code>\"A256CTR\"</code>."
                            }
                          ]
                        }
                      ]
                    },
                    {
                      "html": "<p>\n                            Set the <code>key_ops</code> attribute of <var>jwk</var> to equal the\n                            [[<a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-usages\">usages</a>]] internal slot of\n                            <var>key</var>.\n                          </p>"
                    },
                    {
                      "html": "<p>\n                            Set the <code>ext</code> attribute of <var>jwk</var> to equal the [[<a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-extractable\">extractable</a>]] internal slot\n                            of <var>key</var>.\n                          </p>"
                    },
                    {
                      "html": "<p>\n                            Let <var>result</var> be the result of converting <var>jwk</var>\n                            to an ECMAScript Object, as defined by [<a href=\"https://www.w3.org/TR/WebCryptoAPI/#WebIDL\">WebIDL</a>].\n                          </p>"
                    }
                  ]
                },
                {
                  "case": "Otherwise:",
                  "html": "<p>\n                        <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">throw</a> a\n                        <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-NotSupportedError\"><code>NotSupportedError</code></a>.\n                      </p>"
                }
              ]
            }
          ]
        },
        {
          "html": "<p>\n                    Return <var>result</var>.\n                  </p>"
        }
      ]
    },
    {
      "html": "",
      "rationale": "if",
      "steps": [
        {
          "html": "<p>\n                    If the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-AesDerivedKeyParams-length\">length</a> member of\n                    <var>normalizedDerivedKeyAlgorithm</var> is not 128, 192 or 256,\n                    then <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">throw</a> a\n                    <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-OperationError\"><code>OperationError</code></a>.\n                  </p>"
        },
        {
          "html": "<p>\n                    Return the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-AesDerivedKeyParams-length\">length</a> member of\n                    <var>normalizedDerivedKeyAlgorithm</var>.\n                  </p>"
        }
      ]
    },
    {
      "html": "",
      "rationale": "if",
      "steps": [
        {
          "html": "<p>\n                    If the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-AesCbcParams-iv\">iv</a> member of\n                    <var>normalizedAlgorithm</var> does not have length 16\n                    bytes,\n                    then <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">throw</a> an\n                    <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-OperationError\"><code>OperationError</code></a>.\n                  </p>"
        },
        {
          "html": "<p>\n                    Let <var>paddedPlaintext</var> be the result of adding padding octets to\n                    the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-contents-of-arraybuffer\">contents of <var>ciphertext</var></a>\n                    according to the procedure defined in Section 10.3\n                    of [<a href=\"https://www.w3.org/TR/WebCryptoAPI/#RFC2315\">RFC2315</a>], step 2, with a value of\n                    <var>k</var> of 16.\n                  </p>"
        },
        {
          "html": "<p>\n                    Let <var>ciphertext</var> be the result of performing the CBC Encryption\n                    operation described in Section 6.2 of [<a href=\"https://www.w3.org/TR/WebCryptoAPI/#SP800-38A\">NIST SP800-38A</a>] using AES as the block cipher, <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-contents-of-arraybuffer\">the contents of</a> the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-AesCbcParams-iv\">iv</a> member of <var>normalizedAlgorithm</var> as\n                    the <var>IV</var> input parameter and <var>paddedPlaintext</var>\n                    as the input plaintext.\n                  </p>"
        },
        {
          "html": "<p>\n                    Return a new <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-ArrayBuffer\">ArrayBuffer</a> associated with the\n                    <a href=\"https://www.w3.org/TR/html51/webappapis.html#relevant-global-object\">relevant global object</a>\n                    of <code>this</code> [<a href=\"https://www.w3.org/TR/WebCryptoAPI/#HTML\">HTML</a>], and \n                    containing <var>ciphertext</var>.\n                  </p>"
        }
      ]
    },
    {
      "html": "",
      "rationale": "if",
      "steps": [
        {
          "html": "<p>\n                    If the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-AesCbcParams-iv\">iv</a> member of\n                    <var>normalizedAlgorithm</var> does not have length 16\n                    bytes,\n                    then <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">throw</a> an\n                    <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-OperationError\"><code>OperationError</code></a>.\n                  </p>"
        },
        {
          "html": "<p>\n                    Let <var>paddedPlaintext</var> be the result of performing the CBC Decryption\n                    operation described in Section 6.2 of [<a href=\"https://www.w3.org/TR/WebCryptoAPI/#SP800-38A\">NIST SP800-38A</a>] using AES as the block cipher, <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-contents-of-arraybuffer\">the contents of</a> the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-AesCbcParams-iv\">iv</a> member of <var>normalizedAlgorithm</var> as\n                    the <var>IV</var> input parameter and <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-contents-of-arraybuffer\">the contents of\n                    <var>ciphertext</var></a> as the input ciphertext.\n                  </p>"
        },
        {
          "html": "<p>\n                    Let <var>p</var> be the value of the last octet of <var>paddedPlaintext</var>.\n                  </p>"
        },
        {
          "html": "<p>\n                    If <var>p</var> is zero or greater than 16, or if any of the last <var>p</var>\n                    octets of <var>paddedPlaintext</var> have a value which is not <var>p</var>,\n                    then <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">throw</a> an\n                    <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-OperationError\"><code>OperationError</code></a>.\n                  </p>"
        },
        {
          "html": "<p>\n                    Let <var>plaintext</var> be the result of removing <var>p</var> octets from\n                    the end of <var>paddedPlaintext</var>.\n                  </p>"
        },
        {
          "html": "<p>\n                    Return a new <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-ArrayBuffer\">ArrayBuffer</a> associated with the\n                    <a href=\"https://www.w3.org/TR/html51/webappapis.html#relevant-global-object\">relevant global object</a>\n                    of <code>this</code> [<a href=\"https://www.w3.org/TR/WebCryptoAPI/#HTML\">HTML</a>], and \n                    containing <var>plaintext</var>.\n                  </p>"
        }
      ]
    },
    {
      "html": "",
      "rationale": "if",
      "steps": [
        {
          "html": "<p>\n                    If <var>usages</var> contains any entry which is not\n                     one of <code>\"encrypt\"</code>, <code>\"decrypt\"</code>,\n                    <code>\"wrapKey\"</code> or <code>\"unwrapKey\"</code>,\n                    then <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">throw</a> a\n                    <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-SyntaxError\"><code>SyntaxError</code></a>.\n                  </p>"
        },
        {
          "html": "<p>\n                    If the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-AesKeyGenParams-length\">length</a> member of\n                    <var>normalizedAlgorithm</var> is not equal to one of\n                    128, 192 or 256,\n                    then <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">throw</a> an\n                    <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-OperationError\"><code>OperationError</code></a>.\n                  </p>"
        },
        {
          "html": "<p>\n                    Generate an AES key of length\n                    equal to the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-AesKeyGenParams-length\">length</a> member of\n                    <var>normalizedAlgorithm</var>.\n                  </p>"
        },
        {
          "html": "<p>\n                    If the key generation step fails,\n                    then <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">throw</a> an\n                    <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-OperationError\"><code>OperationError</code></a>.\n                  </p>"
        },
        {
          "html": "<p>\n                    Let <var>key</var> be a new\n                    <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey\">CryptoKey</a> object representing the\n                    generated AES key.\n                  </p>"
        },
        {
          "html": "<p>\n                    Let <var>algorithm</var> be a new\n                    <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-AesKeyAlgorithm\">AesKeyAlgorithm</a>.\n                  </p>"
        },
        {
          "html": "<p>\n                    Set the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-KeyAlgorithm-name\">name</a> attribute of\n                    <var>algorithm</var> to <code>\"AES-CBC\"</code>.\n                  </p>"
        },
        {
          "html": "<p>\n                    Set the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-AesKeyAlgorithm-length\">length</a> attribute of\n                    <var>algorithm</var> to equal the\n                    <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-AesKeyGenParams-length\">length</a> member of\n                    <var>normalizedAlgorithm</var>.\n                  </p>"
        },
        {
          "html": "<p>\n                    Set the [[<a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-algorithm\">algorithm</a>]] internal\n                    slot of <var>key</var> to <var>algorithm</var>.\n                  </p>"
        },
        {
          "html": "<p>\n                    Set the [[<a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-extractable\">extractable</a>]] internal\n                    slot of <var>key</var> to be <var>extractable</var>.\n                  </p>"
        },
        {
          "html": "<p>\n                    Set the [[<a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-usages\">usages</a>]] internal slot of\n                    <var>key</var> to be <var>usages</var>.\n                  </p>"
        },
        {
          "html": "<p>\n                    Return <var>key</var>.\n                  </p>"
        }
      ]
    },
    {
      "html": "",
      "rationale": "if",
      "steps": [
        {
          "html": "<p>\n                    If <var>usages</var> contains an entry which is not\n                    one of <code>\"encrypt\"</code>, <code>\"decrypt\"</code>,\n                    <code>\"wrapKey\"</code> or <code>\"unwrapKey\"</code>,\n                    then <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">throw</a> a\n                    <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-SyntaxError\"><code>SyntaxError</code></a>.\n                  </p>"
        },
        {
          "html": "<dl class=\"switch\">\n                    <dt>If <var>format</var> is <code>\"raw\"</code>:</dt>\n                    <dd>\n                      \n                    </dd>\n                    <dt>If <var>format</var> is <code>\"jwk\"</code>:</dt>\n                    <dd>\n                      \n                    </dd>\n                    <dt>Otherwise:</dt>\n                    <dd>\n                      <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">throw</a> a\n                      <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-NotSupportedError\"><code>NotSupportedError</code></a>\n                    </dd>\n                  </dl>",
          "rationale": ".switch",
          "steps": [
            {
              "operation": "switch",
              "steps": [
                {
                  "case": "If format is \"raw\":",
                  "html": "",
                  "rationale": "let",
                  "steps": [
                    {
                      "html": "<p>\n                            Let <var>data</var> be the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-octet-string\">octet string</a> contained in <var>keyData</var>.\n                          </p>"
                    },
                    {
                      "html": "<p>\n                            If the length in bits of <var>data</var> is not 128, 192 or 256\n                            then <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">throw</a> a\n                            <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-DataError\"><code>DataError</code></a>.\n                          </p>"
                    }
                  ]
                },
                {
                  "case": "If format is \"jwk\":",
                  "html": "",
                  "rationale": "if",
                  "steps": [
                    {
                      "html": "<dl class=\"switch\">\n                            <dt>If <var>keyData</var> is a <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-JsonWebKey\">JsonWebKey</a> dictionary:</dt>\n                            <dd><p>Let <var>jwk</var> equal <var>keyData</var>.</p></dd>\n                            <dt>Otherwise:</dt>\n                            <dd><p><a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">Throw</a> a <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-DataError\"><code>DataError</code></a>.</p></dd>\n                          </dl>",
                      "rationale": ".switch",
                      "steps": [
                        {
                          "operation": "switch",
                          "steps": [
                            {
                              "case": "If keyData is a JsonWebKey dictionary:",
                              "html": "<p>Let <var>jwk</var> equal <var>keyData</var>.</p>"
                            },
                            {
                              "case": "Otherwise:",
                              "html": "<p><a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">Throw</a> a <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-DataError\"><code>DataError</code></a>.</p>"
                            }
                          ]
                        }
                      ]
                    },
                    {
                      "html": "<p>\n                            If the <code>\"kty\"</code> field of <var>jwk</var> is not\n                            <code>\"oct\"</code>,\n                            then <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">throw</a> a\n                            <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-DataError\"><code>DataError</code></a>.\n                          </p>"
                    },
                    {
                      "html": "<p>\n                            If <var>jwk</var> does not meet the requirements of\n                            Section 6.4 of <a href=\"https://www.w3.org/TR/WebCryptoAPI/#jwa\">JSON Web Algorithms</a>,\n                            then <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">throw</a> a\n                            <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-DataError\"><code>DataError</code></a>.\n                          </p>"
                    },
                    {
                      "html": "<p>\n                            Let <var>data</var> be the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-octet-string\">octet string</a> obtained by decoding the\n                            <code>\"k\"</code> field of <var>jwk</var>.\n                          </p>"
                    },
                    {
                      "html": "<dl class=\"switch\">\n                            <dt>If <var>data</var> has length 128 bits:</dt>\n                            <dd>If the <code>\"alg\"</code> field of <var>jwk</var> is present, and is\n                            not  <code>\"A128CBC\"</code>,\n                              then <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">throw</a> a\n                              <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-DataError\"><code>DataError</code></a>.</dd>\n                            <dt>If <var>data</var> has length 192 bits:</dt>\n                            <dd>If the <code>\"alg\"</code> field of <var>jwk</var> is present, and is\n                            not  <code>\"A192CBC\"</code>,\n                              then <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">throw</a> a\n                              <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-DataError\"><code>DataError</code></a>.</dd>\n                            <dt>If <var>data</var> has length 256 bits:</dt>\n                            <dd>If the <code>\"alg\"</code> field of <var>jwk</var> is present, and is\n                            not  <code>\"A256CBC\"</code>,\n                              then <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">throw</a> a\n                              <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-DataError\"><code>DataError</code></a>.</dd>\n                            <dt>Otherwise:</dt>\n                            <dd>\n                              <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">throw</a> a\n                              <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-DataError\"><code>DataError</code></a>.\n                            </dd>\n                          </dl>",
                      "rationale": ".switch",
                      "steps": [
                        {
                          "operation": "switch",
                          "steps": [
                            {
                              "case": "If data has length 128 bits:",
                              "html": "If the <code>\"alg\"</code> field of <var>jwk</var> is present, and is\n                            not  <code>\"A128CBC\"</code>,\n                              then <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">throw</a> a\n                              <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-DataError\"><code>DataError</code></a>."
                            },
                            {
                              "case": "If data has length 192 bits:",
                              "html": "If the <code>\"alg\"</code> field of <var>jwk</var> is present, and is\n                            not  <code>\"A192CBC\"</code>,\n                              then <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">throw</a> a\n                              <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-DataError\"><code>DataError</code></a>."
                            },
                            {
                              "case": "If data has length 256 bits:",
                              "html": "If the <code>\"alg\"</code> field of <var>jwk</var> is present, and is\n                            not  <code>\"A256CBC\"</code>,\n                              then <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">throw</a> a\n                              <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-DataError\"><code>DataError</code></a>."
                            },
                            {
                              "case": "Otherwise:",
                              "html": "<a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">throw</a> a\n                              <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-DataError\"><code>DataError</code></a>."
                            }
                          ]
                        }
                      ]
                    },
                    {
                      "html": "<p>\n                            If <var>usages</var> is non-empty and the <code>\"use\"</code> field of <var>jwk</var> is present and is\n                            not  <code>\"enc\"</code>,\n                            then <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">throw</a> a\n                            <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-DataError\"><code>DataError</code></a>.\n                          </p>"
                    },
                    {
                      "html": "<p>\n                            If the <code>\"key_ops\"</code> field of <var>jwk</var> is present, and\n                            is invalid according to the requirements of\n                            <a href=\"https://www.w3.org/TR/WebCryptoAPI/#jwk\">JSON Web Key</a> or                           \n                            does not contain all of the specified <var>usages</var> values,\n                            then <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">throw</a> a\n                            <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-DataError\"><code>DataError</code></a>.\n                          </p>"
                    },
                    {
                      "html": "<p>\n                            If the <code>\"ext\"</code> field of <var>jwk</var> is present and\n                            has the value false and <var>extractable</var> is true,\n                            then <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">throw</a> a\n                            <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-DataError\"><code>DataError</code></a>.\n                          </p>"
                    }
                  ]
                },
                {
                  "case": "Otherwise:",
                  "html": "<a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">throw</a> a\n                      <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-NotSupportedError\"><code>NotSupportedError</code></a>"
                }
              ]
            }
          ]
        },
        {
          "html": "<p>\n                    Let <var>key</var> be a new <code><a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey\">CryptoKey</a></code>\n                    object representing an AES key with value <var>data</var>.\n                  </p>"
        },
        {
          "html": "<p>\n                    Let <var>algorithm</var> be a new\n                    <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-AesKeyAlgorithm\">AesKeyAlgorithm</a>.\n                  </p>"
        },
        {
          "html": "<p>\n                    Set the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-KeyAlgorithm-name\">name</a> attribute of\n                    <var>algorithm</var> to <code>\"AES-CBC\"</code>.\n                  </p>"
        },
        {
          "html": "<p>\n                    Set the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-AesKeyAlgorithm-length\">length</a> attribute of\n                    <var>algorithm</var> to the length, in bits, of <var>data</var>.\n                  </p>"
        },
        {
          "html": "<p>\n                    Set the [[<a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-algorithm\">algorithm</a>]] internal\n                    slot of <var>key</var> to <var>algorithm</var>.\n                  </p>"
        },
        {
          "html": "<p>\n                    Return <var>key</var>.\n                  </p>"
        }
      ]
    },
    {
      "html": "",
      "rationale": "if",
      "steps": [
        {
          "html": "<p>\n                    If the underlying cryptographic key material represented by the [[<a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-handle\">handle</a>]] internal slot of <var>key</var>\n                    cannot be accessed, then <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">throw</a> an <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-OperationError\"><code>OperationError</code></a>.\n                  </p>"
        },
        {
          "html": "<dl class=\"switch\">\n                    <dt>If <var>format</var> is <code>\"raw\"</code>:</dt>\n                    <dd>\n                      \n                    </dd>\n                    <dt>If <var>format</var> is <code>\"jwk\"</code>:</dt>\n                    <dd>\n                      \n                    </dd>\n                    <dt>Otherwise:</dt>\n                    <dd>\n                      <p>\n                        <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">throw</a> a\n                        <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-NotSupportedError\"><code>NotSupportedError</code></a>.\n                      </p>\n                    </dd>\n                  </dl>",
          "rationale": ".switch",
          "steps": [
            {
              "operation": "switch",
              "steps": [
                {
                  "case": "If format is \"raw\":",
                  "html": "",
                  "rationale": "let",
                  "steps": [
                    {
                      "html": "<p>\n                            Let <var>data</var> be the raw octets of the key represented by [[<a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-handle\">handle</a>]] internal slot of\n                            <var>key</var>.\n                          </p>"
                    },
                    {
                      "html": "<p>\n                            Let <var>result</var> be a new <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-ArrayBuffer\">ArrayBuffer</a> associated with the\n                            <a href=\"https://www.w3.org/TR/html51/webappapis.html#relevant-global-object\">relevant global object</a>\n                            of <code>this</code> [<a href=\"https://www.w3.org/TR/WebCryptoAPI/#HTML\">HTML</a>], and containing\n                            <var>data</var>.\n                          </p>"
                    }
                  ]
                },
                {
                  "case": "If format is \"jwk\":",
                  "html": "",
                  "rationale": "if",
                  "steps": [
                    {
                      "html": "<dl class=\"switch\">\n                            <dt>If <var>keyData</var> is a <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-JsonWebKey\">JsonWebKey</a> dictionary:</dt>\n                            <dd><p>Let <var>jwk</var> equal <var>keyData</var>.</p></dd>\n                            <dt>Otherwise:</dt>\n                            <dd><p><a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">Throw</a> a <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-DataError\"><code>DataError</code></a>.</p></dd>\n                          </dl>",
                      "rationale": ".switch",
                      "steps": [
                        {
                          "operation": "switch",
                          "steps": [
                            {
                              "case": "If keyData is a JsonWebKey dictionary:",
                              "html": "<p>Let <var>jwk</var> equal <var>keyData</var>.</p>"
                            },
                            {
                              "case": "Otherwise:",
                              "html": "<p><a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">Throw</a> a <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-DataError\"><code>DataError</code></a>.</p>"
                            }
                          ]
                        }
                      ]
                    },
                    {
                      "html": "<p>\n                            Set the <code>kty</code> attribute of <var>jwk</var> to the\n                            string <code>\"oct\"</code>.\n                          </p>"
                    },
                    {
                      "html": "<p>\n                            Set the <code>k</code> attribute of <var>jwk</var> to be a string\n                            containing the raw octets of the key represented by [[<a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-handle\">handle</a>]] internal slot of\n                            <var>key</var>, encoded according to Section 6.4 of <a href=\"https://www.w3.org/TR/WebCryptoAPI/#jwa\">JSON Web Algorithms</a>.\n                          </p>"
                    },
                    {
                      "html": "<dl class=\"switch\">\n                            <dt>If the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-AesKeyAlgorithm-length\">length</a> attribute of\n                            <var>key</var> is 128:</dt>\n                            <dd>Set the <code>alg</code> attribute of <var>jwk</var> to\n                            the string <code>\"A128CBC\"</code>.</dd>\n                            <dt>If the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-AesKeyAlgorithm-length\">length</a> attribute of\n                            <var>key</var> is 192:</dt>\n                            <dd>Set the <code>alg</code> attribute of <var>jwk</var> to\n                            the string <code>\"A192CBC\"</code>.</dd>\n                            <dt>If the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-AesKeyAlgorithm-length\">length</a> attribute of\n                            <var>key</var> is 256:</dt>\n                            <dd>Set the <code>alg</code> attribute of <var>jwk</var> to\n                            the string <code>\"A256CBC\"</code>.</dd>\n                          </dl>",
                      "rationale": ".switch",
                      "steps": [
                        {
                          "operation": "switch",
                          "steps": [
                            {
                              "case": "If the length attribute of key is 128:",
                              "html": "Set the <code>alg</code> attribute of <var>jwk</var> to\n                            the string <code>\"A128CBC\"</code>."
                            },
                            {
                              "case": "If the length attribute of key is 192:",
                              "html": "Set the <code>alg</code> attribute of <var>jwk</var> to\n                            the string <code>\"A192CBC\"</code>."
                            },
                            {
                              "case": "If the length attribute of key is 256:",
                              "html": "Set the <code>alg</code> attribute of <var>jwk</var> to\n                            the string <code>\"A256CBC\"</code>."
                            }
                          ]
                        }
                      ]
                    },
                    {
                      "html": "<p>\n                            Set the <code>key_ops</code> attribute of <var>jwk</var> to equal the\n                            <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-usages\">usages</a> attribute of <var>key</var>.\n                          </p>"
                    },
                    {
                      "html": "<p>\n                            Set the <code>ext</code> attribute of <var>jwk</var> to equal the [[<a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-extractable\">extractable</a>]] internal slot\n                            of <var>key</var>.\n                          </p>"
                    },
                    {
                      "html": "<p>\n                            Let <var>result</var> be the result of converting <var>jwk</var>\n                            to an ECMAScript Object, as defined by [<a href=\"https://www.w3.org/TR/WebCryptoAPI/#WebIDL\">WebIDL</a>].\n                          </p>"
                    }
                  ]
                },
                {
                  "case": "Otherwise:",
                  "html": "<p>\n                        <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">throw</a> a\n                        <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-NotSupportedError\"><code>NotSupportedError</code></a>.\n                      </p>"
                }
              ]
            }
          ]
        },
        {
          "html": "<p>\n                    Return <var>result</var>.\n                  </p>"
        }
      ]
    },
    {
      "html": "",
      "rationale": "if",
      "steps": [
        {
          "html": "<p>\n                    If the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-AesDerivedKeyParams-length\">length</a> member of\n                    <var>normalizedDerivedKeyAlgorithm</var> is not 128, 192 or 256,\n                    then <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">throw</a> an\n                    <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-OperationError\"><code>OperationError</code></a>.\n                  </p>"
        },
        {
          "html": "<p>\n                    Return the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-AesDerivedKeyParams-length\">length</a> member of\n                    <var>normalizedDerivedKeyAlgorithm</var>.\n                  </p>"
        }
      ]
    },
    {
      "html": "",
      "rationale": "if",
      "steps": [
        {
          "html": "<p>\n                    If <var>plaintext</var> has a length greater than 2^39 - 256\n                    bytes,\n                    then <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">throw</a> an\n                    <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-OperationError\"><code>OperationError</code></a>.\n                  </p>"
        },
        {
          "html": "<p>\n                    If the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-AesGcmParams-iv\">iv</a> member of\n                    <var>normalizedAlgorithm</var> has a length greater than 2^64 - 1\n                    bytes,\n                    then <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">throw</a> an\n                    <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-OperationError\"><code>OperationError</code></a>.\n                  </p>"
        },
        {
          "html": "<p>\n                    If the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-AesGcmParams-additionalData\">additionalData</a> member\n                    of <var>normalizedAlgorithm</var> is present and has a length\n                    greater than 2^64 - 1 bytes,\n                    then <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">throw</a> an\n                    <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-OperationError\"><code>OperationError</code></a>.\n                  </p>"
        },
        {
          "html": "<dl class=\"switch\">\n                    <dt>If the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-AesGcmParams-tagLength\">tagLength</a> member of\n                    <var>normalizedAlgorithm</var> is not present:</dt>\n                    <dd>Let <var>tagLength</var> be 128.</dd>\n                    <dt>If the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-AesGcmParams-tagLength\">tagLength</a> member of\n                    <var>normalizedAlgorithm</var> is one of 32, 64, 96, 104, 112, 120 or 128:</dt>\n                    <dd>Let <var>tagLength</var> be equal to the\n                    <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-AesGcmParams-tagLength\">tagLength</a> member of\n                     <var>normalizedAlgorithm</var></dd>\n                    <dt>Otherwise:</dt>\n                    <dd>\n                      <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">throw</a> an\n                      <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-OperationError\"><code>OperationError</code></a>.\n                    </dd>\n                  </dl>",
          "rationale": ".switch",
          "steps": [
            {
              "operation": "switch",
              "steps": [
                {
                  "case": "If the tagLength member of normalizedAlgorithm is not present:",
                  "html": "Let <var>tagLength</var> be 128."
                },
                {
                  "case": "If the tagLength member of normalizedAlgorithm is one of 32, 64, 96, 104, 112, 120 or 128:",
                  "html": "Let <var>tagLength</var> be equal to the\n                    <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-AesGcmParams-tagLength\">tagLength</a> member of\n                     <var>normalizedAlgorithm</var>"
                },
                {
                  "case": "Otherwise:",
                  "html": "<a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">throw</a> an\n                      <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-OperationError\"><code>OperationError</code></a>."
                }
              ]
            }
          ]
        },
        {
          "html": "<p>\n                    Let <var>additionalData</var> be <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-contents-of-arraybuffer\">the contents of</a> the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-AesGcmParams-additionalData\">additionalData</a> member of\n                    <var>normalizedAlgorithm</var> if present or the empty octet\n                    string otherwise.\n                  </p>"
        },
        {
          "html": "<p>\n                    Let <var>C</var> and <var>T</var> be the outputs that result from performing\n                    the Authenticated Encryption Function described in Section 7.1 of\n                    [<a href=\"https://www.w3.org/TR/WebCryptoAPI/#SP800-38D\">NIST SP800-38D</a>] using AES as the block cipher, <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-contents-of-arraybuffer\">the contents of</a> the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-AesGcmParams-iv\">iv</a> member of <var>normalizedAlgorithm</var> as\n                    the <var>IV</var> input parameter, <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-contents-of-arraybuffer\">the contents of\n                    <var>additionalData</var></a> as the <var>A</var> input parameter,\n                    <var>tagLength</var> as the <var>t</var> pre-requisite and <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-contents-of-arraybuffer\">the contents of\n                    <var>plaintext</var></a> as the input plaintext.\n                  </p>"
        },
        {
          "html": "<p>\n                    Let <var>ciphertext</var> be equal to <var>C</var> | <var>T</var>,\n                    where '|' denotes concatenation.\n                  </p>"
        },
        {
          "html": "<p>\n                    Return a new <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-ArrayBuffer\">ArrayBuffer</a> associated with the\n                    <a href=\"https://www.w3.org/TR/html51/webappapis.html#relevant-global-object\">relevant global object</a>\n                    of <code>this</code> [<a href=\"https://www.w3.org/TR/WebCryptoAPI/#HTML\">HTML</a>], and \n                    containing <var>ciphertext</var>.\n                  </p>"
        }
      ]
    },
    {
      "html": "",
      "rationale": "if",
      "steps": [
        {
          "html": "<dl class=\"switch\">\n                    <dt>If the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-AesGcmParams-tagLength\">tagLength</a> member of\n                    <var>normalizedAlgorithm</var> is not present:</dt>\n                    <dd>Let <var>tagLength</var> be 128.</dd>\n                    <dt>If the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-AesGcmParams-tagLength\">tagLength</a> member of\n                    <var>normalizedAlgorithm</var> is one of 32, 64, 96, 104, 112, 120 or 128:</dt>\n                    <dd>Let <var>tagLength</var> be equal to the\n                    <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-AesGcmParams-tagLength\">tagLength</a> member of\n                     <var>normalizedAlgorithm</var></dd>\n                    <dt>Otherwise:</dt>\n                    <dd>\n                      <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">throw</a> an\n                      <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-OperationError\"><code>OperationError</code></a>.\n                    </dd>\n                  </dl>",
          "rationale": ".switch",
          "steps": [
            {
              "operation": "switch",
              "steps": [
                {
                  "case": "If the tagLength member of normalizedAlgorithm is not present:",
                  "html": "Let <var>tagLength</var> be 128."
                },
                {
                  "case": "If the tagLength member of normalizedAlgorithm is one of 32, 64, 96, 104, 112, 120 or 128:",
                  "html": "Let <var>tagLength</var> be equal to the\n                    <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-AesGcmParams-tagLength\">tagLength</a> member of\n                     <var>normalizedAlgorithm</var>"
                },
                {
                  "case": "Otherwise:",
                  "html": "<a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">throw</a> an\n                      <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-OperationError\"><code>OperationError</code></a>."
                }
              ]
            }
          ]
        },
        {
          "html": "<p>\n                    If <var>plaintext</var> has a length less than <var>tagLength</var> bits,\n                    then <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">throw</a> an\n                    <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-OperationError\"><code>OperationError</code></a>.\n                  </p>"
        },
        {
          "html": "<p>\n                    If the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-AesGcmParams-iv\">iv</a> member of\n                    <var>normalizedAlgorithm</var> has a length greater than 2^64 - 1\n                    bytes,\n                    then <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">throw</a> an\n                    <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-OperationError\"><code>OperationError</code></a>.\n                  </p>"
        },
        {
          "html": "<p>\n                    If the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-AesGcmParams-additionalData\">additionalData</a> member\n                    of <var>normalizedAlgorithm</var> is present and has a length\n                    greater than 2^64 - 1\n                    bytes,\n                    then <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">throw</a> an\n                    <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-OperationError\"><code>OperationError</code></a>.\n                  </p>"
        },
        {
          "html": "<p>\n                    Let <var>tag</var> be the last <var>tagLength</var> bits of\n                    <var>ciphertext</var>.\n                  </p>"
        },
        {
          "html": "<p>\n                    Let <var>actualCiphertext</var> be the result of removing the last <var>tagLength</var> bits\n                    from <var>ciphertext</var>.\n                  </p>"
        },
        {
          "html": "<p>\n                    Let <var>additionalData</var> be <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-contents-of-arraybuffer\">the contents</a> of the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-AesGcmParams-additionalData\">additionalData</a> member of\n                    <var>normalizedAlgorithm</var> if present or the empty octet\n                    string otherwise.\n                  </p>"
        },
        {
          "html": "Perform the Authenticated Decryption Function described in Section 7.2 of\n                    [<a href=\"https://www.w3.org/TR/WebCryptoAPI/#SP800-38D\">NIST SP800-38D</a>] using AES as the block cipher,\n                    <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-contents-of-arraybuffer\">the contents of</a> the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-AesGcmParams-iv\">iv</a> member of <var>normalizedAlgorithm</var> as\n                    the <var>IV</var> input parameter, <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-contents-of-arraybuffer\">the contents of\n                    <var>additionalData</var></a> as the <var>A</var> input parameter,\n                    <var>tagLength</var> as the <var>t</var> pre-requisite, <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-contents-of-arraybuffer\">the contents of\n                    <var>actualCiphertext</var></a> as the input ciphertext, <var>C</var> and <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-contents-of-arraybuffer\">the contents of <var>tag</var></a> as\n                    the authentication tag, <var>T</var>.",
          "rationale": ".switch",
          "steps": [
            {
              "operation": "switch",
              "steps": [
                {
                  "case": "If the result of the algorithm is the indication of inauthenticity, \"FAIL\":",
                  "html": "<a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">throw</a> an\n                      <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-OperationError\"><code>OperationError</code></a>"
                },
                {
                  "case": "Otherwise:",
                  "html": "Let <var>plaintext</var> be the output <var>P</var> of the Authenticated\n                    Decryption Function."
                }
              ]
            }
          ]
        },
        {
          "html": "<p>\n                    Return a new <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-ArrayBuffer\">ArrayBuffer</a> associated with the\n                    <a href=\"https://www.w3.org/TR/html51/webappapis.html#relevant-global-object\">relevant global object</a>\n                    of <code>this</code> [<a href=\"https://www.w3.org/TR/WebCryptoAPI/#HTML\">HTML</a>], and \n                    containing <var>plaintext</var>.\n                  </p>"
        }
      ]
    },
    {
      "html": "",
      "rationale": "if",
      "steps": [
        {
          "html": "<p>\n                    If <var>usages</var> contains any entry which is not\n                    one of <code>\"encrypt\"</code>, <code>\"decrypt\"</code>,\n                    <code>\"wrapKey\"</code> or <code>\"unwrapKey\"</code>,\n                    then <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">throw</a> a\n                    <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-SyntaxError\"><code>SyntaxError</code></a>.\n                  </p>"
        },
        {
          "html": "<p>\n                    If the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-AesKeyGenParams-length\">length</a> member of\n                    <var>normalizedAlgorithm</var> is not equal to one of\n                    128, 192 or 256,\n                    then <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">throw</a> an\n                    <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-OperationError\"><code>OperationError</code></a>.\n                  </p>"
        },
        {
          "html": "<p>\n                    Generate an AES key of length\n                    equal to the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-AesKeyGenParams-length\">length</a> member of\n                    <var>normalizedAlgorithm</var>.\n                  </p>"
        },
        {
          "html": "<p>\n                    If the key generation step fails,\n                    then <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">throw</a> an\n                    <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-OperationError\"><code>OperationError</code></a>.\n                  </p>"
        },
        {
          "html": "<p>\n                    Let <var>key</var> be a new\n                    <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey\">CryptoKey</a> object representing the\n                    generated AES key.\n                  </p>"
        },
        {
          "html": "<p>\n                    Let <var>algorithm</var> be a new\n                    <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-AesKeyAlgorithm\">AesKeyAlgorithm</a>.\n                  </p>"
        },
        {
          "html": "<p>\n                    Set the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-KeyAlgorithm-name\">name</a> attribute of\n                    <var>algorithm</var> to <code>\"AES-GCM\"</code>.\n                  </p>"
        },
        {
          "html": "<p>\n                    Set the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-AesKeyAlgorithm-length\">length</a> attribute of\n                    <var>algorithm</var> to equal the\n                    <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-AesKeyGenParams-length\">length</a> member of\n                    <var>normalizedAlgorithm</var>.\n                  </p>"
        },
        {
          "html": "<p>\n                    Set the [[<a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-algorithm\">algorithm</a>]] internal\n                    slot of <var>key</var> to <var>algorithm</var>.\n                  </p>"
        },
        {
          "html": "<p>\n                    Set the [[<a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-extractable\">extractable</a>]] internal\n                    slot of <var>key</var> to be <var>extractable</var>.\n                  </p>"
        },
        {
          "html": "<p>\n                    Set the [[<a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-usages\">usages</a>]] internal slot of\n                    <var>key</var> to be <var>usages</var>.\n                  </p>"
        },
        {
          "html": "<p>\n                    Return <var>key</var>.\n                  </p>"
        }
      ]
    },
    {
      "html": "",
      "rationale": "if",
      "steps": [
        {
          "html": "<p>\n                    If <var>usages</var> contains an entry which is not\n                    one of <code>\"encrypt\"</code>, <code>\"decrypt\"</code>,\n                    <code>\"wrapKey\"</code> or <code>\"unwrapKey\"</code>,\n                            then <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">throw</a> a\n                            <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-SyntaxError\"><code>SyntaxError</code></a>.\n                  </p>"
        },
        {
          "html": "<dl class=\"switch\">\n                    <dt>If <var>format</var> is <code>\"raw\"</code>:</dt>\n                    <dd>\n                      \n                    </dd>\n                    <dt>If <var>format</var> is <code>\"jwk\"</code>:</dt>\n                    <dd>\n                      \n                    </dd>\n                    <dt>Otherwise:</dt>\n                    <dd>\n                      <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">throw</a> a\n                      <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-NotSupportedError\"><code>NotSupportedError</code></a>.\n                    </dd>\n                  </dl>",
          "rationale": ".switch",
          "steps": [
            {
              "operation": "switch",
              "steps": [
                {
                  "case": "If format is \"raw\":",
                  "html": "",
                  "rationale": "let",
                  "steps": [
                    {
                      "html": "<p>\n                            Let <var>data</var> be the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-octet-string\">octet string</a> contained in <var>keyData</var>.\n                          </p>"
                    },
                    {
                      "html": "<p>\n                            If the length in bits of <var>data</var> is not 128, 192 or 256\n                            then <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">throw</a> a\n                            <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-DataError\"><code>DataError</code></a>.\n                          </p>"
                    }
                  ]
                },
                {
                  "case": "If format is \"jwk\":",
                  "html": "",
                  "rationale": "if",
                  "steps": [
                    {
                      "html": "<dl class=\"switch\">\n                            <dt>If <var>keyData</var> is a <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-JsonWebKey\">JsonWebKey</a> dictionary:</dt>\n                            <dd><p>Let <var>jwk</var> equal <var>keyData</var>.</p></dd>\n                            <dt>Otherwise:</dt>\n                            <dd><p><a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">Throw</a> a <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-DataError\"><code>DataError</code></a>.</p></dd>\n                          </dl>",
                      "rationale": ".switch",
                      "steps": [
                        {
                          "operation": "switch",
                          "steps": [
                            {
                              "case": "If keyData is a JsonWebKey dictionary:",
                              "html": "<p>Let <var>jwk</var> equal <var>keyData</var>.</p>"
                            },
                            {
                              "case": "Otherwise:",
                              "html": "<p><a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">Throw</a> a <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-DataError\"><code>DataError</code></a>.</p>"
                            }
                          ]
                        }
                      ]
                    },
                    {
                      "html": "<p>\n                            If the <code>\"kty\"</code> field of <var>jwk</var> is not\n                            <code>\"oct\"</code>,\n                            then <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">throw</a> a\n                            <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-DataError\"><code>DataError</code></a>.\n                          </p>"
                    },
                    {
                      "html": "<p>\n                            If <var>jwk</var> does not meet the requirements of\n                            Section 6.4 of <a href=\"https://www.w3.org/TR/WebCryptoAPI/#jwa\">JSON Web Algorithms</a>,\n                            then <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">throw</a> a\n                            <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-DataError\"><code>DataError</code></a>.\n                          </p>"
                    },
                    {
                      "html": "<p>\n                            Let <var>data</var> be the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-octet-string\">octet string</a> obtained by decoding the\n                            <code>\"k\"</code> field of <var>jwk</var>.\n                          </p>"
                    },
                    {
                      "html": "<dl class=\"switch\">\n                            <dt>If <var>data</var> has length 128 bits:</dt>\n                            <dd>If the <code>\"alg\"</code> field of <var>jwk</var> is present, and is\n                            not  <code>\"A128GCM\"</code>,\n                              then <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">throw</a> a\n                              <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-DataError\"><code>DataError</code></a>.</dd>\n                            <dt>If <var>data</var> has length 192 bits:</dt>\n                            <dd>If the <code>\"alg\"</code> field of <var>jwk</var> is present, and is\n                            not  <code>\"A192GCM\"</code>,\n                              then <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">throw</a> a\n                              <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-DataError\"><code>DataError</code></a>.</dd>\n                            <dt>If <var>data</var> has length 256 bits:</dt>\n                            <dd>If the <code>\"alg\"</code> field of <var>jwk</var> is present, and is\n                            not  <code>\"A256GCM\"</code>,\n                              then <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">throw</a> a\n                              <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-DataError\"><code>DataError</code></a>.</dd>\n                            <dt>Otherwise:</dt>\n                            <dd>\n                              <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">throw</a> a\n                              <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-DataError\"><code>DataError</code></a>.\n                            </dd>\n                          </dl>",
                      "rationale": ".switch",
                      "steps": [
                        {
                          "operation": "switch",
                          "steps": [
                            {
                              "case": "If data has length 128 bits:",
                              "html": "If the <code>\"alg\"</code> field of <var>jwk</var> is present, and is\n                            not  <code>\"A128GCM\"</code>,\n                              then <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">throw</a> a\n                              <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-DataError\"><code>DataError</code></a>."
                            },
                            {
                              "case": "If data has length 192 bits:",
                              "html": "If the <code>\"alg\"</code> field of <var>jwk</var> is present, and is\n                            not  <code>\"A192GCM\"</code>,\n                              then <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">throw</a> a\n                              <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-DataError\"><code>DataError</code></a>."
                            },
                            {
                              "case": "If data has length 256 bits:",
                              "html": "If the <code>\"alg\"</code> field of <var>jwk</var> is present, and is\n                            not  <code>\"A256GCM\"</code>,\n                              then <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">throw</a> a\n                              <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-DataError\"><code>DataError</code></a>."
                            },
                            {
                              "case": "Otherwise:",
                              "html": "<a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">throw</a> a\n                              <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-DataError\"><code>DataError</code></a>."
                            }
                          ]
                        }
                      ]
                    },
                    {
                      "html": "<p>\n                            If <var>usages</var> is non-empty and the <code>\"use\"</code> field of <var>jwk</var> is present and is\n                            not  <code>\"enc\"</code>,\n                            then <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">throw</a> a\n                            <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-DataError\"><code>DataError</code></a>.\n                          </p>"
                    },
                    {
                      "html": "<p>\n                            If the <code>\"key_ops\"</code> field of <var>jwk</var> is present, and\n                            is invalid according to the requirements of\n                            <a href=\"https://www.w3.org/TR/WebCryptoAPI/#jwk\">JSON Web Key</a> or\n                            does not contain all of the specified <var>usages</var> values,\n                            then <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">throw</a> a\n                            <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-DataError\"><code>DataError</code></a>.\n                          </p>"
                    },
                    {
                      "html": "<p>\n                            If the <code>\"ext\"</code> field of <var>jwk</var> is present and\n                            has the value false and <var>extractable</var> is true,\n                            then <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">throw</a> a\n                            <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-DataError\"><code>DataError</code></a>.\n                          </p>"
                    }
                  ]
                },
                {
                  "case": "Otherwise:",
                  "html": "<a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">throw</a> a\n                      <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-NotSupportedError\"><code>NotSupportedError</code></a>."
                }
              ]
            }
          ]
        },
        {
          "html": "<p>\n                    Let <var>key</var> be a new <code><a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey\">CryptoKey</a></code>\n                    object representing an AES key with value <var>data</var>.\n                  </p>"
        },
        {
          "html": "<p>\n                    Let <var>algorithm</var> be a new\n                    <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-AesKeyAlgorithm\">AesKeyAlgorithm</a>.\n                  </p>"
        },
        {
          "html": "<p>\n                    Set the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-KeyAlgorithm-name\">name</a> attribute of\n                    <var>algorithm</var> to <code>\"AES-GCM\"</code>.\n                  </p>"
        },
        {
          "html": "<p>\n                    Set the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-AesKeyAlgorithm-length\">length</a> attribute of\n                    <var>algorithm</var> to the length, in bits, of <var>data</var>.\n                  </p>"
        },
        {
          "html": "<p>\n                    Set the [[<a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-algorithm\">algorithm</a>]] internal\n                    slot of <var>key</var> to <var>algorithm</var>.\n                  </p>"
        },
        {
          "html": "<p>\n                    Return <var>key</var>.\n                  </p>"
        }
      ]
    },
    {
      "html": "",
      "rationale": "if",
      "steps": [
        {
          "html": "<p>\n                    If the underlying cryptographic key material represented by the [[<a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-handle\">handle</a>]] internal slot of <var>key</var>\n                    cannot be accessed, then <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">throw</a> an <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-OperationError\"><code>OperationError</code></a>.\n                  </p>"
        },
        {
          "html": "<dl class=\"switch\">\n                    <dt>If <var>format</var> is <code>\"raw\"</code>:</dt>\n                    <dd>\n                      \n                    </dd>\n                    <dt>If <var>format</var> is <code>\"jwk\"</code>:</dt>\n                    <dd>\n                      \n                    </dd>\n                    <dt>Otherwise:</dt>\n                    <dd>\n                      <p>\n                        <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">throw</a> a\n                        <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-NotSupportedError\"><code>NotSupportedError</code></a>.\n                      </p>\n                    </dd>\n                  </dl>",
          "rationale": ".switch",
          "steps": [
            {
              "operation": "switch",
              "steps": [
                {
                  "case": "If format is \"raw\":",
                  "html": "",
                  "rationale": "let",
                  "steps": [
                    {
                      "html": "<p>\n                            Let <var>data</var> be the raw octets of the key represented by [[<a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-handle\">handle</a>]] internal slot of\n                            <var>key</var>.\n                          </p>"
                    },
                    {
                      "html": "<p>\n                            Let <var>result</var> be a new <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-ArrayBuffer\">ArrayBuffer</a> associated with the\n                            <a href=\"https://www.w3.org/TR/html51/webappapis.html#relevant-global-object\">relevant global object</a>\n                            of <code>this</code> [<a href=\"https://www.w3.org/TR/WebCryptoAPI/#HTML\">HTML</a>], and containing\n                            <var>data</var>.\n                          </p>"
                    }
                  ]
                },
                {
                  "case": "If format is \"jwk\":",
                  "html": "",
                  "rationale": "let",
                  "steps": [
                    {
                      "html": "<p>\n                            Let <var>jwk</var> be a new <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-JsonWebKey\">JsonWebKey</a>\n                            dictionary.\n                          </p>"
                    },
                    {
                      "html": "<p>\n                            Set the <code>kty</code> attribute of <var>jwk</var> to the\n                            string <code>\"oct\"</code>.\n                          </p>"
                    },
                    {
                      "html": "<p>\n                            Set the <code>k</code> attribute of <var>jwk</var> to be a string\n                            containing the raw octets of the key represented by [[<a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-handle\">handle</a>]] internal slot of\n                            <var>key</var>, encoded according to Section 6.4 of <a href=\"https://www.w3.org/TR/WebCryptoAPI/#jwa\">JSON Web Algorithms</a>.\n                          </p>"
                    },
                    {
                      "html": "<dl class=\"switch\">\n                            <dt>If the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-AesKeyAlgorithm-length\">length</a> attribute of\n                            <var>key</var> is 128:</dt>\n                            <dd>Set the <code>alg</code> attribute of <var>jwk</var> to\n                            the string <code>\"A128GCM\"</code>.</dd>\n                            <dt>If the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-AesKeyAlgorithm-length\">length</a> attribute of\n                            <var>key</var> is 192:</dt>\n                            <dd>Set the <code>alg</code> attribute of <var>jwk</var> to\n                            the string <code>\"A192GCM\"</code>.</dd>\n                            <dt>If the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-AesKeyAlgorithm-length\">length</a> attribute of\n                            <var>key</var> is 256:</dt>\n                            <dd>Set the <code>alg</code> attribute of <var>jwk</var> to\n                            the string <code>\"A256GCM\"</code>.</dd>\n                          </dl>",
                      "rationale": ".switch",
                      "steps": [
                        {
                          "operation": "switch",
                          "steps": [
                            {
                              "case": "If the length attribute of key is 128:",
                              "html": "Set the <code>alg</code> attribute of <var>jwk</var> to\n                            the string <code>\"A128GCM\"</code>."
                            },
                            {
                              "case": "If the length attribute of key is 192:",
                              "html": "Set the <code>alg</code> attribute of <var>jwk</var> to\n                            the string <code>\"A192GCM\"</code>."
                            },
                            {
                              "case": "If the length attribute of key is 256:",
                              "html": "Set the <code>alg</code> attribute of <var>jwk</var> to\n                            the string <code>\"A256GCM\"</code>."
                            }
                          ]
                        }
                      ]
                    },
                    {
                      "html": "<p>\n                            Set the <code>key_ops</code> attribute of <var>jwk</var> to equal the\n                            <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-usages\">usages</a> attribute of\n                            <var>key</var>.\n                          </p>"
                    },
                    {
                      "html": "<p>\n                            Set the <code>ext</code> attribute of <var>jwk</var> to equal the [[<a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-extractable\">extractable</a>]] internal slot\n                            of <var>key</var>.\n                          </p>"
                    },
                    {
                      "html": "<p>\n                            Let <var>result</var> be the result of converting <var>jwk</var>\n                            to an ECMAScript Object, as defined by [<a href=\"https://www.w3.org/TR/WebCryptoAPI/#WebIDL\">WebIDL</a>].\n                          </p>"
                    }
                  ]
                },
                {
                  "case": "Otherwise:",
                  "html": "<p>\n                        <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">throw</a> a\n                        <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-NotSupportedError\"><code>NotSupportedError</code></a>.\n                      </p>"
                }
              ]
            }
          ]
        },
        {
          "html": "<p>\n                    Return <var>result</var>.\n                  </p>"
        }
      ]
    },
    {
      "html": "",
      "rationale": "if",
      "steps": [
        {
          "html": "<p>\n                    If the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-AesDerivedKeyParams-length\">length</a> member of\n                    <var>normalizedDerivedKeyAlgorithm</var> is not 128, 192 or 256, then <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">throw</a> an <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-OperationError\"><code>OperationError</code></a>.\n                  </p>"
        },
        {
          "html": "<p>\n                    Return the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-AesDerivedKeyParams-length\">length</a> member of\n                    <var>normalizedDerivedKeyAlgorithm</var>.\n                  </p>"
        }
      ]
    },
    {
      "html": "",
      "rationale": "if",
      "steps": [
        {
          "html": "<p>\n                    If <var>plaintext</var> is not a multiple of 64 bits in length,\n                            then <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">throw</a> an\n                            <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-OperationError\"><code>OperationError</code></a>.\n                  </p>"
        },
        {
          "html": "<p>\n                    Let <var>ciphertext</var> be the result of performing the Key Wrap\n                    operation described in Section 2.2.1 of [<a href=\"https://www.w3.org/TR/WebCryptoAPI/#rfc3394\">RFC3394</a>]\n                    with <var>plaintext</var> as the plaintext to be wrapped and using the default\n                    Initial Value defined in Section 2.2.3.1 of the same document.\n                  </p>"
        },
        {
          "html": "<p>\n                    Return <var>ciphertext</var>.\n                  </p>"
        }
      ]
    },
    {
      "html": "",
      "rationale": "let",
      "steps": [
        {
          "html": "<p>\n                    Let <var>plaintext</var> be the result of performing the Key Unwrap\n                    operation described in Section 2.2.2 of [<a href=\"https://www.w3.org/TR/WebCryptoAPI/#rfc3394\">RFC3394</a>] with\n                    <var>ciphertext</var> as the input ciphertext and using the default Initial\n                    Value defined in Section 2.2.3.1 of the same document.\n                  </p>"
        },
        {
          "html": "<p>\n                    If the Key Unwrap operation returns an error,\n                    then <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">throw</a> an\n                    <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-OperationError\"><code>OperationError</code></a>.\n                  </p>"
        },
        {
          "html": "<p>\n                    Return <var>plaintext</var>.\n                  </p>"
        }
      ]
    },
    {
      "html": "",
      "rationale": "if",
      "steps": [
        {
          "html": "<p>\n                    If <var>usages</var> contains any entry which is not one of\n                    <code>\"wrapKey\"</code> or <code>\"unwrapKey\"</code>, then <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">throw</a> a <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-SyntaxError\"><code>SyntaxError</code></a>.\n                  </p>"
        },
        {
          "html": "<p>\n                    If the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-AesKeyGenParams-length\">length</a> property of\n                    <var>normalizedAlgorithm</var> is not equal to one of 128, 192 or 256, then <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">throw</a> an <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-OperationError\"><code>OperationError</code></a>.\n                  </p>"
        },
        {
          "html": "<p>\n                    If the key generation step fails, \n                    then <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">throw</a> an\n                    <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-OperationError\"><code>OperationError</code></a>.\n                  </p>"
        },
        {
          "html": "<p>\n                    Let <var>key</var> be a new\n                    <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey\">CryptoKey</a> object representing the\n                    generated AES key.\n                  </p>"
        },
        {
          "html": "<p>\n                    Let <var>algorithm</var> be a new\n                    <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-AesKeyAlgorithm\">AesKeyAlgorithm</a>.\n                  </p>"
        },
        {
          "html": "<p>\n                    Set the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-KeyAlgorithm-name\">name</a> attribute of\n                    <var>algorithm</var> to <code>\"AES-KW\"</code>.\n                  </p>"
        },
        {
          "html": "<p>\n                    Set the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-AesKeyAlgorithm-length\">length</a> attribute of\n                    <var>algorithm</var> to equal the\n                    <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-AesKeyGenParams-length\">length</a> property of\n                    <var>normalizedAlgorithm</var>.\n                  </p>"
        },
        {
          "html": "<p>\n                    Set the [[<a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-algorithm\">algorithm</a>]] internal\n                    slot of <var>key</var> to <var>algorithm</var>.\n                  </p>"
        },
        {
          "html": "<p>\n                    Set the [[<a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-extractable\">extractable</a>]] internal\n                    slot of <var>key</var> to be <var>extractable</var>.\n                  </p>"
        },
        {
          "html": "<p>\n                    Set the [[<a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-usages\">usages</a>]] internal slot of\n                    <var>key</var> to be <var>usages</var>.\n                  </p>"
        },
        {
          "html": "<p>\n                    Return <var>key</var>.\n                  </p>"
        }
      ]
    },
    {
      "html": "",
      "rationale": "if",
      "steps": [
        {
          "html": "<p>\n                    If <var>usages</var> contains an entry which is not\n                     one of <code>\"wrapKey\"</code> or <code>\"unwrapKey\"</code>,\n                    \n                            then <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">throw</a> a\n                            <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-SyntaxError\"><code>SyntaxError</code></a>.\n                  </p>"
        },
        {
          "html": "<dl class=\"switch\">\n                    <dt>If <var>format</var> is <code>\"raw\"</code>:</dt>\n                    <dd>\n                      \n                    </dd>\n                    <dt>If <var>format</var> is <code>\"jwk\"</code>:</dt>\n                    <dd>\n                      \n                    </dd>\n                    <dt>Otherwise:</dt>\n                    <dd>\n                      <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">throw</a> a\n                      <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-NotSupportedError\"><code>NotSupportedError</code></a>.\n                    </dd>\n                  </dl>",
          "rationale": ".switch",
          "steps": [
            {
              "operation": "switch",
              "steps": [
                {
                  "case": "If format is \"raw\":",
                  "html": "",
                  "rationale": "let",
                  "steps": [
                    {
                      "html": "<p>\n                            Let <var>data</var> be the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-octet-string\">octet string</a> contained in <var>keyData</var>.\n                          </p>"
                    },
                    {
                      "html": "<p>\n                            If the length in bits of <var>data</var> is not 128, 192 or 256\n                            \n                            then <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">throw</a> a\n                            <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-DataError\"><code>DataError</code></a>.\n                          </p>"
                    }
                  ]
                },
                {
                  "case": "If format is \"jwk\":",
                  "html": "",
                  "rationale": "if",
                  "steps": [
                    {
                      "html": "<dl class=\"switch\">\n                            <dt>If <var>keyData</var> is a <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-JsonWebKey\">JsonWebKey</a> dictionary:</dt>\n                            <dd><p>Let <var>jwk</var> equal <var>keyData</var>.</p></dd>\n                            <dt>Otherwise:</dt>\n                            <dd><p><a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">Throw</a> a <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-DataError\"><code>DataError</code></a>.</p></dd>\n                          </dl>",
                      "rationale": ".switch",
                      "steps": [
                        {
                          "operation": "switch",
                          "steps": [
                            {
                              "case": "If keyData is a JsonWebKey dictionary:",
                              "html": "<p>Let <var>jwk</var> equal <var>keyData</var>.</p>"
                            },
                            {
                              "case": "Otherwise:",
                              "html": "<p><a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">Throw</a> a <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-DataError\"><code>DataError</code></a>.</p>"
                            }
                          ]
                        }
                      ]
                    },
                    {
                      "html": "<p>\n                            If the <code>\"kty\"</code> field of <var>jwk</var> is not\n                            <code>\"oct\"</code>, \n                              then <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">throw</a> a\n                              <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-DataError\"><code>DataError</code></a>.\n                          </p>"
                    },
                    {
                      "html": "<p>\n                            If <var>jwk</var> does not meet the requirements of\n                            Section 6.4 of <a href=\"https://www.w3.org/TR/WebCryptoAPI/#jwa\">JSON Web Algorithms</a>, \n                            then <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">throw</a> a\n                            <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-DataError\"><code>DataError</code></a>.\n                          </p>"
                    },
                    {
                      "html": "<p>\n                            Let <var>data</var> be the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-octet-string\">octet string</a> obtained by decoding the\n                            <code>\"k\"</code> field of <var>jwk</var>.\n                          </p>"
                    },
                    {
                      "html": "<dl class=\"switch\">\n                            <dt>If <var>data</var> has length 128 bits:</dt>\n                            <dd>If the <code>\"alg\"</code> field of <var>jwk</var> is present, and is\n                            not  <code>\"A128KW\"</code>, \n                              then <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">throw</a> a\n                              <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-DataError\"><code>DataError</code></a>.</dd>\n                            <dt>If <var>data</var> has length 192 bits:</dt>\n                            <dd>If the <code>\"alg\"</code> field of <var>jwk</var> is present, and is\n                            not  <code>\"A192KW\"</code>, \n                              then <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">throw</a> a\n                              <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-DataError\"><code>DataError</code></a>.</dd>\n                            <dt>If <var>data</var> has length 256 bits:</dt>\n                            <dd>If the <code>\"alg\"</code> field of <var>jwk</var> is present, and is\n                            not  <code>\"A256KW\"</code>, \n                              then <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">throw</a> a\n                              <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-DataError\"><code>DataError</code></a>.</dd>\n                            <dt>Otherwise:</dt>\n                            <dd>\n                              <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">throw</a> a\n                              <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-DataError\"><code>DataError</code></a>.\n                            </dd>\n                          </dl>",
                      "rationale": ".switch",
                      "steps": [
                        {
                          "operation": "switch",
                          "steps": [
                            {
                              "case": "If data has length 128 bits:",
                              "html": "If the <code>\"alg\"</code> field of <var>jwk</var> is present, and is\n                            not  <code>\"A128KW\"</code>, \n                              then <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">throw</a> a\n                              <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-DataError\"><code>DataError</code></a>."
                            },
                            {
                              "case": "If data has length 192 bits:",
                              "html": "If the <code>\"alg\"</code> field of <var>jwk</var> is present, and is\n                            not  <code>\"A192KW\"</code>, \n                              then <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">throw</a> a\n                              <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-DataError\"><code>DataError</code></a>."
                            },
                            {
                              "case": "If data has length 256 bits:",
                              "html": "If the <code>\"alg\"</code> field of <var>jwk</var> is present, and is\n                            not  <code>\"A256KW\"</code>, \n                              then <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">throw</a> a\n                              <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-DataError\"><code>DataError</code></a>."
                            },
                            {
                              "case": "Otherwise:",
                              "html": "<a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">throw</a> a\n                              <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-DataError\"><code>DataError</code></a>."
                            }
                          ]
                        }
                      ]
                    },
                    {
                      "html": "<p>\n                            If <var>usages</var> is non-empty and the <code>\"use\"</code> field of <var>jwk</var> is present and is\n                            not  <code>\"enc\"</code>, \n                              then <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">throw</a> a\n                              <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-DataError\"><code>DataError</code></a>.\n                          </p>"
                    },
                    {
                      "html": "<p>\n                            If the <code>\"key_ops\"</code> field of <var>jwk</var> is present, and\n                            is invalid according to the requirements of\n                            <a href=\"https://www.w3.org/TR/WebCryptoAPI/#jwk\">JSON Web Key</a> or\n                            does not contain all of the specified <var>usages</var> values,\n                              then <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">throw</a> a\n                              <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-DataError\"><code>DataError</code></a>.\n                          </p>"
                    },
                    {
                      "html": "<p>\n                            If the <code>\"ext\"</code> field of <var>jwk</var> is present and\n                            has the value false and <var>extractable</var> is true,\n                              then <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">throw</a> a\n                              <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-DataError\"><code>DataError</code></a>.                          </p>"
                    }
                  ]
                },
                {
                  "case": "Otherwise:",
                  "html": "<a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">throw</a> a\n                      <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-NotSupportedError\"><code>NotSupportedError</code></a>."
                }
              ]
            }
          ]
        },
        {
          "html": "<p>\n                    Let <var>key</var> be a new <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey\">CryptoKey</a> associated with the\n                    <a href=\"https://www.w3.org/TR/html51/webappapis.html#relevant-global-object\">relevant global object</a>\n                    of <code>this</code> [<a href=\"https://www.w3.org/TR/WebCryptoAPI/#HTML\">HTML</a>], and \n                    representing an AES key with value <var>data</var>.\n                  </p>"
        },
        {
          "html": "<p>\n                    Let <var>algorithm</var> be a new\n                    <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-AesKeyAlgorithm\">AesKeyAlgorithm</a>.\n                  </p>"
        },
        {
          "html": "<p>\n                    Set the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-KeyAlgorithm-name\">name</a> attribute of\n                    <var>algorithm</var> to <code>\"AES-KW\"</code>.\n                  </p>"
        },
        {
          "html": "<p>\n                    Set the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-AesKeyAlgorithm-length\">length</a> attribute of\n                    <var>algorithm</var> to the length, in bits, of <var>data</var>.\n                  </p>"
        },
        {
          "html": "<p>\n                    Set the [[<a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-algorithm\">algorithm</a>]] internal\n                    slot of <var>key</var> to <var>algorithm</var>.\n                  </p>"
        },
        {
          "html": "<p>\n                    Return <var>key</var>.\n                  </p>"
        }
      ]
    },
    {
      "html": "",
      "rationale": "if",
      "steps": [
        {
          "html": "<p>\n                    If the underlying cryptographic key material represented by the [[<a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-handle\">handle</a>]] internal slot of <var>key</var>\n                    cannot be accessed, then <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">throw</a> an <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-OperationError\"><code>OperationError</code></a>.\n                  </p>"
        },
        {
          "html": "<dl class=\"switch\">\n                    <dt>If <var>format</var> is <code>\"raw\"</code>:</dt>\n                    <dd>\n                      \n                    </dd>\n                    <dt>If <var>format</var> is <code>\"jwk\"</code>:</dt>\n                    <dd>\n                      \n                    </dd>\n                    <dt>Otherwise:</dt>\n                    <dd>\n                      <p>\n                        <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">throw</a> a\n                        <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-NotSupportedError\"><code>NotSupportedError</code></a>.\n                      </p>\n                    </dd>\n                  </dl>",
          "rationale": ".switch",
          "steps": [
            {
              "operation": "switch",
              "steps": [
                {
                  "case": "If format is \"raw\":",
                  "html": "",
                  "rationale": "let",
                  "steps": [
                    {
                      "html": "<p>\n                            Let <var>data</var> be the raw octets of the key represented by [[<a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-handle\">handle</a>]] internal slot of\n                            <var>key</var>.\n                          </p>"
                    },
                    {
                      "html": "<p>\n                            Let <var>result</var> be a new <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-ArrayBuffer\">ArrayBuffer</a> associated with the\n                            <a href=\"https://www.w3.org/TR/html51/webappapis.html#relevant-global-object\">relevant global object</a>\n                            of <code>this</code> [<a href=\"https://www.w3.org/TR/WebCryptoAPI/#HTML\">HTML</a>], and containing\n                            <var>data</var>.\n                          </p>"
                    }
                  ]
                },
                {
                  "case": "If format is \"jwk\":",
                  "html": "",
                  "rationale": "let",
                  "steps": [
                    {
                      "html": "<p>\n                            Let <var>jwk</var> be a new <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-JsonWebKey\">JsonWebKey</a>\n                            dictionary.\n                          </p>"
                    },
                    {
                      "html": "<p>\n                            Set the <code>kty</code> attribute of <var>jwk</var> to the\n                            string <code>\"oct\"</code>.\n                          </p>"
                    },
                    {
                      "html": "<p>\n                            Set the <code>k</code> attribute of <var>jwk</var> to be a string\n                            containing the raw octets of the key represented by [[<a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-handle\">handle</a>]] internal slot of\n                            <var>key</var>, encoded according to Section 6.4 of <a href=\"https://www.w3.org/TR/WebCryptoAPI/#jwa\">JSON Web Algorithms</a>.\n                          </p>"
                    },
                    {
                      "html": "<dl class=\"switch\">\n                            <dt>If the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-AesKeyAlgorithm-length\">length</a> attribute of\n                            <var>key</var> is 128:</dt>\n                            <dd>Set the <code>alg</code> attribute of <var>jwk</var> to\n                            the string <code>\"A128KW\"</code>.</dd>\n                            <dt>If the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-AesKeyAlgorithm-length\">length</a> attribute of\n                            <var>key</var> is 192:</dt>\n                            <dd>Set the <code>alg</code> attribute of <var>jwk</var> to\n                            the string <code>\"A192KW\"</code>.</dd>\n                            <dt>If the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-AesKeyAlgorithm-length\">length</a> attribute of\n                            <var>key</var> is 256:</dt>\n                            <dd>Set the <code>alg</code> attribute of <var>jwk</var> to\n                            the string <code>\"A256KW\"</code>.</dd>\n                          </dl>",
                      "rationale": ".switch",
                      "steps": [
                        {
                          "operation": "switch",
                          "steps": [
                            {
                              "case": "If the length attribute of key is 128:",
                              "html": "Set the <code>alg</code> attribute of <var>jwk</var> to\n                            the string <code>\"A128KW\"</code>."
                            },
                            {
                              "case": "If the length attribute of key is 192:",
                              "html": "Set the <code>alg</code> attribute of <var>jwk</var> to\n                            the string <code>\"A192KW\"</code>."
                            },
                            {
                              "case": "If the length attribute of key is 256:",
                              "html": "Set the <code>alg</code> attribute of <var>jwk</var> to\n                            the string <code>\"A256KW\"</code>."
                            }
                          ]
                        }
                      ]
                    },
                    {
                      "html": "<p>\n                            Set the <code>key_ops</code> attribute of <var>jwk</var> to equal the\n                            <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-usages\">usages</a> attribute of <var>key</var>.\n                          </p>"
                    },
                    {
                      "html": "<p>\n                            Set the <code>ext</code> attribute of <var>jwk</var> to equal the [[<a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-extractable\">extractable</a>]] internal slot\n                            of <var>key</var>.\n                          </p>"
                    },
                    {
                      "html": "<p>\n                            Let <var>result</var> be the result of converting <var>jwk</var>\n                            to an ECMAScript Object, as defined by [<a href=\"https://www.w3.org/TR/WebCryptoAPI/#WebIDL\">WebIDL</a>].\n                          </p>"
                    }
                  ]
                },
                {
                  "case": "Otherwise:",
                  "html": "<p>\n                        <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">throw</a> a\n                        <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-NotSupportedError\"><code>NotSupportedError</code></a>.\n                      </p>"
                }
              ]
            }
          ]
        },
        {
          "html": "<p>\n                    Return <var>result</var>.\n                  </p>"
        }
      ]
    },
    {
      "html": "",
      "rationale": "if",
      "steps": [
        {
          "html": "<p>\n                    If the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-AesDerivedKeyParams-length\">length</a> member of\n                    <var>normalizedDerivedKeyAlgorithm</var> is not 128, 192 or 256, then <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">throw</a> an <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-OperationError\"><code>OperationError</code></a>.\n                  </p>"
        },
        {
          "html": "<p>\n                    Return the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-AesDerivedKeyParams-length\">length</a> member of\n                    <var>normalizedDerivedKeyAlgorithm</var>.\n                  </p>"
        }
      ]
    },
    {
      "html": "",
      "rationale": "let",
      "steps": [
        {
          "html": "<p>\n                    Let <var>mac</var> be the result of performing the MAC Generation operation\n                    described in Section 4 of [<a href=\"https://www.w3.org/TR/WebCryptoAPI/#fips-pub-198-1\">FIPS PUB 198-1</a>] using\n                    the key represented by [[<a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-handle\">handle</a>]]\n                    internal slot of <var>key</var>, the hash function identified by the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-HmacKeyAlgorithm-hash\">hash</a> attribute of the [[<a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-algorithm\">algorithm</a>]] internal slot of\n                    <var>key</var> and <var>message</var> as the input data <var>text</var>.\n                  </p>"
        },
        {
          "html": "<p>\n                    Return a new <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-ArrayBuffer\">ArrayBuffer</a> object, associated with the\n                    <a href=\"https://www.w3.org/TR/html51/webappapis.html#relevant-global-object\">relevant global object</a>\n                    of <code>this</code> [<a href=\"https://www.w3.org/TR/WebCryptoAPI/#HTML\">HTML</a>], and containing the\n                    bytes of <var>mac</var>.\n                  </p>"
        }
      ]
    },
    {
      "html": "",
      "rationale": "let",
      "steps": [
        {
          "html": "<p>\n                    Let <var>mac</var> be the result of performing the MAC Generation operation\n                    described in Section 4 of [<a href=\"https://www.w3.org/TR/WebCryptoAPI/#fips-pub-198-1\">FIPS PUB 198-1</a>] using\n                    the key represented by [[<a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-handle\">handle</a>]]\n                    internal slot of <var>key</var>, the hash function identified by the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-HmacKeyAlgorithm-hash\">hash</a> attribute of the [[<a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-algorithm\">algorithm</a>]] internal slot of\n                    <var>key</var> and <var>message</var> as the input data <var>text</var>.\n                  </p>"
        },
        {
          "html": "<p>\n                    Return true if <var>mac</var> is equal to <var>signature</var> and false\n                    otherwise.\n                  </p>"
        }
      ]
    },
    {
      "html": "",
      "rationale": "if",
      "steps": [
        {
          "html": "<p>\n                    If <var>usages</var> contains any entry which is not <code>\"sign\"</code> or\n                    <code>\"verify\"</code>, then <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">throw</a> a <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-SyntaxError\"><code>SyntaxError</code></a>.\n                  </p>"
        },
        {
          "html": "<dl class=\"switch\">\n                    <dt>\n                      If the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-HmacKeyGenParams-length\">length</a> member of\n                      <var>normalizedAlgorithm</var> is not present:\n                    </dt>\n                    <dd>\n                      Let <var>length</var> be the block size in bits of the hash function\n                      identified by the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-HmacKeyGenParams-hash\">hash</a> member\n                      of <var>normalizedAlgorithm</var>.\n                    </dd>\n                    <dt>\n                      Otherwise, if the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-HmacKeyGenParams-length\">length</a>\n                      member of <var>normalizedAlgorithm</var> is non-zero:\n                    </dt>\n                    <dd>\n                      Let <var>length</var> be equal to the\n                      <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-HmacKeyGenParams-length\">length</a>\n                      member of <var>normalizedAlgorithm</var>.\n                    </dd>\n                    <dt>Otherwise:</dt>\n                    <dd>\n                      <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">throw</a> an\n                      <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-OperationError\"><code>OperationError</code></a>.\n                    </dd>\n                  </dl>",
          "rationale": ".switch",
          "steps": [
            {
              "operation": "switch",
              "steps": [
                {
                  "case": "If the length member of normalizedAlgorithm is not present:",
                  "html": "Let <var>length</var> be the block size in bits of the hash function\n                      identified by the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-HmacKeyGenParams-hash\">hash</a> member\n                      of <var>normalizedAlgorithm</var>."
                },
                {
                  "case": "Otherwise, if the length member of normalizedAlgorithm is non-zero:",
                  "html": "Let <var>length</var> be equal to the\n                      <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-HmacKeyGenParams-length\">length</a>\n                      member of <var>normalizedAlgorithm</var>."
                },
                {
                  "case": "Otherwise:",
                  "html": "<a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">throw</a> an\n                      <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-OperationError\"><code>OperationError</code></a>."
                }
              ]
            }
          ]
        },
        {
          "html": "<p>\n                    Generate a key of length <var>length</var> bits.\n                  </p>"
        },
        {
          "html": "<p>\n                    If the key generation step fails, \n                    then <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">throw</a> an\n                    <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-OperationError\"><code>OperationError</code></a>.\n                  </p>"
        },
        {
          "html": "<p>\n                    Let <var>key</var> be a new\n                    <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey\">CryptoKey</a> object representing the\n                    generated key.\n                  </p>"
        },
        {
          "html": "<p>\n                    Let <var>algorithm</var> be a new\n                    <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-HmacKeyAlgorithm\">HmacKeyAlgorithm</a>.\n                  </p>"
        },
        {
          "html": "<p>\n                    Set the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-KeyAlgorithm-name\">name</a> attribute of\n                    <var>algorithm</var> to <code>\"HMAC\"</code>.\n                  </p>"
        },
        {
          "html": "<p>\n                    Let <var>hash</var> be a new\n                    <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-KeyAlgorithm\">KeyAlgorithm</a>.\n                  </p>"
        },
        {
          "html": "<p>\n                    Set the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-KeyAlgorithm-name\">name</a> attribute of\n                    <var>hash</var> to equal the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-Algorithm-name\">name</a>\n                    member of the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-HmacKeyGenParams-hash\">hash</a>\n                    member of <var>normalizedAlgorithm</var>.\n                  </p>"
        },
        {
          "html": "<p>\n                    Set the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-HmacKeyAlgorithm-hash\">hash</a> attribute\n                    of <var>algorithm</var> to <var>hash</var>.\n                  </p>"
        },
        {
          "html": "<p>\n                    Set the [[<a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-algorithm\">algorithm</a>]] internal\n                    slot of <var>key</var> to <var>algorithm</var>.\n                  </p>"
        },
        {
          "html": "<p>\n                    Set the [[<a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-extractable\">extractable</a>]] internal\n                    slot of <var>key</var> to be <var>extractable</var>.\n                  </p>"
        },
        {
          "html": "<p>\n                    Set the [[<a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-usages\">usages</a>]] internal slot of\n                    <var>key</var> to be <var>usages</var>.\n                  </p>"
        },
        {
          "html": "<p>\n                    Return <var>key</var>.\n                  </p>"
        }
      ]
    },
    {
      "html": "",
      "rationale": "let",
      "steps": [
        {
          "html": "<p>Let <var>keyData</var> be the key data to be imported.</p>"
        },
        {
          "html": "<p>\n                    If <var>usages</var> contains an entry which is not\n                    <code>\"sign\"</code> or <code>\"verify\"</code>,\n                    then <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">throw</a> a\n                    <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-SyntaxError\"><code>SyntaxError</code></a>.\n                  </p>"
        },
        {
          "html": "<p>\n                    Let <var>hash</var> be a new <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-KeyAlgorithm\">KeyAlgorithm</a>.\n                  </p>"
        },
        {
          "html": "<dl class=\"switch\">\n                    <dt>If <var>format</var> is <code>\"raw\"</code>:</dt>\n                    <dd>\n                      \n                    </dd>\n                    <dt>If <var>format</var> is <code>\"jwk\"</code>:</dt>\n                    <dd>\n                      \n                    </dd>\n                    <dt>Otherwise:</dt>\n                    <dd>\n                      <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">throw</a> a\n                      <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-NotSupportedError\"><code>NotSupportedError</code></a>.\n                    </dd>\n                  </dl>",
          "rationale": ".switch",
          "steps": [
            {
              "operation": "switch",
              "steps": [
                {
                  "case": "If format is \"raw\":",
                  "html": "",
                  "rationale": "let",
                  "steps": [
                    {
                      "html": "<p>\n                            Let <var>data</var> be the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-octet-string\">octet string</a> contained in <var>keyData</var>.\n                          </p>"
                    },
                    {
                      "html": "<p>\n                            Set <var>hash</var> to equal the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-HmacImportParams-hash\">hash</a>\n                              member of <var>normalizedAlgorithm</var>.\n                          </p>"
                    }
                  ]
                },
                {
                  "case": "If format is \"jwk\":",
                  "html": "",
                  "rationale": "if",
                  "steps": [
                    {
                      "html": "<dl class=\"switch\">\n                            <dt>If <var>keyData</var> is a <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-JsonWebKey\">JsonWebKey</a> dictionary:</dt>\n                            <dd><p>Let <var>jwk</var> equal <var>keyData</var>.</p></dd>\n                            <dt>Otherwise:</dt>\n                            <dd><p><a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">Throw</a> a <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-DataError\"><code>DataError</code></a>.</p></dd>\n                          </dl>",
                      "rationale": ".switch",
                      "steps": [
                        {
                          "operation": "switch",
                          "steps": [
                            {
                              "case": "If keyData is a JsonWebKey dictionary:",
                              "html": "<p>Let <var>jwk</var> equal <var>keyData</var>.</p>"
                            },
                            {
                              "case": "Otherwise:",
                              "html": "<p><a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">Throw</a> a <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-DataError\"><code>DataError</code></a>.</p>"
                            }
                          ]
                        }
                      ]
                    },
                    {
                      "html": "<p>\n                            If the <code>\"kty\"</code> field of <var>jwk</var> is not\n                            <code>\"oct\"</code>, \n                            then <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">throw</a> a\n                            <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-DataError\"><code>DataError</code></a>.\n                          </p>"
                    },
                    {
                      "html": "<p>\n                            If <var>jwk</var> does not meet the requirements of\n                            Section 6.4 of <a href=\"https://www.w3.org/TR/WebCryptoAPI/#jwa\">JSON Web Algorithms</a>, \n                            then <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">throw</a> a\n                            <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-DataError\"><code>DataError</code></a>.\n                          </p>"
                    },
                    {
                      "html": "<p>\n                            Let <var>data</var> be the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-octet-string\">octet string</a> obtained by decoding the\n                            <code>\"k\"</code> field of <var>jwk</var>.\n                          </p>"
                    },
                    {
                      "html": "<p>\n                            Set the <var>hash</var> to equal the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-HmacImportParams-hash\">hash</a> member of\n                            <var>normalizedAlgorithm</var>.\n                          </p>"
                    },
                    {
                      "html": "<dl class=\"switch\">\n                            <dt>\n                              If the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-KeyAlgorithm-name\">name</a> attribute\n                              of <var>hash</var> is\n                              <code>\"SHA-1\"</code>:\n                            </dt>\n                            <dd>\n                              If the <code>\"alg\"</code> field of <var>jwk</var> is present\n                              and is not <code>\"HS1\"</code>,\n                              then <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">throw</a> a\n                              <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-DataError\"><code>DataError</code></a>.\n                            </dd>\n                            <dt>\n                              If If the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-KeyAlgorithm-name\">name</a> attribute\n                              of <var>hash</var> is\n                              <code>\"SHA-256\"</code>:\n                            </dt>\n                            <dd>\n                              If the <code>\"alg\"</code> field of <var>jwk</var> is present\n                              and is not <code>\"HS256\"</code>,\n                              then <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">throw</a> a\n                              <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-DataError\"><code>DataError</code></a>.\n                            </dd>\n                            <dt>\n                              If If the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-KeyAlgorithm-name\">name</a> attribute\n                              of <var>hash</var> is\n                              <code>\"SHA-384\"</code>:\n                            </dt>\n                            <dd>\n                              If the <code>\"alg\"</code> field of <var>jwk</var> is present\n                              and is not <code>\"HS384\"</code>,\n                              then <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">throw</a> a\n                              <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-DataError\"><code>DataError</code></a>.\n                            </dd>\n                            <dt>\n                              If If the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-KeyAlgorithm-name\">name</a> attribute\n                              of <var>hash</var> is\n                              <code>\"SHA-512\"</code>:\n                            </dt>\n                            <dd>\n                              If the <code>\"alg\"</code> field of <var>jwk</var> is present\n                              and is not <code>\"HS512\"</code>,\n                              then <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">throw</a> a\n                              <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-DataError\"><code>DataError</code></a>.\n                            </dd>\n                            <dt>\n                              Otherwise, if the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-KeyAlgorithm-name\">name</a> attribute\n                              of <var>hash</var> is defined in\n                              <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-applicable-specification\">another applicable\n                              specification</a>:\n                            </dt>\n                            <dd>\n                              Perform any <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-hmac-extended-import-steps\">key\n                              import steps</a> defined by\n                              <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-applicable-specification\">other applicable\n                              specifications</a>, passing <var>format</var>, <var>jwk</var>\n                              and <var>hash</var>\n                              and obtaining <var>hash</var>.\n                            </dd>\n                          </dl>",
                      "rationale": ".switch",
                      "steps": [
                        {
                          "operation": "switch",
                          "steps": [
                            {
                              "case": "If the name attribute of hash is \"SHA-1\":",
                              "html": "If the <code>\"alg\"</code> field of <var>jwk</var> is present\n                              and is not <code>\"HS1\"</code>,\n                              then <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">throw</a> a\n                              <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-DataError\"><code>DataError</code></a>."
                            },
                            {
                              "case": "If If the name attribute of hash is \"SHA-256\":",
                              "html": "If the <code>\"alg\"</code> field of <var>jwk</var> is present\n                              and is not <code>\"HS256\"</code>,\n                              then <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">throw</a> a\n                              <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-DataError\"><code>DataError</code></a>."
                            },
                            {
                              "case": "If If the name attribute of hash is \"SHA-384\":",
                              "html": "If the <code>\"alg\"</code> field of <var>jwk</var> is present\n                              and is not <code>\"HS384\"</code>,\n                              then <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">throw</a> a\n                              <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-DataError\"><code>DataError</code></a>."
                            },
                            {
                              "case": "If If the name attribute of hash is \"SHA-512\":",
                              "html": "If the <code>\"alg\"</code> field of <var>jwk</var> is present\n                              and is not <code>\"HS512\"</code>,\n                              then <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">throw</a> a\n                              <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-DataError\"><code>DataError</code></a>."
                            },
                            {
                              "case": "Otherwise, if the name attribute of hash is defined in another applicable specification:",
                              "html": "Perform any <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-hmac-extended-import-steps\">key\n                              import steps</a> defined by\n                              <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-applicable-specification\">other applicable\n                              specifications</a>, passing <var>format</var>, <var>jwk</var>\n                              and <var>hash</var>\n                              and obtaining <var>hash</var>."
                            }
                          ]
                        }
                      ]
                    },
                    {
                      "html": "<p>\n                            If <var>usages</var> is non-empty and the <code>\"use\"</code> field of <var>jwk</var> is present and is\n                            not  <code>\"sign\"</code>, \n                            then <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">throw</a> a\n                            <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-DataError\"><code>DataError</code></a>.\n                          </p>"
                    },
                    {
                      "html": "<p>\n                            If the <code>\"key_ops\"</code> field of <var>jwk</var> is present, and\n                            is invalid according to the requirements of\n                            <a href=\"https://www.w3.org/TR/WebCryptoAPI/#jwk\">JSON Web Key</a> or\n                            does not contain all of the specified <var>usages</var> values,\n                            then <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">throw</a> a\n                            <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-DataError\"><code>DataError</code></a>.\n                          </p>"
                    },
                    {
                      "html": "<p>\n                            If the <code>\"ext\"</code> field of <var>jwk</var> is present and\n                            has the value false and <var>extractable</var> is true,\n                            then <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">throw</a> a\n                            <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-DataError\"><code>DataError</code></a>.\n                          </p>"
                    }
                  ]
                },
                {
                  "case": "Otherwise:",
                  "html": "<a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">throw</a> a\n                      <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-NotSupportedError\"><code>NotSupportedError</code></a>."
                }
              ]
            }
          ]
        },
        {
          "html": "<p>\n                    Let <var>length</var> be equivalent to the length, in octets, of\n                    <var>data</var>, multiplied by 8.\n                  </p>"
        },
        {
          "html": "<p>\n                    If <var>length</var> is zero\n                    then <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">throw</a> a\n                    <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-DataError\"><code>DataError</code></a>.\n                  </p>"
        },
        {
          "html": "<dl class=\"switch\">\n                    <dt>\n                      If the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-HmacImportParams-length\">length</a> member of\n                      <var>normalizedAlgorithm</var> is present:\n                    </dt>\n                    <dd>\n                      <dl class=\"switch\">\n                        <dt>\n                          If the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-HmacImportParams-length\">length</a> member of\n                          <var>normalizedAlgorithm</var> is greater than <var>length</var>:\n                        </dt>\n                        <dd>\n                          <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">throw</a> a\n                          <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-DataError\"><code>DataError</code></a>.\n                        </dd>\n                        <dt>\n                          If the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-HmacImportParams-length\">length</a> member of\n                          <var>normalizedAlgorithm</var>, is less than or equal to\n                          <var>length</var> minus eight:\n                        </dt>\n                        <dd>\n                          <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">throw</a> a\n                          <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-DataError\"><code>DataError</code></a>.\n                        </dd>\n                        <dt>\n                          Otherwise:\n                        </dt>\n                        <dd>\n                          Set <var>length</var> equal to the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-HmacImportParams-length\">\n                          length</a> member of <var>normalizedAlgorithm</var>.\n                        </dd>\n                      </dl>\n                    </dd>\n                  </dl>",
          "rationale": ".switch",
          "steps": [
            {
              "operation": "switch",
              "steps": [
                {
                  "case": "If the length member of normalizedAlgorithm is present:",
                  "html": "<dl class=\"switch\">\n                        <dt>\n                          If the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-HmacImportParams-length\">length</a> member of\n                          <var>normalizedAlgorithm</var> is greater than <var>length</var>:\n                        </dt>\n                        <dd>\n                          <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">throw</a> a\n                          <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-DataError\"><code>DataError</code></a>.\n                        </dd>\n                        <dt>\n                          If the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-HmacImportParams-length\">length</a> member of\n                          <var>normalizedAlgorithm</var>, is less than or equal to\n                          <var>length</var> minus eight:\n                        </dt>\n                        <dd>\n                          <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">throw</a> a\n                          <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-DataError\"><code>DataError</code></a>.\n                        </dd>\n                        <dt>\n                          Otherwise:\n                        </dt>\n                        <dd>\n                          Set <var>length</var> equal to the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-HmacImportParams-length\">\n                          length</a> member of <var>normalizedAlgorithm</var>.\n                        </dd>\n                      </dl>",
                  "rationale": ".switch",
                  "steps": [
                    {
                      "operation": "switch",
                      "steps": [
                        {
                          "case": "If the length member of normalizedAlgorithm is greater than length:",
                          "html": "<a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">throw</a> a\n                          <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-DataError\"><code>DataError</code></a>."
                        },
                        {
                          "case": "If the length member of normalizedAlgorithm, is less than or equal to length minus eight:",
                          "html": "<a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">throw</a> a\n                          <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-DataError\"><code>DataError</code></a>."
                        },
                        {
                          "case": "Otherwise:",
                          "html": "Set <var>length</var> equal to the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-HmacImportParams-length\">\n                          length</a> member of <var>normalizedAlgorithm</var>."
                        }
                      ]
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "html": "<p>\n                    Let <var>key</var> be a new <code><a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey\">CryptoKey</a></code>\n                    object representing an HMAC key with the first <var>length</var>\n                    bits of <var>data</var>.\n                  </p>"
        },
        {
          "html": "<p>\n                    Let <var>algorithm</var> be a new\n                    <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-HmacKeyAlgorithm\">HmacKeyAlgorithm</a>.\n                  </p>"
        },
        {
          "html": "<p>\n                    Set the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-KeyAlgorithm-name\">name</a> attribute of\n                    <var>algorithm</var> to <code>\"HMAC\"</code>.\n                  </p>"
        },
        {
          "html": "<p>\n                    Set the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-HmacKeyAlgorithm-length\">length</a> attribute of\n                    <var>algorithm</var> to <var>length</var>.\n                  </p>"
        },
        {
          "html": "<p>\n                    Set the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-HmacKeyAlgorithm-hash\">hash</a> attribute of\n                    <var>algorithm</var> to <var>hash</var>.\n                  </p>"
        },
        {
          "html": "<p>\n                    Set the [[<a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-algorithm\">algorithm</a>]] internal\n                    slot of <var>key</var> to <var>algorithm</var>.\n                  </p>"
        },
        {
          "html": "<p>\n                    Return <var>key</var>.\n                  </p>"
        }
      ]
    },
    {
      "html": "",
      "rationale": "if",
      "steps": [
        {
          "html": "<p>\n                    If the underlying cryptographic key material represented by the [[<a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-handle\">handle</a>]] internal slot of <var>key</var>\n                    cannot be accessed, then <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">throw</a> an <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-OperationError\"><code>OperationError</code></a>.\n                  </p>"
        },
        {
          "html": "<p>\n                    Let <var>bits</var> be the raw bits of the key represented by [[<a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-handle\">handle</a>]] internal slot of\n                    <var>key</var>.\n                  </p>"
        },
        {
          "html": "<p>\n                    Let <var>data</var> be an <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-octet-string-containing\">octet string containing</a> <var>bits</var>.\n                  </p>"
        },
        {
          "html": "<dl class=\"switch\">\n                    <dt>If <var>format</var> is <code>\"raw\"</code>:</dt>\n                    <dd>\n                      \n                    </dd>\n                    <dt>If <var>format</var> is <code>\"jwk\"</code>:</dt>\n                    <dd>\n                      \n                    </dd>\n                    <dt>Otherwise:</dt>\n                    <dd>\n                      <p>\n                        <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">throw</a> a\n                        <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-NotSupportedError\"><code>NotSupportedError</code></a>.\n                      </p>\n                    </dd>\n                  </dl>",
          "rationale": ".switch",
          "steps": [
            {
              "operation": "switch",
              "steps": [
                {
                  "case": "If format is \"raw\":",
                  "html": "",
                  "rationale": "let",
                  "steps": [
                    {
                      "html": "<p>\n                            Let <var>result</var> be a new <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-ArrayBuffer\">ArrayBuffer</a> associated with the\n                            <a href=\"https://www.w3.org/TR/html51/webappapis.html#relevant-global-object\">relevant global object</a>\n                            of <code>this</code> [<a href=\"https://www.w3.org/TR/WebCryptoAPI/#HTML\">HTML</a>], and containing <var>data</var>.\n                          </p>"
                    }
                  ]
                },
                {
                  "case": "If format is \"jwk\":",
                  "html": "",
                  "rationale": "let",
                  "steps": [
                    {
                      "html": "<p>\n                            Let <var>jwk</var> be a new <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-JsonWebKey\">JsonWebKey</a>\n                            dictionary.\n                          </p>"
                    },
                    {
                      "html": "<p>\n                            Set the <code>kty</code> attribute of <var>jwk</var> to the\n                            string <code>\"oct\"</code>.\n                          </p>"
                    },
                    {
                      "html": "<p>\n                            Set the <code>k</code> attribute of <var>jwk</var> to be a string\n                            containing <var>data</var>, encoded according to Section 6.4 of <a href=\"https://www.w3.org/TR/WebCryptoAPI/#jwa\">JSON Web Algorithms</a>.\n                          </p>"
                    },
                    {
                      "html": "<p>\n                            Let <var>algorithm</var> be the [[<a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-algorithm\">algorithm</a>]] internal slot of\n                            <var>key</var>.\n                          </p>"
                    },
                    {
                      "html": "<p>\n                            Let <var>hash</var> be the\n                            <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-HmacKeyAlgorithm-hash\">hash</a> attribute of\n                            <var>algorithm</var>.\n                          </p>"
                    },
                    {
                      "html": "<dl class=\"switch\">\n                            <dt>If the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-KeyAlgorithm-name\">name</a> attribute of\n                            <var>hash</var> is <code>\"SHA-1\"</code>:</dt>\n                            <dd>Set the <code>alg</code> attribute of <var>jwk</var> to\n                            the string <code>\"HS1\"</code>.</dd>\n                            <dt>If the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-KeyAlgorithm-name\">name</a> attribute of\n                            <var>hash</var> is <code>\"SHA-256\"</code>:</dt>\n                            <dd>Set the <code>alg</code> attribute of <var>jwk</var> to\n                            the string <code>\"HS256\"</code>.</dd>\n                            <dt>If the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-KeyAlgorithm-name\">name</a> attribute of\n                            <var>hash</var> is <code>\"SHA-384\"</code>:</dt>\n                            <dd>Set the <code>alg</code> attribute of <var>jwk</var> to\n                            the string <code>\"HS384\"</code>.</dd>\n                            <dt>If the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-KeyAlgorithm-name\">name</a> attribute of\n                            <var>hash</var> is <code>\"SHA-512\"</code>:</dt>\n                            <dd>Set the <code>alg</code> attribute of <var>jwk</var> to\n                            the string <code>\"HS512\"</code>.</dd>\n                            <dt>\n                              Otherwise, the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-KeyAlgorithm-name\">name</a> attribute\n                              of <var>hash</var> is defined in\n                              <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-applicable-specification\">another applicable\n                              specification</a>:\n                            </dt>\n                            <dd>\n                              \n                            </dd>\n                          </dl>",
                      "rationale": ".switch",
                      "steps": [
                        {
                          "operation": "switch",
                          "steps": [
                            {
                              "case": "If the name attribute of hash is \"SHA-1\":",
                              "html": "Set the <code>alg</code> attribute of <var>jwk</var> to\n                            the string <code>\"HS1\"</code>."
                            },
                            {
                              "case": "If the name attribute of hash is \"SHA-256\":",
                              "html": "Set the <code>alg</code> attribute of <var>jwk</var> to\n                            the string <code>\"HS256\"</code>."
                            },
                            {
                              "case": "If the name attribute of hash is \"SHA-384\":",
                              "html": "Set the <code>alg</code> attribute of <var>jwk</var> to\n                            the string <code>\"HS384\"</code>."
                            },
                            {
                              "case": "If the name attribute of hash is \"SHA-512\":",
                              "html": "Set the <code>alg</code> attribute of <var>jwk</var> to\n                            the string <code>\"HS512\"</code>."
                            },
                            {
                              "case": "Otherwise, the name attribute of hash is defined in another applicable specification:",
                              "html": "",
                              "rationale": "perform",
                              "steps": [
                                {
                                  "html": "<p>\n                                    Perform any <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-hmac-extended-export-steps\">key\n                                    export steps</a> defined by\n                                    <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-applicable-specification\">other applicable\n                                    specifications</a>, passing <var>format</var> and <var>key</var>\n                                    and obtaining <var>alg</var>.\n                                  </p>"
                                },
                                {
                                  "html": "<p>\n                                    Set the <code>alg</code> attribute of <var>jwk</var> to\n                                    <var>alg</var>.\n                                  </p>"
                                }
                              ]
                            }
                          ]
                        }
                      ]
                    },
                    {
                      "html": "<p>\n                            Set the <code>key_ops</code> attribute of <var>jwk</var> to equal the\n                            <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-usages\">usages</a> attribute of <var>key</var>.\n                          </p>"
                    },
                    {
                      "html": "<p>\n                            Set the <code>ext</code> attribute of <var>jwk</var> to equal the [[<a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-extractable\">extractable</a>]] internal slot\n                            of <var>key</var>.\n                          </p>"
                    },
                    {
                      "html": "<p>\n                            Let <var>result</var> be the result of converting <var>jwk</var>\n                            to an ECMAScript Object, as defined by [<a href=\"https://www.w3.org/TR/WebCryptoAPI/#WebIDL\">WebIDL</a>].\n                          </p>"
                    }
                  ]
                },
                {
                  "case": "Otherwise:",
                  "html": "<p>\n                        <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">throw</a> a\n                        <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-NotSupportedError\"><code>NotSupportedError</code></a>.\n                      </p>"
                }
              ]
            }
          ]
        },
        {
          "html": "<p>\n                    Return <var>result</var>.\n                  </p>"
        }
      ]
    },
    {
      "html": "",
      "rationale": "if",
      "steps": [
        {
          "html": "<dl class=\"switch\">\n                    <dt>\n                      If the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-HmacImportParams-length\">length</a> member of\n                      <var>normalizedDerivedKeyAlgorithm</var> is not present:\n                    </dt>\n                    <dd>\n                      <p>\n                        Let <var>length</var> be the block size in bytes of the hash function\n                        identified by the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-HmacImportParams-hash\">hash</a> member\n                        of <var>normalizedDerivedKeyAlgorithm</var>.\n                      </p>\n                    </dd>\n                    <dt>\n                      Otherwise, if the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-HmacImportParams-length\">length</a>\n                      member of <var>normalizedDerivedKeyAlgorithm</var> is non-zero:\n                    </dt>\n                    <dd>\n                      Let <var>length</var> be equal to the\n                      <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-HmacImportParams-length\">length</a>\n                      member of <var>normalizedDerivedKeyAlgorithm</var>.\n                    </dd>\n                    <dt>Otherwise:</dt>\n                    <dd>\n                      <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">throw</a> a\n                      <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-TypeError\"><code>TypeError</code></a>.\n                    </dd>\n                  </dl>",
          "rationale": ".switch",
          "steps": [
            {
              "operation": "switch",
              "steps": [
                {
                  "case": "If the length member of normalizedDerivedKeyAlgorithm is not present:",
                  "html": "<p>\n                        Let <var>length</var> be the block size in bytes of the hash function\n                        identified by the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-HmacImportParams-hash\">hash</a> member\n                        of <var>normalizedDerivedKeyAlgorithm</var>.\n                      </p>"
                },
                {
                  "case": "Otherwise, if the length member of normalizedDerivedKeyAlgorithm is non-zero:",
                  "html": "Let <var>length</var> be equal to the\n                      <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-HmacImportParams-length\">length</a>\n                      member of <var>normalizedDerivedKeyAlgorithm</var>."
                },
                {
                  "case": "Otherwise:",
                  "html": "<a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">throw</a> a\n                      <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-TypeError\"><code>TypeError</code></a>."
                }
              ]
            }
          ]
        },
        {
          "html": "<p>\n                    Return <var>length</var>.\n                  </p>"
        }
      ]
    },
    {
      "html": "",
      "rationale": "if",
      "steps": [
        {
          "html": "<dl class=\"switch\">\n                    <dt>\n                      If the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-Algorithm-name\">name</a> member of\n                      <var>normalizedAlgorithm</var> is a cases-sensitive string match for\n                      <code>\"SHA-1\"</code>:\n                    </dt>\n                    <dd>\n                      Let <var>result</var> be the result of performing the SHA-1 hash function\n                      defined in Section 6.1 of [<a href=\"https://www.w3.org/TR/WebCryptoAPI/#FIPS180-4\">FIPS PUB 180-4</a>] using\n                      <var>message</var> as the input message, <var>M</var>.\n                    </dd>\n                    <dt>\n                      If the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-Algorithm-name\">name</a> member of\n                      <var>normalizedAlgorithm</var> is a cases-sensitive string match for\n                      <code>\"SHA-256\"</code>:\n                    </dt>\n                    <dd>\n                      Let <var>result</var> be the result of performing the SHA-256 hash function\n                      defined in Section 6.2 of [<a href=\"https://www.w3.org/TR/WebCryptoAPI/#FIPS180-4\">FIPS PUB 180-4</a>] using\n                      <var>message</var> as the input message, <var>M</var>.\n                    </dd>\n                    <dt>\n                      If the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-Algorithm-name\">name</a> member of\n                      <var>normalizedAlgorithm</var> is a cases-sensitive string match for\n                      <code>\"SHA-384\"</code>:\n                    </dt>\n                    <dd>\n                      Let <var>result</var> be the result of performing the SHA-384 hash function\n                      defined in Section 6.5 of [<a href=\"https://www.w3.org/TR/WebCryptoAPI/#FIPS180-4\">FIPS PUB 180-4</a>] using\n                      <var>message</var> as the input message, <var>M</var>.\n                    </dd>\n                    <dt>\n                      If the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-Algorithm-name\">name</a> member of\n                      <var>normalizedAlgorithm</var> is a cases-sensitive string match for\n                      <code>\"SHA-512\"</code>:\n                    </dt>\n                    <dd>\n                      Let <var>result</var> be the result of performing the SHA-1 hash function\n                      defined in Section 6.4 of [<a href=\"https://www.w3.org/TR/WebCryptoAPI/#FIPS180-4\">FIPS PUB 180-4</a>] using\n                      <var>message</var> as the input message, <var>M</var>.\n                    </dd>\n                  </dl>",
          "rationale": ".switch",
          "steps": [
            {
              "operation": "switch",
              "steps": [
                {
                  "case": "If the name member of normalizedAlgorithm is a cases-sensitive string match for \"SHA-1\":",
                  "html": "Let <var>result</var> be the result of performing the SHA-1 hash function\n                      defined in Section 6.1 of [<a href=\"https://www.w3.org/TR/WebCryptoAPI/#FIPS180-4\">FIPS PUB 180-4</a>] using\n                      <var>message</var> as the input message, <var>M</var>."
                },
                {
                  "case": "If the name member of normalizedAlgorithm is a cases-sensitive string match for \"SHA-256\":",
                  "html": "Let <var>result</var> be the result of performing the SHA-256 hash function\n                      defined in Section 6.2 of [<a href=\"https://www.w3.org/TR/WebCryptoAPI/#FIPS180-4\">FIPS PUB 180-4</a>] using\n                      <var>message</var> as the input message, <var>M</var>."
                },
                {
                  "case": "If the name member of normalizedAlgorithm is a cases-sensitive string match for \"SHA-384\":",
                  "html": "Let <var>result</var> be the result of performing the SHA-384 hash function\n                      defined in Section 6.5 of [<a href=\"https://www.w3.org/TR/WebCryptoAPI/#FIPS180-4\">FIPS PUB 180-4</a>] using\n                      <var>message</var> as the input message, <var>M</var>."
                },
                {
                  "case": "If the name member of normalizedAlgorithm is a cases-sensitive string match for \"SHA-512\":",
                  "html": "Let <var>result</var> be the result of performing the SHA-1 hash function\n                      defined in Section 6.4 of [<a href=\"https://www.w3.org/TR/WebCryptoAPI/#FIPS180-4\">FIPS PUB 180-4</a>] using\n                      <var>message</var> as the input message, <var>M</var>."
                }
              ]
            }
          ]
        },
        {
          "html": "<p>\n                    If performing the operation results in an error, then <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">throw</a> an <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-OperationError\"><code>OperationError</code></a>.\n                  </p>"
        },
        {
          "html": "<p>\n                    Return a new ArrayBuffer containing <var>result</var>.\n                  </p>"
        }
      ]
    },
    {
      "html": "",
      "rationale": "if",
      "steps": [
        {
          "html": "<p>\n                    If <var>length</var> is null, then <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">throw</a> an <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-OperationError\"><code>OperationError</code></a>.\n                  </p>"
        },
        {
          "html": "<p>\n                    Let <var>extractKey</var> be a key equal to <var>n</var> zero bits where\n                    <var>n</var> is the size of the output of the hash function described by the\n                    <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-HkdfParams-hash\">hash</a> member of\n                    <var>normalizedAlgorithm</var>.\n                  </p>"
        },
        {
          "html": "<p>\n                    Let <var>keyDerivationKey</var> be the secret represented by [[<a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-handle\">handle</a>]] internal slot of <var>key</var>\n                    as the message.\n                  </p>"
        },
        {
          "html": "<p>\n                    Let <var>result</var> be the result of performing the HKDF extract and then\n                    the HKDF expand step described in Section 2 of\n                    [<a href=\"https://www.w3.org/TR/WebCryptoAPI/#RFC5869\">RFC 5869</a>] using:\n                  </p>\n                  <ul>\n                    <li>\n                      <p>\n                        the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-HkdfParams-hash\">hash</a> member of\n                        <var>normalizedAlgorithm</var> as <var>Hash</var>,\n                      </p>\n                    </li>\n                    <li>\n                      <p>\n                        <var>keyDerivationKey</var> as the input keying material,\n                        <var>IKM</var>,\n                      </p>\n                    </li>\n                    <li>\n                      <p>\n                        <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-contents-of-arraybuffer\">the contents of</a> the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-HkdfParams-salt\">salt</a> member of\n                        <var>normalizedAlgorithm</var> as <var>salt</var>,\n                      </p>\n                    </li>\n                    <li>\n                      <p>\n                        <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-contents-of-arraybuffer\">the contents of</a> the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-HkdfParams-info\">info</a> member of\n                        <var>normalizedAlgorithm</var> as <var>info</var>,\n                      </p>\n                    </li>\n                    <li>\n                      <p>\n                        <var>length</var> as the value of <var>L</var>,\n                      </p>\n                    </li>\n                  </ul>"
        },
        {
          "html": "<p>\n                    If the key derivation operation fails,\n                    then <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">throw</a> an\n                    <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-OperationError\"><code>OperationError</code></a>.\n                  </p>"
        },
        {
          "html": "<p>\n                    Return <var>result</var>.\n                  </p>"
        }
      ]
    },
    {
      "html": "",
      "rationale": "let",
      "steps": [
        {
          "html": "<p>Let <var>keyData</var> be the key data to be imported.</p>"
        },
        {
          "html": "<dl class=\"switch\">\n                    <dt>\n                      If <var>format</var> is <code>\"raw\"</code>:\n                    </dt>\n                    <dd>\n                      \n                    </dd>\n                    <dt>Otherwise:</dt>\n                    <dd>\n                      <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">throw</a> a\n                      <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-NotSupportedError\"><code>NotSupportedError</code></a>.\n                    </dd>\n                  </dl>",
          "rationale": ".switch",
          "steps": [
            {
              "operation": "switch",
              "steps": [
                {
                  "case": "If format is \"raw\":",
                  "html": "",
                  "rationale": "if",
                  "steps": [
                    {
                      "html": "<p>\n                            If <var>usages</var> contains a value that is not \n                             <code>\"deriveKey\"</code> or <code>\"deriveBits\"</code>,\n                            \n                                then <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">throw</a> a\n                                <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-SyntaxError\"><code>SyntaxError</code></a>.\n                          </p>"
                    },
                    {
                      "html": "<p>\n                            If <var>extractable</var> is not <code>false</code>,\n                            then <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">throw</a> a\n                            <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-SyntaxError\"><code>SyntaxError</code></a>.\n                          </p>"
                    },
                    {
                      "html": "<p>\n                            Let <var>key</var> be a new <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey\">CryptoKey</a> associated with the\n                            <a href=\"https://www.w3.org/TR/html51/webappapis.html#relevant-global-object\">relevant global object</a>\n                            of <code>this</code> [<a href=\"https://www.w3.org/TR/WebCryptoAPI/#HTML\">HTML</a>], and\n                            representing the key data provided in <var>keyData</var>.\n                          </p>"
                    },
                    {
                      "html": "<p>\n                            Set the [[<a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-type\">type</a>]] internal slot of\n                            <var>key</var> to <code>\"secret\"</code>.\n                          </p>"
                    },
                    {
                      "html": "<p>\n                            Set the [[<a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-extractable\">extractable</a>]] internal slot of\n                            <var>key</var> to <code>false</code>.\n                          </p>"
                    },
                    {
                      "html": "<p>\n                            Let <var>algorithm</var> be a new\n                            <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-KeyAlgorithm\">KeyAlgorithm</a> object.\n                          </p>"
                    },
                    {
                      "html": "<p>\n                            Set the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-KeyAlgorithm-name\">name</a> attribute of\n                            <var>algorithm</var> to <code>\"HKDF\"</code>.\n                          </p>"
                    },
                    {
                      "html": "<p>\n                            Set the [[<a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-algorithm\">algorithm</a>]] internal\n                            slot of <var>key</var> to <var>algorithm</var>.\n                          </p>"
                    },
                    {
                      "html": "<p>\n                            Return <var>key</var>.\n                          </p>"
                    }
                  ]
                },
                {
                  "case": "Otherwise:",
                  "html": "<a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">throw</a> a\n                      <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-NotSupportedError\"><code>NotSupportedError</code></a>."
                }
              ]
            }
          ]
        }
      ]
    },
    {
      "html": "",
      "rationale": "return",
      "steps": [
        {
          "html": "<p>\n                    Return null.\n                  </p>"
        }
      ]
    },
    {
      "html": "",
      "rationale": "if",
      "steps": [
        {
          "html": "<p>\n                    If <var>length</var> is null or is not a multiple of 8, then <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">throw</a> an <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-OperationError\"><code>OperationError</code></a>.\n                  </p>"
        },
        {
          "html": "<p>\n                    Let <var>prf</var> be the MAC Generation function described in Section 4 of\n                    [<a href=\"https://www.w3.org/TR/WebCryptoAPI/#fips-pub-198-1\">FIPS PUB 198-1</a>] using the hash function\n                    described by the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-Pbkdf2Params-hash\">hash</a> member of\n                    <var>normalizedAlgorithm</var>.\n                  </p>"
        },
        {
          "html": "<p>\n                    Let <var>result</var> be the result of performing the PBKDF2 operation defined\n                    in Section 5.2 of [<a href=\"https://www.w3.org/TR/WebCryptoAPI/#RFC2898\">RFC2898</a>] using <var>prf</var> as the\n                    pseudo-random function, <var>PRF</var>, the password represented by [[<a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-handle\">handle</a>]] internal slot of <var>key</var>\n                    as the password, <var>P</var>, <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-contents-of-arraybuffer\">the\n                    contents of</a> the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-Pbkdf2Params-salt\">salt</a> attribute of\n                    <var>normalizedAlgorithm</var> as the salt, <var>S</var>, the value of the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-Pbkdf2Params-iterations\">iterations</a> attribute of\n                    <var>normalizedAlgorithm</var> as the iteration count, <var>c</var>, and\n                    <var>length</var> divided by 8 as the intended key length, <var>dkLen</var>.\n                  </p>"
        },
        {
          "html": "<p>\n                    If the key derivation operation fails, \n                    then <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">throw</a> an\n                    <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-OperationError\"><code>OperationError</code></a>.\n                  </p>"
        },
        {
          "html": "<p>\n                    Return <var>result</var>\n                  </p>"
        }
      ]
    },
    {
      "html": "",
      "rationale": "if",
      "steps": [
        {
          "html": "<p>\n                    If <var>format</var> is not <code>\"raw\"</code>, <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">throw</a> a <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-NotSupportedError\"><code>NotSupportedError</code></a>\n                  </p>"
        },
        {
          "html": "<p>\n                    If <var>usages</var> contains a value that is not\n                    <code>\"deriveKey\"</code>  or <code>\"deriveBits\"</code>, then\n                    <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">throw</a> a <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-SyntaxError\"><code>SyntaxError</code></a>.\n                  </p>"
        },
        {
          "html": "<p>\n                    If <var>extractable</var> is not <code>false</code>,\n                    then <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-throw\">throw</a> a\n                    <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-SyntaxError\"><code>SyntaxError</code></a>.\n                  </p>"
        },
        {
          "html": "<p>\n                    Let <var>key</var> be a new <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey\">CryptoKey</a> associated with the\n                    <a href=\"https://www.w3.org/TR/html51/webappapis.html#relevant-global-object\">relevant global object</a>\n                    of <code>this</code> [<a href=\"https://www.w3.org/TR/WebCryptoAPI/#HTML\">HTML</a>], and\n                    representing <var>keyData</var>.\n                  </p>"
        },
        {
          "html": "<p>\n                    Set the [[<a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-type\">type</a>]] internal slot of\n                    <var>key</var> to <code>\"secret\"</code>.\n                  </p>"
        },
        {
          "html": "<p>\n                    Set the [[<a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-extractable\">extractable</a>]] internal slot of\n                    <var>key</var> to <code>false</code>.\n                  </p>"
        },
        {
          "html": "<p>\n                    Let <var>algorithm</var> be a new <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-KeyAlgorithm\">KeyAlgorithm</a>\n                    object.\n                  </p>"
        },
        {
          "html": "<p>\n                    Set the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-KeyAlgorithm-name\">name</a> attribute of\n                    <var>algorithm</var> to <code>\"PBKDF2\"</code>.\n                  </p>"
        },
        {
          "html": "<p>\n                    Set the [[<a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-algorithm\">algorithm</a>]] internal\n                    slot of <var>key</var> to <var>algorithm</var>.\n                  </p>"
        },
        {
          "html": "<p>\n                    Return <var>key</var>.\n                  </p>"
        }
      ]
    },
    {
      "html": "",
      "rationale": "return",
      "steps": [
        {
          "html": "<p>\n                    Return null.\n                  </p>"
        }
      ]
    }
  ]
}